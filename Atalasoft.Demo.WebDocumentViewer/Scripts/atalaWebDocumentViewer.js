//-------------------------------------------------------------------------------------------------
//
//  Web Document Viewer object cross browser client-side script. 
//  Copyright 2003-2015 Atalasoft Inc. All Rights Reserved.
//
//  This source code is property of Atalasoft, Inc. (http://www.atalasoft.com/)
//  Permission for usage and modification of this code is only permitted 
//  with the purchase of a source code license.
//-------------------------------------------------------------------------------------------------
!function(){function t(t){for(var e=0,n=(""+t).replace("_",".").replace(/[^0-9.]/g,"").split("."),o=0;o<n.length;++o)e+=Number(n[o])/Math.pow(10,3*o);return e}var e="1.7.1";if("undefined"==typeof jQuery)throw"jQuery not found. The WebDocumentViewer requires jQuery version "+e+" or later.";if(t(jQuery().jquery)<t(e))throw"Early jQuery version found: "+jQuery().jquery+", version expected: "+e;jQuery.isFunction(jQuery.fn.parseVersionFloat)||(jQuery.parseVersionFloat=t,jQuery.fn.parseVersionFloat=t)}();/**
* Main Atalasoft Namespace definition(s)
*/
var Atalasoft=jQuery.extend(!0,{},Atalasoft,{$:jQuery,Annotations:{},Controls:{},Document:{},Forms:{},Utils:{}});!function(){var t={instanceCounter:0};/**
* Control that views, modifies, and saves documents, annotations and forms.
* @param settings Object of key value pairs representing initial settings
* @returns A new control with the given settings.
*/
Atalasoft.Controls.WebDocumentViewer=function(e,n){function o(){Atalasoft.Utils._scriptLoader=Atalasoft.Utils.__loadDependencies(bo.scripturl,bo.allowannotations,h);var t={_config:bo,_id:ao,_document:co.loadedImgs,_pages:co.pageDivs,_state:vo,createDOM:v,createDiv:y,createDialog:k,createDropDownButton:P,createDropDownMenu:D,createMenu:A,drawAnnotation:fn,redrawVisiblePages:Mn,adjustVisiblePages:an,startDomManipulation:$e,endDomManipulation:Xe,redrawPageFromIndex:Un,makeHandlerRequest:Fn,getPageScale:sn,getPageSize:ee,getSourcePageSize:te,getPageRotation:un,getViewerTransform:cn,isPageInView:je};fo.document=new Atalasoft.Document.ManipulationController(no,t),bo.allowannotations?fo.annotations=new Atalasoft.Annotations.AnnotationController(no,t,oo):(no.deselectAll=hn,no.createAnnotationOnPage=hn,no.getAnnotationsFromPage=hn,no.deleteAnnotationOnPageAtIndex=hn,no.setAnnotationDefaults=hn,no.setImages=hn,no.setStamps=hn),bo.allowforms&&(fo.forms=new Atalasoft.Forms.FormController(no,t));var e="undefined"==typeof eo.easing||"undefined"==typeof eo.ui||bo.allowannotations&&"undefined"==typeof Raphael;e?Atalasoft.Utils._scriptLoader&&Atalasoft.Utils._scriptLoader.bind({scriptsloaded:a}):a()}function a(){vo.initialized===!1&&(vo.initialized=!0,Gn({throwerror:m,pagedivsresized:u,documentchanged:bn,pagesizechanged:c}),bo.parent?(bo.parent instanceof jQuery||(bo.parent=eo(bo.parent)),bo.parent.length||h("InitError","Parent element not found.")):h("InitError","No parent element given."),co.toolbar=x(bo.toolbarparent||bo.parent),co.toolbar.addClass(yo.atala_toolbar),co.main=y(bo.parent),co.main.addClass(yo.atala_main_container),co.scroller=y(co.main),co.scroller.addClass(yo.atala_scroller),co.main.bind({selectstart:f}),co.toolbar.attr("id",ao+"_toolbar"),co.main.attr("id",ao+"_main"),co.scroller.attr("id",ao+"_scroller"),co.main.css({height:"100%",width:"100%",position:"relative"}),co.scroller.css({height:"100%",width:"100%",position:"relative"}),co.viewport=y(co.scroller,ao+"_vp"),co.viewport.css({overflow:"hidden"}),co.viewport.addClass(yo.atala_viewport),co.edges[0]=S(co.viewport,ao+"_e0"),co.content=y(co.viewport,ao+"_ct"),co.content.css({"-ms-touch-action":"none"}),co.content.addClass(yo.atala_content),bo.direction===go.Horizontal&&co.content.css({display:"inline-block"}),co.edges[1]=S(co.viewport,ao+"_e1"),Atalasoft.Utils.Browser.Features.Compatibility&&h("InitError","Compatibility Mode is not supported."),Atalasoft.Utils.Browser.Mobile.Any()?co.scroller.css({overflow:"hidden"}):bo.showscrollbars?(co.scroller.css({overflow:"auto"}),co.scrollH=O(co.main,go.Horizontal),co.scrollH.attr("id",ao+"_sH"),co.scrollH.addClass(yo.atala_scroll_horizontal),co.scrollV=O(co.main,go.Vertical),co.scrollV.attr("id",ao+"_sV"),co.scrollV.addClass(yo.atala_scroll_vertical)):co.scroller.css({overflow:"hidden"}),fo.mouseTool=new Atalasoft.Controls.ToolController(no,{zoomStart:Je,zoom:Ye,zoomEnd:Ge,getActivePage:Ae,raiseDrawLayer:mn,resetDrawLayer:vn},co.viewport,co.scroller,{allowflick:bo.allowflick}),fo.memory=new Atalasoft.Document.MemoryTracker({highWaterMark:bo.memorythreshold}),fo.memory.bind({exceededhighwatermark:s}),fo.annotations&&fo.annotations.setViewPort(co.viewport),Kn("initialized"),r(),eo(document).ready(d))}function i(){var e=bo.parent.attr("id")+"_wdv";for(++t.instanceCounter;document.getElementById(e+t.instanceCounter);)++t.instanceCounter;ao=e+t.instanceCounter}function r(){Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)<8?co.viewport.css({"float":"left"}):(bo.direction===go.Horizontal&&co.viewport.css({"white-space":"nowrap"}),co.viewport.css({display:"table-cell"})),I(co.scroller),co.scrollH&&co.edges[1].height(co.scrollH.scrollbarHeight()),fo.mouseTool.setTool(ho.Pan,ho.None),(bo.documenturl||bo.annotationsurl||bo.formurl)&&Xn(bo.documenturl,bo.annotationsurl,bo.formurl,n)}/**
	* Removes all DOM elements, internal references, and empties memory intensive objects.
	* The WebDocumentViewer will no longer function after a call to this method.
	*/
function l(){if(Ce(),Se(),co.main&&co.main.remove(),co.toolbar&&(co.toolbar.remove(),co.toolbar.annoToolbar&&co.toolbar.annoToolbar.remove()),no=null,co.main=null,co.toolbar=null,co.scroller=null,co.viewport=null,co.content=null,co.scrollH=null,co.scrollV=null,co.loadedImgs.length=0,co.pageDivs.length=0,co.pageLabel=null,co.status=null,co.edges){for(var t=0;t<co.edges.length;t++)co.edges[t]=null;co.edges=[]}for(var e in fo)fo.hasOwnProperty(e)&&null!==fo[e]&&(fo[e].dispose(),fo[e]=null);mo=null,vo=null}function s(){var t=fo.memory.deallocateOldestEntry();L(t[0]),co.loadedImgs[t._index]=null,t.remove(),t.length=0,t=null}function u(t){vo.newpagedivsize={height:t.height,width:t.width},vo.newpagedivfullzoom=t.fullzoom,bo.minwidth=t.minwidth,bo.zoom=t.fullzoom,bn()}function c(t){var e=!1;(mo.smallest.width<=0||t.width<mo.smallest.width)&&(mo.smallest.width=t.width,e=!0),(mo.smallest.height<=0||t.height<mo.smallest.height)&&(mo.smallest.height=t.height,e=!0),oo||(ve(t.dx,t.dy),e&&H(q())>co.pageDivs.length&&(ze(co.pageDivs[0]._index,null),we(),bn(t)))}function d(){eo(window).on({resize:We,beforeunload:l}),co.scroller.scroll(_e),V(mo.buffer)}function f(t){var e=t.target||t.srcElement;return Atalasoft.Utils.Browser.Explorer8?Atalasoft.Utils.__rf():"TEXTAREA"!==e.nodeName&&"INPUT"!==e.nodeName&&"text"!==e.type?Atalasoft.Utils.__rf():e.attributes.selectable&&"false"===e.attributes.selectable.value?Atalasoft.Utils.__rf():void 0}function p(t){return function(e){e.preventDefault(),Kn(t,arguments)}}function g(t,e){return function(n){try{n.currentTarget=e&&e.length>0?e[0]:n.currentTarget,t&&t(n)}catch(o){se(o.message)}}}function h(t,e){if(bo.showerrors)throw"undefined"==typeof e?t:t+": "+e;se(t+": "+e),Kn({type:"error",name:t,message:e})}function m(t){h(t.name,t.msg)}function v(t,e,n,o){var a=eo("<"+t+"></"+t+">");return e&&e.append&&a.appendTo(e),n&&a.attr("id",n),o&&a.html(o),a}function y(t,e,n){return v("div",t,e,n)}function _(t){var e=eo('<div style="width:100%; height:100%; position:absolute; left: 0px; top: 0px; background: #F00; opacity:0.0;"></div>');if(Atalasoft.Utils.Browser.Explorer)if(parseInt(Atalasoft.Utils.Browser.Version,10)<=8)e.css({filter:"alpha(opacity=0)"});else if(10===parseInt(Atalasoft.Utils.Browser.Version,10)){var n=!1;e.reflow=function(){if(n)e.empty();else{var t=eo("<hr/>");e.append(t)}n=!n}}return e.toFront=function(){e.css({"z-index":"10"}),e.reflow&&e.reflow()},e.reset=function(){e.css({"z-index":""}),e.reflow&&e.reflow()},t&&t.prepend(e),e}function x(t){var e=b(t);return bo.allowannotations&&(e.annoToolbar=w(t),e.annoToolbar.addClass(yo.atala_annotation_toolbar)),bo.showstatus&&(co.status=eo('<div id="'+ao+'_status" style="display:inline"></div>'),co.status.addClass(yo.atala_statusbar),e.append("Status:"),e.append(co.status)),e}function b(t){var e={id:ao+"_toolbar",parent:t,children:[{type:"button",id:"Button_PagePrev",cls:yo.atala_tool_button_page_prev,icon:"page-prev",tooltip:"Previous Page",text:null,onclick:function(){Wn()}},{type:"pagelabel",id:"Label_PageNumber",cls:yo.atala_page_label},{type:"button",id:"Button_PageNext",cls:yo.atala_tool_button_page_next,icon:"page-next",tooltip:"Next Page",text:null,onclick:function(){Nn()}},{type:"button",id:"Button_ZoomOut",cls:yo.atala_tool_button_zoom_out,icon:"zoom-out",tooltip:"Zoom Out",text:"",onclick:function(){$n()}},{type:"button",id:"Button_ZoomIn",cls:yo.atala_tool_button_zoom_in,icon:"zoom-in",tooltip:"Zoom In",text:"",onclick:function(){Zn()}},{type:"button",id:"Button_FitNone",cls:yo.atala_tool_button_fit_none,icon:"zoom-full",tooltip:"Full Size",text:"",onclick:function(){Qe(1)}},{type:"button",id:"Button_FitBest",cls:yo.atala_tool_button_fit_best,icon:"fit-best",tooltip:"Best Fit",text:"",onclick:function(){rn(po.Best)}},{type:"button",id:"Button_FitWidth",cls:yo.atala_tool_button_fit_width,icon:"fit-width",tooltip:"Fit To Width",text:"",onclick:function(){rn(po.Width)}}]};return bo.showselecttools&&e.children.splice(5,0,{type:"button",id:"Button_ZoomArea",cls:yo.atala_tool_button_zoom_area,icon:"zoom-area",tooltip:"Zoom Area",text:"",onclick:E}),e.children.push({type:"button",id:"Button_RotateLeft",cls:yo.atala_tool_button_rotate_left,icon:"rotate-left",tooltip:"Rotate Left",text:"",onclick:C(270)}),e.children.push({type:"button",id:"Button_RotateRight",cls:yo.atala_tool_button_rotate_right,icon:"rotate-right",tooltip:"Rotate Right",text:"",onclick:C(90)}),bo.savepath.length>0&&e.children.unshift({type:"button",id:"Button_Save",cls:yo.atala_tool_button_save,icon:"save",tooltip:"Save Changes",text:null,onclick:function(){Jn()}}),z(e)}function w(t){var e={id:ao+"_toolbar",parent:t,children:[{type:"button",id:"Button_Ellipse",cls:yo.atala_tool_button_ellipse_anno,icon:"ellipse",tooltip:"Draw Ellipse",text:"",onclick:fn},{type:"button",id:"Button_Highlight",cls:yo.atala_tool_button_highlight_anno,icon:"highlight",tooltip:"Draw Highlight",text:"",onclick:fn},{type:"button",id:"Button_Line",cls:yo.atala_tool_button_line_anno,icon:"line",tooltip:"Draw Line",text:"",onclick:fn},{type:"button",id:"Button_Lines",cls:yo.atala_tool_button_lines_anno,icon:"lines",tooltip:"Draw Poly Lines",text:"",onclick:fn},{type:"button",id:"Button_Freehand",cls:yo.atala_tool_button_freehand_anno,icon:"freehand",tooltip:"Draw Freehand",text:"",onclick:fn},{type:"button",id:"Button_Rectangle",cls:yo.atala_tool_button_rect_anno,icon:"rectangle",tooltip:"Draw Rectangle",text:"",onclick:fn},{type:"button",id:"Button_Text",cls:yo.atala_tool_button_text_anno,icon:"text",tooltip:"Draw Text",text:"",onclick:fn}]};return z(e)}function z(t){var e=y(t.parent),n=ao+"_toolbar";e.buttons=[];for(var o=0;t.children&&o<t.children.length;o++){var a=null;switch(t.children[o].type){case"button":if(!Atalasoft.Utils.Browser.Features.Touch||"lines"!==t.children[o].icon){t.children[o].id=n+"_"+t.children[o].id;var i=U(t.children[o],e);i.addClass(yo.atala_toolbar_button),a=i,e.buttons.push(i)}break;case"pagelabel":co.pageLabel=v("span",e,n+"_"+t.children[o].id),a=co.pageLabel}a&&t.children[o].cls&&a.addClass(t.children[o].cls)}return e}function A(t){var e=eo("<ul/>");for(var n in t)if(t.hasOwnProperty(n)){var o=eo('<li><a href="#">'+n+"</a></li>");Atalasoft.Utils.Browser.Features.Touch&&!Atalasoft.Utils.Browser.Mobile.iOS&&o.bind({touchend:t[n]}),o.click(t[n]),o.appendTo(e)}return e.menu(),e}function k(t,e,n){var o=eo('<div title="'+e+'" />');return n&&o.append(n),o.dialog(),o}function P(t){var e=v("span",co.toolbar.annoToolbar);return U(t,e),M(e,t.id+"_Drop","ui-icon-triangle-1-s","Click To Choose",null,function(){var t=eo(this).next();if(t.is(":visible"))return t.hide(),!1;var e=t.prev().prev();return t.menu().show().css({position:"absolute",top:0,left:0,width:e.width()+"px","z-index":11}).position({my:"left top",at:"left bottom",of:e}),!1}),e.buttonset(),e}function D(t,e,n){for(var o=eo(t.children().first()),a={},i=0;i<n.length;i++)a[n[i].name]=T(o,e,n[i]);o.menu=A(a),t.append(o.menu),o.menu.hide()}function T(t,e,n){var o="menuselect"+e.icon+n.name,a=function(){return t.button("option","label","Draw "+n.name),t.data("_annoConfig",n),t.click(e.onclick),t.menu.hide(),t.trigger("click"),!1};return Gn(o,g(a,t)),a}function M(t,e,n,o,a,i){var r=eo('<button id="'+e+'" title="'+o+'">'+(a||o)+"</button>");return i&&r.click(i),r.button({icons:{primary:n},text:null!=a&&bo.showbuttontext}),r.addClass("atala-ui-button"),t&&r.appendTo(t),r}function U(t,e){var n="menuclick"+t.icon,o=M(e,t.id,lo+" "+lo+"-"+t.icon,t.tooltip,t.text,p(n));return o.data("_config",t),Gn(n,g(t.onclick,o)),o}function E(){bo.allowannotations&&no.annotations.cancelDraw(),fo.mouseTool.setTool(ho.ZoomArea)}function C(t){return function(){fo.document.rotatePage(mo.number-1,fo.document.getPageRotation(mo.number-1)+t)}}function S(t,e){var n=Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)<8,o=y(t,e);return bo.direction===go.Vertical?(o.height(1),o.css({display:"block"})):bo.direction===go.Horizontal&&(o.width(1),o.css({display:"inline-block"})),o._zoom=1,n&&o.html("&nbsp;"),o}function V(t){function e(t){return function(){Ue(t)}}if("undefined"==typeof t){var n=H(q());mo.buffer<n&&(mo.buffer=n),mo.buffer=Math.min(mo.buffer,fo.document.getPageCount()),t=mo.buffer}if(co.pageDivs.length<t)for(var o=co.pageDivs.length;t>o;o++)co.pageDivs[o]=y(),co.pageDivs[o].addClass(yo.atala_page_div),bo.showselecttools&&(co.pageDivs[o]._rubberband=new Atalasoft.Controls.RubberBandTool(no,{},co.pageDivs[o],{getViewportSize:oe,getMaxZoom:N,getPageOffsets:G,raiseDrawLayer:mn,resetDrawLayer:vn})),co.pageDivs[o].bind({touchstart:e(co.pageDivs[o]),mousedown:e(co.pageDivs[o])}),fo.annotations&&fo.annotations.addDrawingSurface(co.pageDivs[o]),(bo.showselecttools||bo.allowannotations)&&(co.pageDivs[o]._draw=_(co.pageDivs[o])),fo.forms&&!oo&&fo.forms.addFormLayer(co.pageDivs[o]);else if(co.pageDivs.length>t)for(;co.pageDivs.length>t&&0!==co.pageDivs.length;){var a=co.pageDivs.pop();a._rubberband&&a._rubberband.dispose(),fo.annotations&&fo.annotations.removeDrawingSurface(a),fo.forms&&!oo&&fo.forms.removeFormLayer(a),a&&Fe(a),a=null}}function F(t,e,n){function o(){return O._page?O._page._index:O._index}function a(){return O._domEl}function i(){return fo.document.getPageFitMultiplier(o(),ao)}function r(t){return t="undefined"==typeof t?bo.zoom:t,t*i()}function l(t){return fo.document.setPageFitMultiplier(o(),t,ao)}function s(){return{height:O._size.height||mo.size.height,width:O._size.width||mo.size.width}}/**
        * Returns physical size of the image without client transformations applied(like view rotation)
        */
function u(){var t=s();return 90===O._viewrotation||270===O._viewrotation?V(t):t}function c(t,e){return e=e||s(),{height:Math.round(e.height*r(t)),width:Math.round(e.width*r(t))}}function d(){O.bind(I);var t=bo.pageborderwidth,e={bottom:0,top:0,right:0,left:0};O._loaded=!1,O._reqzoom=-1,(bo.direction===go.Vertical||bo.tabular)&&(e.bottom=bo.pagespacing),(bo.direction===go.Horizontal||bo.tabular)&&(e.right=bo.pagespacing),bo.showpageborder&&a().css({"border-bottom":t+"px solid black","border-right":t+"px solid black","border-top":t+"px solid silver","border-left":t+"px solid silver","margin-bottom":e.bottom+"px","margin-right":e.right+"px"}),a().css({display:"inline-block"}),f()}function f(){var t=mo.vector?r():Math.min(r(),1),n=fo.document.getPageRotation(o());if(t!==O._zoom||O._rotation!==n){var a={atala_docurl:e?e.url:bo.documenturl,atala_doczoom:t,atala_thumbpadding:!1};n&&(a.atala_angle=n),bo.jpeg&&(a.atala_jpeg=!0);var i={type:"docpage",serverurl:bo.serverurl,query:"?ataladocpage="+(e?e.index:O._index),method:"GET",data:a,cancel:!1,info:O};O._reqzoom=t,Fn(i,p,p)}}function p(){O._loaded=!0,O._zoom=O._reqzoom,O._rotation=fo.document.getPageRotation(o()),C(),O.parent().length>0?v():B&&O._page&&O._page.nullinserted&&(Oe(O._page,O,O._page._index,!0),v()),S(0),T()}function g(){O._loaded&&v()}function m(t){t&&(t.removeAttr("width height"),t.css({width:"auto",height:"auto"}))}function v(){m(O);var t=O.prop("naturalWidth")||0,e=O.prop("naturalHeight")||0,n=t||O.width(),i=e||O.height(),l=s(),d=r(),f=!1;if(0!==n&&0!==i){O._size.width=Math.round(n/O._zoom),O._size.height=Math.round(i/O._zoom),(90===O._viewrotation||270===O._viewrotation)&&(O._size=V(O._size)),(O._size.width!==mo.size.width||O._size.height!==mo.size.height)&&(fo.document.setPageSize(O._page._index,O._size),R(O._size.width,l.width)&&R(O._size.height,l.height)||(f=!0)),bo.forcepagefit?P():(O._zoom!==bo.zoom||f||0!==O._viewrotation)&&A();var p=c();f&&O.trigger({type:"pagesizechanged",image:O,index:o(),width:O._size.width,height:O._size.height,dx:Math.round(p.width-l.width*d),dy:Math.round(p.height-l.height*d)}),O.trigger({type:"pageresize",image:O,index:o(),width:p.width,height:p.height})}else if(B){var g=u(),h=D(g);return g.width*=h,g.height*=h,a().css(g),O.trigger({type:"pageresize",image:O,index:o(),width:g.width,height:g.height}),void 0}}function _(){O.unbind(I),O._page=null,O=null}function x(t,e){"function"==typeof e&&F.push(e),b()&&!O._size.isEmpty()&&(O._prevzoom=O._reqzoom,t&&!vo.loading?O.animate({height:Math.round(O._size.height*r()),width:Math.round(O._size.width*r())},{duration:io,easing:"easeOutQuad",complete:z,queue:!1}):(A(),z()))}function b(){var t=R(O._reqzoom,r());if(!t){var e=Math.abs(O._reqzoom*O._size.width-r()*O._size.width),n=Math.abs(O._reqzoom*O._size.height-r()*O._size.height);1>e&&1>n&&(t=!0)}return!t||w()}function w(){return!R(O._scaledzoom,r())}function z(){O.trigger({type:"pagezoom",index:o(),height:Math.round(O._size.height*r()),width:Math.round(O._size.width*r()),prevzoom:O._prevzoom,zoom:r()}),0===vo.prpr?f():T()}function A(){var t=c(void 0,u()),e=c();O.height(t.height),O.width(t.width),O._domEl.width(e.width),O._domEl.height(e.height),O._scaledzoom=r(),S(O._viewrotation),Ne(o(),e.width,e.height)}function k(){T(),h("ImageError","Image at frameIndex "+O._index+" failed to load.")}function P(){var t=D();l(t/bo.zoom),A()}function D(t){var e=1;t=t||O._size;var n={width:bo.forcepagesize.width*(oo?1:bo.zoom),height:bo.forcepagesize.height*(oo?1:bo.zoom)};return(n.width<1||n.height<1)&&(n.width=mo.size.width*bo.zoom,n.height=mo.size.height*bo.zoom),e=t.width/n.width>t.height/n.height?n.width/t.width:n.height/t.height}function T(){F.length>0&&j(F,O)}function M(){var t=fo.document.getPageRotation(o());return 0===O._viewrotation&&t!==O._rotation||0!==O._viewrotation}function U(){var t=fo.document.getPageRotation(o());return 0===O._viewrotation&&t!==O._rotation||0!==O._viewrotation&&(O._viewrotation+O._rotation)%360!==t}function E(t){if("function"==typeof t&&F.push(t),M()){var e=fo.document.getPageRotation(o());if(U()&&O&&O._loaded&&O._page&&(e=(360+e-O._rotation)%360,S(e),v()),0===vo.prpr&&O._loaded)return f(),void 0}T()}function C(){O._viewrotation=0}function S(t){B&&0!==t&&(O.remove(void 0,!0),O._page.nullinserted=!0);var e=u(),n=c(void 0,e),o=0,i=0,r="";(90===t||270===t)&&(o=(n.height-n.width)/2,oo&&e.width<e.height&&(o=0),i=(n.width-n.height)/2,n=V(n)),0!==t?(r+=" translate("+o+"px,"+i+"px)",r+="rotate("+t+"deg)",O.css(Atalasoft.Utils.__htmlTransformStyle(r))):O.css(Atalasoft.Utils.__htmlTransformStyle("")),a().css({width:n.width,height:n.height}),O._viewrotation=t}function V(t){var e=t.width;return t.width=t.height,t.height=e,t}var F="function"==typeof n?[n]:[],O=eo(new Image),B=Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)<=8;O._domEl=y(),O._domEl.addClass(yo.atala_page_image_anchor),O.addClass(yo.atala_page_image),B||O._domEl.append(O);var I={load:p,error:k,inserted:g};return O._binds=I,O._index=t,O._loaded=!1,O._size={width:0,height:0,isEmpty:function(){return 0===this.width&&0===this.height}},O._zoom=-1,O._prevzoom=O._zoom,O._scaledzoom=-1,O._rotation=0,O._viewrotation=0,O.dispose=_,O.zoom=x,O.needsZoom=b,O.getSize=s,O.getScaledSize=c,O.getFitZoom=r,O.getFitMultiplier=i,O.needsRotate=M,O.rotate=E,O.getDomElement=a,d(),O}function O(t,e){function n(t){f._pagenum=t}function o(){return f.height()-f[0].clientHeight}function a(t){f._scrollSize=t}function i(t){f._ratio=t}function r(){if(!f.propagationPaused()){clearTimeout(f._tooltip._timeout),co.scroller.stop(),co.scroller.pauseEventPropagation(!0);var t={};f._direction===go.Vertical?(co.scroller.scrollTop(f[0].scrollTop*f._ratio),f._pagenum=s(f,f[0].scrollTop),t.right=f.width()+10+"px",t.top=16+Math.round((f[0].offsetHeight-48)/f[0].scrollHeight*f[0].scrollTop)+"px"):f._direction===go.Horizontal&&(co.scroller.scrollLeft(f[0].scrollLeft*f._ratio),f._pagenum=s(f,f[0].scrollLeft),t.bottom=f.height()+10+"px",t.left=16+Math.round((f[0].offsetWidth-48)/f[0].scrollWidth*f[0].scrollLeft)+"px"),f._direction===bo.direction&&("none"===f._tooltip.css("display")&&(f._tooltip.css(t),f._tooltip.show()),f._tooltip.html("Page "+f._pagenum),f._tooltip._timeout=setTimeout(l,1e3))}}function l(){f._tooltip.hide(),mo.number===f._pagenum||je(f._pagenum)||Te(f._pagenum),Mn()}function s(t,e){if(bo.forcepagefit){e*=t._ratio;var n=t._direction===go.Vertical?{x:0,y:e}:{x:e,y:0};return X(n.x,n.y)+1}return Math.floor(e/(t._max/fo.document.getPageCount()))+1}var u=Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)<8,c="overflow:scroll; position:absolute; background-color:Transparent;",d=y(t);d.css({position:"absolute",display:"none","background-color":"white"});var f=null;return e===go.Horizontal?(f=eo('<div style="'+c+'bottom:0px; left:0px; width:100%;"></div>').appendTo(t),f._tray=eo('<div style="width:1000px; height:1px;"></div>').appendTo(f)):(u&&(c+="width:"+(ne()+1)+"px;"),f=eo('<div style="'+c+'top:0px; right:0px; height:100%;"></div>').appendTo(t),f._tray=eo('<div style="width:1px; height:1000px;"></div>').appendTo(f)),I(f),f._ratio=1,f._direction=e,f._tooltip=d,f._pagenum=-1,f._scrollSize=0,f.pageNum=n,f.scrollbarHeight=o,f.scrollSize=a,f.ratio=i,f.bind({scroll:r}),f}function B(t){t&&t._tooltip&&(clearTimeout(t._tooltip._timeout),t._tooltip.hide())}function I(t){function e(){t.unbind(n),t.resumeEventPropagation()}var n={scroll:e};t._pauseEP=0,t.propagationPaused=function(){return t._pauseEP>0},t.pauseEventPropagation=function(e){t._pauseEP++,e&&t.bind(n)},t.resumeEventPropagation=function(){t._pauseEP>0&&t._pauseEP--}}function H(t){var e=oe(),n=W(0,t);n.width=mo.smallest.width>0&&mo.smallest.width<n.width?mo.smallest.width:n.width,n.height=mo.smallest.height>0&&mo.smallest.height<n.height?mo.smallest.height:n.height;var o,a=Math.ceil(e.width/n.width)+2,i=Math.ceil(e.height/n.height)+2;return bo.tabular?(bo.direction===go.Vertical&&bo.columns>0?a=bo.columns:bo.direction===go.Horizontal&&bo.rows>0&&(i=bo.rows),o=a*i):bo.direction===go.Vertical?o=i:bo.direction===go.Horizontal&&(o=a),o}function R(t,e){return t+1e-8>e&&e>t-1e-8}function L(t){try{t.parentNode&&t.parentNode.removeChild(t),so.appendChild(t),so.innerHTML=""}catch(e){}}function j(t){for(var e=Array.prototype.slice.call(arguments,1);t.length;)t.shift().apply(this,e)}function q(){return 0!==mo.size.width?bo.minwidth/mo.size.width:1}function N(){return 0!==mo.size.width?bo.maxwidth/mo.size.width:1}function W(t,e,n){if(n="undefined"==typeof n?!0:n,vo.newpagedivsize){var o={width:vo.newpagedivsize.width,height:vo.newpagedivsize.height},a=bo.showpageborder&&n?2*bo.pageborderwidth:0,i=(e||bo.zoom)/vo.newpagedivfullzoom;return o.height=Math.round(o.height*i)+a,o.width=Math.round(o.width*i)+a,o}return Z(t,e||bo.zoom,bo.showpageborder&&n)}function Z(t,e,n){var o=eo.extend({},ee(t)),a=n?2*bo.pageborderwidth:0;return e*=ln(t),o.height=Math.round(o.height*e)+a,o.width=Math.round(o.width*e)+a,o}function $(t,e){return G(null,t,e).index}function X(t,e){var n=oe(),o={x:t+bo.pageselectlocation.x*n.width,y:e+bo.pageselectlocation.y*n.height};return $(o.x,o.y)}function J(t,e){for(var n={left:0,top:0},o=t;null!=o&&o!==e;o=o.offsetParent)n.left+=o.offsetLeft,n.top+=o.offsetTop;return n}function Y(){if(wo.isEmpty()||wo.zoom!==bo.zoom){var t=G(null,null,null,bo.zoom);wo.height=t.height,wo.width=t.width,wo.zoom=bo.zoom}return wo}function G(t,e,n,o){if(bo.tabular)return Q(t,e,n,o);var a=fo.document.getPageCount(),i={height:0,width:0,index:0};if(t=null==t?t=a:t,bo.direction===go.Vertical)for(var r=null,l=0;a>l&&t>l&&(i.height+(r=W(l,o).height)<=n||null==n);l++)i.height+=r+bo.pagespacing,i.index++;else if(bo.direction===go.Horizontal)for(var s=null,u=0;a>u&&t>u&&(i.width+(s=W(u,o).width)<=e||null==e);u++)i.width+=s+bo.pagespacing,i.index++;return i.index>=a&&a>0&&(i.index=a-1),i}function Q(t,e,n,o){var a=fo.document.getPageCount(),i={height:0,width:0,index:0},r=K(o);t=null==t?t=a:t;var l,s;bo.direction===go.Vertical?(l=r||1,s=Math.ceil(a/l)):bo.direction===go.Horizontal&&(s=r||1,l=Math.ceil(a/s));var u=W(0,o);u.width+=bo.pagespacing,u.height+=bo.pagespacing;var c=null==n?Math.floor(t/l):Math.floor(n/u.height),d=null==e?t%l:Math.ceil(e/u.width);return i.height=c*u.height,i.width=d*u.width,i.index=c*l+d,i.index>=a&&a>0&&(i.index=a-1),i}function K(t){var e=1;return bo.tabular&&(bo.direction===go.Vertical?e=Math.floor(oe().width/W(0,t).width):bo.direction===go.Horizontal&&(e=Math.floor(oe().height/W(0,t).height))),e}function te(t){var e=ee(t),n=un(t);return n%180===0?e:{width:e.height,height:e.width}}function ee(t){var e=fo.document.getPageSize(t);return e?e:mo.size}function ne(){var t=y(eo("body")),e=y(t);t.css({width:"50px",height:"50px",overflow:"hidden",position:"absolute",visibility:"hidden"}),e.css({width:"100px",height:"100px"});var n=t.width();t.css({"overflow-y":"scroll"});var o=n-t[0].clientWidth;return eo(t).remove(),o}function oe(){return co.scrollH&&co.scrollV?{width:co.main.width()-co.scrollV.width(),height:co.main.height()-co.scrollH.scrollbarHeight()}:{width:co.main.width(),height:co.main.height()}}function ae(){var t=oe(),e=bo.showpageborder?2*bo.pageborderwidth:0,n={width:t.width-e,height:t.height-e};return bo.tabular&&(bo.columns>1&&(n.width=Math.floor((t.width-(bo.pagespacing+e)*bo.columns)/bo.columns)),bo.rows>1&&(n.heifght=Math.floor((t.height-(bo.pagespacing+e)*bo.rows)/bo.rows))),n}function ie(t,e){var n={status:"fail",started:!1,reason:t};return"function"==typeof e&&e.call(),n}function re(t,e,n,o,a,i){var r=J(t,e);return r.left<a&&r.left+t.clientWidth>n&&r.top<i&&r.top+t.clientHeight>o}function le(t,e,n){return e<t.length?(t.splice(n,0,t.splice(e,1)[0]),!0):!1}function se(t){bo.showstatus&&co.status&&co.status.html(t),Kn({type:"statusmessage",message:t})}function ue(t,e){var n;if(1===t.length&&"object"==typeof t[0])n=t[0];else if("string"==typeof t[0]){n={};var o=null;3===t.length?o=t[2]:2===t.length&&(o=t[1]);for(var a=t[0].indexOf(" ")>-1?t[0].split(" "):[t[0]],i=0;i<a.length;i++)n[a[i]]=o}for(var r in n)if(n.hasOwnProperty(r)){var l=null;if(r in xo?l=xo:no&&r in no.annotations.events?l=no.annotations.events:no&&r in no.forms.events?l=no.forms.events:no&&r in no.document.events&&(l=no.document.events),null==l&&(l=xo),null==l[r]&&e)l[r]=[n[r]];else if(e)l[r].push(n[r]);else if(n[r])for(var s=0;s<l[r].length;s++)l[r][s]===n[r]&&l[r].splice(s,1);else l[r].length=0}}function ce(){bo.direction=bo.direction===go.Vertical||bo.direction===go.Horizontal?bo.direction:go.Vertical,bo.fitting=bo.fitting===po.None||bo.fitting===po.Best||bo.fitting===po.Width||bo.fitting===po.Height?bo.fitting:po.Width,bo.pageborderwidth=fe(bo.pageborderwidth)?parseInt(bo.pageborderwidth,10):1,bo.pagespacing=fe(bo.pagespacing)?parseInt(bo.pagespacing,10):4,bo.showpageborder=bo.showpageborder?!0:!1,bo.showpagenumber=bo.showpagenumber?!0:!1,bo.showstatus=bo.showstatus?!0:!1,bo.zoom=fe(bo.zoom,!0)?parseFloat(bo.zoom):1,bo.scripturl=de(bo.scripturl)?bo.scripturl:bo.scripturl+"/"}function de(t){return t.length>0?-1!==t.indexOf("/",t.length-1)||-1!==t.indexOf("\\",t.length-1)?!0:!1:!0}function fe(t,e){return e?isFinite(parseFloat(t)):isFinite(parseInt(t,10))}function pe(t,e,n,o,a){if(null==a&&"function"==typeof o&&(a=o,o=null),t=null==t?co.scroller.scrollLeft():t,e=null==e?co.scroller.scrollTop():e,bo.direction===go.Horizontal){if(t>co.viewport.width()){var i=Y();if(t<i.width&&co.content.width()>0){var r=i.width-(co.edges[0].width()+co.content.width());co.edges[1].width(r)}}}else if(bo.direction===go.Vertical&&e>co.viewport.height()){var l=Y();if(e<l.height&&co.content.height()>0){var s=l.height-(co.edges[0].height()+co.content.height());co.edges[1].height(s)}}co.scroller.stop(),!n||vo.loading||vo.scrollPos.x===t&&vo.scrollPos.y===e?(co.scroller.scrollLeft(t),co.scroller.scrollTop(e),"function"==typeof a&&a.call()):eo.when(co.scroller.animate({scrollLeft:t,scrollTop:e},{duration:o||ro,easing:"easeOutQuad",queue:!1})).done(a)}function ge(t,e,n,o,a){var i=co.scroller.scrollLeft()+t,r=co.scroller.scrollTop()+e;pe(i,r,n,o,a)}function he(t,e){if(co.scroller.is(":animated"))return ie("scrolling",e);var n=G(mo.number+t-1);bo.direction===go.Vertical?pe(null,n.height,!0,e):bo.direction===go.Horizontal&&pe(n.width,null,!0,e)}function me(){if(co.scrollH&&co.scrollV){var t=3e4,e=fo.document.getPageCount();if(co.scrollH.pauseEventPropagation(),co.scrollV.pauseEventPropagation(),bo.direction===go.Vertical){ye(co.scrollH,"width");var n=Math.round(G(e-1).height+W(e-1).height);co.scrollV.scrollSize(n-(co.scrollV.height()-co.scrollH.scrollbarHeight()-1)),n>t?(co.scrollV.ratio(n/(t-(co.scrollV.height()-co.scrollH.scrollbarHeight()-1))),co.scrollV._tray.height(t)):(co.scrollV._tray.height(n),co.scrollV.ratio(1))}else if(bo.direction===go.Horizontal){ye(co.scrollV,"height");var o=Math.round(G(e-1).width+W(e-1).width);co.scrollH.scrollSize(o),o>t?(co.scrollH.ratio(o/(t-(co.scrollH.width()-co.scrollV.width()-1))),co.scrollH._tray.width(t)):(co.scrollH._tray.width(o),co.scrollH.ratio(1))}co.scrollV._max=Math.max(co.scrollV._tray.height()-co.scrollV[0].clientHeight,0)+1,co.scrollV.ratio(co.scrollV._scrollSize/co.scrollV._max),co.scrollH._max=Math.max(co.scrollH._tray.width()-co.scrollH[0].clientWidth,0)+1,co.scrollH.ratio(co.scrollH._scrollSize/co.scrollH._max),co.scrollH.resumeEventPropagation(),co.scrollV.resumeEventPropagation()}}function ve(t,e){bo.direction===go.Vertical?(co.scrollV&&(co.scrollV.scrollSize(Math.max(co.scrollV._scrollSize+e,0)),co.scrollV._tray.height(co.scrollV._tray.height()+e),co.scrollV._max=Math.max(co.scrollV._tray.height()-co.scrollV[0].clientHeight,0)+1,co.scrollV.ratio(co.scrollV._scrollSize/co.scrollV._max)),ye(co.scrollH,"width")):bo.direction===go.Horizontal&&(co.scrollH&&(co.scrollH.scrollSize(Math.max(co.scrollH._scrollSize+t,0)),co.scrollH._tray.width(co.scrollH._tray.width()+t),co.scrollH._max=Math.max(co.scrollH._tray.width()-co.scrollH[0].clientWidth,0)+1,co.scrollH.ratio(co.scrollH._scrollSize/co.scrollH._max)),ye(co.scrollV,"height"))}function ye(t,e){if(t){for(var n=Math.round(mo.size[e]*bo.zoom),o=0;o<co.pageDivs.length;o++)null!=co.pageDivs[o]._index&&(n=Math.max(W(co.pageDivs[o]._index)[e],n));t._tray[e](n),t.scrollSize(n-t[e]()),t.ratio(1)}}function _e(t){if(!vo.zooming&&!vo.scrollBuffer){var e=(new Date).getTime(),n=co.scroller[0].scrollLeft,o=co.scroller[0].scrollTop,a=n+co.scroller[0].clientWidth,i=o+co.scroller[0].clientHeight,r=$(n,o)+1,l=Math.abs(r-mo.number);if(!vo.loading){var s=0===l&&co.pageDivs.length>1&&(mo.number-1<co.pageDivs[0]._index||mo.number-1>co.pageDivs[co.pageDivs.length-1]._index);l<co.pageDivs.length&&!s?re(co.edges[1][0],co.scroller[0],n,o,a,i)?Pe(l):re(co.edges[0][0],co.scroller[0],n,o,a,i)?ke(l):r!==mo.number&&null===qe(r-1)&&Te(r):Me(r,!1,null),an()}if(Ee(X(n,o)+1),!co.scroller.propagationPaused()&&co.scrollH&&co.scrollV){var u=Math.round(n/co.scrollH._ratio),c=Math.round(o/co.scrollV._ratio);u!==co.scrollH.scrollLeft()&&(co.scrollH.pauseEventPropagation(!0),co.scrollH.scrollLeft(u)),c!==co.scrollV.scrollTop()&&(co.scrollV.pauseEventPropagation(!0),co.scrollV.scrollTop(c))}Kn({type:"scroll",x:n,y:o,dx:n-vo.scrollPos.x,dy:o-vo.scrollPos.y}),t&&(vo.scrollTimeout&&clearTimeout(vo.scrollTimeout),vo.scrollTimeout=setTimeout(function(){xe(n,o)},500),vo.scrollPos.x=n,vo.scrollPos.y=o,vo.scrollPos.t=e),vo.scrollBuffer=t?setTimeout(be,50):null}}function xe(t,e){var n=co.scroller[0].scrollLeft,o=co.scroller[0].scrollTop,a=n===vo.scrollPos.x&&o===vo.scrollPos.y;t===vo.scrollPos.x&&e===vo.scrollPos.y&&a?(Mn(),vo.scrollTimeout=null):a||(_e({}),vo.scrollTimeout=null)}function be(){null!==vo.scrollBuffer&&(clearTimeout(vo.scrollBuffer),vo.scrollBuffer=null)}function we(){bo.direction===go.Vertical?Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)<8&&(co.edges[0].width(co.content.width()),co.edges[1].width(co.content.width())):bo.direction===go.Horizontal&&(co.edges[0].height(co.pageDivs[0].height()),co.edges[1].height(co.pageDivs[0].height()))}function ze(t,e){e=null===e?t+co.pageDivs.length:e;var n=bo.tabular?K():1;if(bo.direction===go.Vertical)co.edges[0].height(G(t).height),e+n>=fo.document.getPageCount()?co.scrollH?co.edges[1].height(co.scrollH.scrollbarHeight()):co.edges[1].height(1):(co.edges[1].height(G(co.pageDivs.length).height),Atalasoft.Utils.Browser.Chrome&&co.content.height(""));else if(bo.direction===go.Horizontal)if(co.edges[0].width(G(t).width),e+n>=fo.document.getPageCount())co.scrollV?co.edges[1].width(co.scrollV.width()):co.edges[1].width(1);else{var o=G(t).width,a=Y().width,i=G(co.pageDivs.length).width,r=a-(i+o);co.edges[1].width(r),co.edges[1].height(1)}}function Ae(){return vo.activepage}function ke(t){if(t=t?t:1,0===vo.prpr&&co.pageDivs.length>0){var e=K(bo.zoom);Ie();for(var n=t;n>0;n--){var o=co.pageDivs[0]._index-e;if(o>=0&&o<fo.document.getPageCount()){for(var a=e-1;a>=0;a--){var i=Re(-1);Ve(i),co.content.prepend(i),Oe(i,Le(o+a),o+a)}ze(o,null),we(),Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)<=8&&(co.content[0].className=co.content[0].className)}}setTimeout(He,10)}}function Pe(t){t=t?t:1;var e=co.pageDivs[co.pageDivs.length-1]._index+1;if(0===vo.prpr&&co.pageDivs.length>0&&e<fo.document.getPageCount()){Ie();for(var n=t;n>0;n--){var o=co.pageDivs[co.pageDivs.length-1]._index+1;if(o<fo.document.getPageCount()){for(var a=o-co.pageDivs.length,i=K(bo.zoom),r=0;i>r;r++){var l=Re(1);Ve(l),co.content.append(l),Oe(l,Le(o+r),o+r)}ze(a+1,o),we()}}setTimeout(He,10)}}/**
	* Scrolls the viewer to the given page index and executes the callback when finished
	* @param i int, page index (0 based)
	* @param callback: function to execute after this operation is done
	* @returns undefined
	*/
function De(t,e){Te(t+1,e)}/**
	* Scrolls the viewer to the given page number and executes the callback when finished
	* @param i: int, page number (1 based)
	* @param callback: function to execute after this operation is done
	* @returns undefined
	*/
function Te(t,e){if(t=Math.max(1,t),t=Math.min(fo.document.getPageCount(),t),mo.number!==t){var n=t-mo.number;Math.abs(n)<co.pageDivs.length?he(n,e):Me(t,!0,e)}else"function"==typeof e&&e.call()}function Me(t,e,n){var o=fo.document.getPageCount(),a=t-1;if(0===vo.prpr&&o>0){var i=function(){He(!e),"function"==typeof n&&n.call()};Ie();var r=0,l=0,s=0>=a?0:a;if(s+co.pageDivs.length>=o&&(s=Math.max(o-co.pageDivs.length,0)),bo.direction===go.Vertical){r=G(s).height,co.edges[0].height(r),ze(s,null),we(),Ce();for(var u=0;u<co.pageDivs.length;u++)co.content.append(co.pageDivs[u]),Oe(co.pageDivs[u],null,s+u);var c=G(Math.max(a,0)).height,d=mo.number<t?-mo.size.height:mo.size.height;e&&c!==vo.scrollPos.y?(pe(null,c+d,!1),pe(null,c,!0,i)):i.call()}else if(bo.direction===go.Horizontal){l=G(s).width,co.edges[0].width(l),ze(s,null),we(),Ce();for(var f=0;f<co.pageDivs.length;f++)co.content.append(co.pageDivs[f]),Oe(co.pageDivs[f],null,s+f);var p=G(Math.max(a,0)).width,g=mo.number<t?-mo.size.width:mo.size.width;e&&p!==vo.scrollPos.x?(pe(p+g,null,!1),pe(p,null,!0,i)):i.call()}}else ie("paused",n)}function Ue(t){vo.activepage=t}function Ee(t){var e=fo.document.getPageCount();if(t>0&&e>=t){if(mo.number!==t||mo.numberoutof!==e){if(co.pageLabel.html(t+" / "+e),mo.number!==t){mo.number=t;for(var n=0;n<co.pageDivs.length;n++){var o=co.pageDivs[n];o._index===t-1?o.addClass(yo.atala_active_page):o.removeClass(yo.atala_active_page)}Kn({type:"pagenumberchanged",number:mo.number})}mo.numberoutof!==e&&(mo.numberoutof=e)}}else co.pageLabel.html(""),co.viewport.find("."+yo.atala_active_page).removeClass(yo.atala_active_page)}function Ce(){for(var t=co.pageDivs.length-1;t>=0;t--)Ve(co.pageDivs[t])}function Se(){for(var t=0;t<co.loadedImgs.length;t++)co.loadedImgs[t]&&(co.loadedImgs[t].dispose(),co.loadedImgs[t].remove());co.loadedImgs.length=0}function Ve(t){t.detach(),null!=t._img&&(t._img.getDomElement().detach(),t._img=null),Kn({type:"pagerecycled",page:t}),t._index=-1,t.removeAttr(_o.atala_page_index)}function Fe(t){t._index=-1,t.removeAttr(_o.atala_page_index),t._img=null,t.remove()}function Oe(t,e,n,o){if(t._index===n&&t._img===e&&!o)return!1;if(o&&!t.nullinserted&&e){var a=fo.document.getPageReference(n);if("object"==typeof a?a=a.mapsto:("undefined"==typeof a||null===a)&&(a=e._index),e._index!==a)return}t._index=n,t.attr(_o.atala_page_index,n),t._img&&t.has(t._img).length>0&&t._img!==e&&t._img.getDomElement().remove(void 0,!0),t._rubberband&&t._rubberband.reset(),t._img=e,t._img&&(t._img._page=t),t.css({display:bo.tabular||bo.direction===go.Horizontal?"inline-block":"block"}),bo.showpagenumber&&(t.css({position:"relative"}),t._num||(t._num=eo('<div style="position:absolute; right:20px; bottom:16px;z-index:1"/>'),t._num.addClass(yo.atala_page_number),t.append(t._num)),t._num.text(t._index+1));var i=Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)<=8,r=i&&t._img&&!t._img._loaded;if(t._img&&t._img._binds&&(t._img._binds.pageresize||(t._img._binds.pageresize=function(e){Kn({type:"pageresize",page:t,image:e.image,index:t._index,width:e.width,height:e.height})},t._img.bind({pageresize:t._img._binds.pageresize})),t._img._binds.pagesizechanged||(t._img._binds.pagesizechanged=function(e){Kn({type:"pagesizechanged",page:t,image:e.image,index:t._index,width:e.width,height:e.height,dx:e.dx,dy:e.dy})},t._img.bind({pagesizechanged:t._img._binds.pagesizechanged}))),t._img&&!r){var l=t._img.getDomElement();i&&0===l.find(t._img).length&&l.append(t._img),t.append(l),t._img.trigger({type:"inserted",page:t}),t._img._loaded||(t.nullinserted?t._img.css({width:t.width(),height:t.height()}):Be(t._img)),vo.newpagedivsize||t.css({width:"",height:""}),t.nullinserted=!1}else t.nullinserted=!0,vo.newpagedivsize||Be(t,t._index);return Kn({type:"pageshown",page:t,index:t._index}),!0}function Be(t,e){var n=W(e,null,!1);t.css({width:n.width,height:n.height})}function Ie(){vo.prpr++}function He(t){0===vo.prpr?h("ResumePageRequestsError","Nothing to resume"):(vo.prpr--,0!==vo.prpr||t||_e())}function Re(t){return t>0?(le(co.pageDivs,0,co.pageDivs.length-1),co.pageDivs[co.pageDivs.length-1]):(le(co.pageDivs,co.pageDivs.length-1,0),co.pageDivs[0])}function Le(t,e){var n=fo.document.getPageReference(t),o=-1;return null!==n&&("number"==typeof n?(t=n,o=t,n=null):"object"==typeof n&&(o=n.mapsto)),!co.loadedImgs[o]&&o>=0?co.loadedImgs[o]=F(t,n,function(t){co.loadedImgs.length<=o&&t&&(co.loadedImgs[o]=t,fo.memory.allocate(t)),"function"==typeof e&&e.call()}):"function"==typeof e&&e.call(),co.loadedImgs[o]}function je(t){var e=qe(t);if(e){var n=co.scroller[0].scrollLeft,o=co.scroller[0].scrollTop;return re(e[0],co.scroller[0],n,o,n+co.scroller[0].clientWidth,o+co.scroller[0].clientHeight)}return!1}function qe(t){for(var e=null,n=0;n<co.pageDivs.length&&null===e;n++)co.pageDivs[n]._index===t&&(e=co.pageDivs[n]);return e}function Ne(t,e){var n=qe(t);null!=n&&null!=n._num&&n._num.css({left:e-20,right:0})}function We(){}function Ze(){0===vo.prpr&&(Atalasoft.Utils.Browser.Safari||Atalasoft.Utils.Browser.Chrome?co.edges[1].hide().show():co.edges[1][0].className=co.edges[1][0].className)}function $e(){co.scroller.stop(),co.scroller.pauseEventPropagation(),Ie()}function Xe(){me(),we(),He(),co.scroller.resumeEventPropagation()}function Je(){vo.zooming=!0,$e(),Kn("zoomstarted")}function Ye(t){t=Math.min(t,N()),t=Math.max(t,q()),en(t,!1),bo.zoom=t,an(!1),on(t,!1)}function Ge(){vo.zooming=!1,Xe(),Kn({type:"zoomchanged",zoom:bo.zoom})}/**
	* Asynchronously zooms the viewer to the given zoom over the default zoom duration
	* @param z number, desired zoom level to zoom to
	* @param callback function to execute after the zoom is finished animating
	* @returns undefined
	*/
function Qe(t,e){vo.zooming?ie("zooming",e):(vo.zooming=!0,$e(),Kn("zoomstarted"),e=null==e?Ke:Atalasoft.Utils.__functionFromArray([Ke,e]),t!==bo.zoom?(t=Math.min(t,N()),t=Math.max(t,q()),en(t,!0),bo.zoom=t,an(!0),on(t,!0,e)):"function"==typeof e&&e.call())}function Ke(){vo.zooming=!1,Xe(),_e(),Kn({type:"zoomchanged",zoom:bo.zoom})}function tn(t,e){var n=bo.zoom+(t?-1:1)*bo.zoom*.3;Qe(n,e)}function en(t,e,n){var o=G(mo.number,null,null),a=G(mo.number,null,null,t),i=(co.scroller.scrollLeft()-o.width)/bo.zoom*t,r=(co.scroller.scrollTop()-o.height)/bo.zoom*t;pe(a.width+i,a.height+r,e,io,n)}function nn(){co.edges[0]._z=bo.zoom}function on(t,e,n){if(co.edges.length>0){n="function"==typeof n?Atalasoft.Utils.__functionFromArray([nn,n]):nn;var o=bo.direction===go.Vertical,a=co.pageDivs[0]&&co.pageDivs[0]._img?co.pageDivs[0]._index:0,i=G(a,null,null,t),r=o?i.height:i.width;if(e&&!vo.loading){var l=o?{height:r}:{width:r};co.edges[0].animate(l,{duration:io,easing:"easeOutQuad",complete:n,queue:!1})}else o?co.edges[0].height(r):co.edges[0].width(r),"function"==typeof n&&n.call()}}function an(t,e){for(var n=0,o=!0,a=function(){if(n--,0>=n){if(bo.direction===go.Horizontal){var t=Y().width;co.spacer||(co.spacer=y(),co.spacer.css({position:"absolute",top:"-1px",height:"1px"}),co.viewport.append(co.spacer)),co.spacer.width(t)}"function"==typeof e&&e.call(),Ze()}},i=0;i<co.pageDivs.length;i++)if(co.pageDivs[i]._img){var r=co.pageDivs[i]._img.needsZoom()||co.pageDivs[i]._img.needsRotate();r&&(o=!1,n++,co.pageDivs[i]._img.needsRotate()?co.pageDivs[i]._img.rotate(a):co.pageDivs[i]._img.needsZoom()&&co.pageDivs[i]._img.zoom(t,a))}o&&a.call()}/**
	* Asynchronously zooms the viewer to fit to a page
	* @param f: Fitting enum, type of fitting to fit the page to
	* @param pn: integer, page number to fit to
	* @param callback: function to execute after the fit is done animating
	*/
function rn(t,e,n){var o=bo.zoom,a=ae();null!=e?"function"==typeof e&&(n=e,e=mo.number):e=mo.number;var i=Z(e-1,1,!1),r=!1,l=!1;switch((0===i.width||0===i.height)&&(t=null),t){case po.None:break;case po.Best:i.width/a.width>i.height/a.height?(o=a.width/i.width,r=!0):o=a.height/i.height;break;case po.Height:o=a.height/i.height,l=!0;break;case po.Width:o=a.width/i.width,r=!0;break;default:o=1}r&&pe(0,null,!1),l&&pe(null,0,!1),Qe(o,n)}function ln(t){return fo.document.getPageFitMultiplier(t,ao)}function sn(t){return bo.zoom*fo.document.getPageFitMultiplier(t,ao)}function un(t){return fo.document.getPageRotation(t,ao)}function cn(t){var e=un(t),n=sn(t),o=te(t),a=Raphael.matrix();a.scale(n,n,0,0),a.rotate(e,0,0);var i=dn(a,{x:o.width,y:o.height}),r=Math.min(0,i.x),l=Math.min(0,i.y),s=a.invert(),u=s.x(-r,-l),c=s.y(-r,-l);return a.translate(u,c),a}function dn(t,e){return{x:t.x(e.x,e.y),y:t.y(e.x,e.y)}}function fn(t){var e=eo.data(t.currentTarget,"_config"),n=eo.data(t.currentTarget,"_annoConfig");!n&&e&&(n={type:e.icon}),n&&(fo.mouseTool.setTool(ho.None,ho.None),fo.annotations.drawAnnotation(n,gn,pn))}function pn(){fo.mouseTool.setTool(ho.Pan,ho.None)}function gn(){fo.mouseTool.setTool(ho.Pan,ho.None)}/**
	* Depricated annotation function. Please use 'annotations' subtree.
	* @returns undefined
	*/
function hn(){return bo.allowannotations===!1&&h("InitError",'The "allowannotations" property in the WebDocumentViewer config is set to false.'),bo.allowannotations}function mn(){for(var t=0;t<co.pageDivs.length;t++)co.pageDivs[t]._draw.toFront()}function vn(){for(var t=0;t<co.pageDivs.length;t++)co.pageDivs[t]._draw.reset()}function yn(t,e){function n(t){_n(t,e)}function o(t,n,o){xn(t,n,o,e)}vo.loading=!0;var a={atala_docurl:bo.documenturl,atala_pagebuffer:bo.pagebuffersize,atala_minwidth:bo.minwidth};null!=t&&("function"==typeof t&&(e=t,t=null),eo.extend(a,t));var i={type:"docinfo",serverurl:bo.serverurl,query:"?ataladocinfo=",method:"GET",data:a,cancel:!1,info:{pagewidth:-1,pageheight:-1,pagecount:-1}};Fn(i,n,o)}function _n(t,e){if(t&&t.licensed!==!1)mo.size.width=t.pagewidth,mo.size.height=t.pageheight,mo.count=t.pagecount,mo.buffer=bo.pagebuffersize,mo.dpi=t.dpi,mo.vector=t.vector===!0,wo.zero(),fo.memory.clearEntries(),fo.memory.setColorDepth(t.colordepth),fo.memory.setPageSize(t.pagewidth,t.pageheight),Kn("documentinfochanged"),vo.loading&&(V(),pe(0,0),co.scrollV&&co.scrollV.pageNum(1),Ee(1),rn(bo.fitting,1,function(){we(),ze(0,co.pageDivs.length);for(var n=0;n<co.pageDivs.length&&n<mo.count;n++)co.content.append(co.pageDivs[n]),Oe(co.pageDivs[n],null,n);co.pageDivs.length>0&&co.pageDivs[0].addClass(yo.atala_active_page),t.layers?fo.annotations.loadAnnotations(t):bo.annotationsurl&&fo.annotations&&fo.annotations.clear(),fo.forms&&(fo.forms.clear(),t.forms&&fo.forms.loadForms(t)),t.error&&h("DocumentLoadError",t.error),"function"==typeof e&&e.call()})),vo.loading=!1;else{if(t&&t.licensed===!1){var n=t.error?t.error:"LicenseException: Handler was unable to find a valid license.";h("LicenseException",n)}else h("DocumentLoadError","HandlerException: Handler did not return any data.");vo.loading=!1,"function"==typeof e&&e.call()}}function xn(t,e,n,o){if(t.responseText){var a=t.responseText.substr(t.responseText.indexOf("</html>")+7);a.indexOf("<!--")>=0?(a=a.replace("<!--","").replace("-->",""),a.length>0&&(n="<pre>"+a+"</pre>")):t.responseText.indexOf("web.config")>0&&t.responseText.indexOf("customErrors")>0&&(n+=": web.config customErrors attribute has disabled remote error messages.")}h("DocumentLoadError",n),"function"==typeof o&&o.call()}function bn(){V();for(var t=fo.document.getPageCount(),e=co.pageDivs.length?co.pageDivs[0]._index:0,n=0;n<co.pageDivs.length&&t>n;n++){var o=isFinite(co.pageDivs[n]._index)?co.pageDivs[n]._index:e+n;Ve(co.pageDivs[n]),co.content.append(co.pageDivs[n]),Oe(co.pageDivs[n],null,o)}Mn()}function wn(t,e){function n(t){zn(t),"function"==typeof e&&e.call()}var o={atala_docurl:bo.documenturl,atala_spath:bo.savepath};eo.extend(o,t);var a={type:"docsave",serverurl:bo.serverurl,query:"?ataladocsave=",method:"POST",data:o,cancel:!1,info:{success:void 0,error:void 0}};Fn(a,n,n)}function zn(t){t.error?h("DocumentSaveError",t.error):se("DocumentSave: success="+t.success),Kn({type:"documentsaved",success:t.success})}function An(t,e){var n=null;return"string"==typeof t?(n={},vo.initialized&&e&&(t.length>0?n=e.createHandlerRequest(bo.serverurl,t):0===t.length&&e.clear()),n.url=t):"undefined"!=typeof t&&null!=t&&h("openUrlError","string input expected for url."),n}function kn(){Gn({annotationsloaded:Cn})}function Pn(t,e){fo.annotations&&(kn(),fo.annotations.makeHandlerRequest(t,e))}function Dn(){Gn({formsloaded:Sn})}function Tn(t,e){fo.forms&&(Dn(),fo.forms.makeHandlerRequest(t,e))}function Mn(t){if(!(co.pageDivs.length>0&&"undefined"==typeof co.pageDivs[0]._index))for(var e=0;e<co.pageDivs.length;e++)En(co.pageDivs[e],t)}function Un(t,e){var n=qe(t);n&&En(n,e)}function En(t,e){(Oe(t,Le(t._index),t._index)||e)&&(fo.annotations&&fo.annotations.showLayer(t._index,t),fo.forms&&!oo&&fo.forms.showLayer(t._index,t))}function Cn(t){t.error&&(h("AnnotationsLoadError",t.error),bo.annotationsurl=""),fo.annotations&&Qn({annotationsloaded:Cn})}function Sn(t){t.error&&(h("FormsLoadError",t.error),bo.formsurl=""),fo.forms&&Qn({formsloaded:Sn})}function Vn(t){Kn({type:"beforehandlerrequest",request:t})}function Fn(t,e,n){var o=On(t,function(t){e(t.request.info)});Vn(t),t.cancel||(Qn({handlerreturned:o}),t.serverurl&&!eo.isEmptyObject(t.data)&&(t.info instanceof jQuery&&"docpage"===t.type?t.info.attr("src",t.serverurl+t.query+"&"+eo.param(t.data)):eo.ajax({type:t.method,url:t.serverurl+t.query+"?",dataType:"json",data:t.data,success:e,error:n})))}function On(t,e){var n=function(o){o.request===t&&(Qn({handlerreturned:n}),"function"==typeof e&&e.call(this,o))};return Gn({handlerreturned:n}),n}function Bn(){if(bo.debug){var t={};return eo.extend(!0,t,{dom:co,controllers:fo,page:mo}),t}return null}function In(t,e){function n(){this.typeOf="__LVlinker",this._id=ao,this._config=bo,this._controllers=fo,this._dom=co,this._page=mo,this._state=vo,this._annos=null,this._fields=null,this._changes=null,this.__createDialog=k,this.__createDiv=y,this.__createDOM=v,this.__createDropDownButton=P,this.__createDropDownMenu=D,this.__createMenu=A,this.__getPageSize=ee,this.__getTabularIndexOffset=K,this.__redrawVisiblePages=Mn,this.__status=se}if(t&&"Atalasoft.Controls.WebDocumentThumbnailer"===t.typeOf){var o=new n;return fo.document.__linkChanges(e||o),bo.allowannotations&&(t!==no&&bo.annotationsurl.length>0&&(bo.annotationsurl=""),fo.annotations.__linkAnnotations(o)),bo.allowforms&&(t!==no&&bo.annotationsurl.length>0&&(bo.formurl=""),fo.forms.__linkForms(o)),o}}/**
	* Resets the viewer to its default state
	* @param callback function to execute when the empty process is finished
	*/
function Hn(t){vo.loading=!0;var e=function(){Kn({type:"documentunloaded"}),"function"==typeof t&&t.call()};Ce(),Se(),_n({pagewidth:0,pageheight:0,pagecount:-1},e)}/**
	* Gets the current zoom level of the viewer
	* @returns decimal number
	*/
function Rn(){return bo.zoom}/**
	* Indicates whether the viewer is ready to receive commands
	* @returns bool
	*/
function Ln(){return vo.initialized}/**
	* Scrolls to the given coordinates, does not account for zoom
	* @param x number indicating the coordinate of the x axis 
	* @param y number indicating the coordinate of the y axis 
	* @param ani bool indicating whether to animate this scroll
	* @param callback function to execute when the scroll operation is finished
	* @returns undefined
	*/
function jn(t,e,n,o){null==o&&"function"==typeof n&&(o=n,n=!1),pe(t,e,n,null,o)}/**
	* Scrolls by the given deltas, does not account for zoom
	* @param dx number indicating delta of the x axis 
	* @param dy number indicating delta of the y axis 
	* @param ani bool indicating whether to animate this scroll
	* @param callback function to execute when the scroll operation is finished
	* @returns undefined
	*/
function qn(t,e,n,o){null==o&&"function"==typeof n&&(o=n,n=!1),ge(t,e,n,null,o)}/**
	* Scrolls to the next viewable page
	* @param n number of pages to scroll forward
	* @param callback function to execute when the scroll operation is finished
	* @returns undefined
	*/
function Nn(t,e){var n=bo.direction===go.Vertical?K():1;null==e&&"function"==typeof t&&(e=t,t=n),isFinite(t)||(t=n),he(t,e)}/**
	* Scrolls to the previous viewable page
	* @param n number of pages to scroll backward
	* @param callback function to execute when the scroll operation is finished
	* @returns undefined
	*/
function Wn(t,e){var n=bo.direction===go.Vertical?K():1;null==e&&"function"==typeof t&&(e=t,t=n),isFinite(t)||(t=n),he(-t,e)}/**
	* Zooms in one level
	* @param callback function to execute when the zoom operation is finished
	* @returns undefined
	*/
function Zn(t){tn(!1,t)}/**
	* Zooms out one level
	* @param callback function to execute when the zoom operation is finished
	* @returns undefined
	*/
function $n(t){tn(!0,t)}/**
	* Opens the document at the given urls
	* @param surl string: url of the document file with respect to the config.serverurl
	* @param aurl string: url of the annotation xmp file with respect to the config.serverurl
	* @param furl string: url of the form file with respect to the config.serverurl 
	* @param callback function to execute when the open operation is finished
	* @returns undefined
	*/
function Xn(t,e,n,o){null==o&&("function"==typeof e?(o=e,e=null):"function"==typeof n&&(o=n,n=null));var a=0,i=!1,r={},l=An(e,fo.annotations),s=An(n||t,fo.forms);bo.annotationsurl=l?l.url:bo.annotationsurl,bo.formsurl=s?s.url:bo.formsurl;var u=function(){a--,0>=a&&(Mn(),Kn({type:"documentloaded"}),"function"==typeof o&&o.call())};"string"==typeof t?0===t.length?Hn(u):(bo.documenturl=t,vo.initialized&&(Ce(),Se(),B(co.scrollH),B(co.scrollV),a++,0===t.length&&Hn(u),bo.allowannotations&&l&&l.data&&(kn(),eo.extend(r,l.data)),bo.allowforms&&s&&s.data&&(Dn(),eo.extend(r,s.data)),i=!0,yn(r,u))):null==t&&bo.documenturl.length>0&&(e||""===e||n||""===n)||h("openUrlError","string input expected for document url."),i||(l&&(a++,Pn(l,u)),s&&(a++,Tn(s,u)))}/**
	* Saves the client changes in this document to the pre defined save folder or to the given path
	* @param surl string: optional relative path to save to, must be writable 
	* @param callback function to execute when the save has finished
	* @returns
	*/
function Jn(t,e){null==e&&"function"==typeof t&&(e=t,t=null);var n={atala_subpath:t||""};fo.annotations&&eo.extend(n,{atala_iuname:bo.annotations.saveusername,atala_annos:fo.annotations.stringifyChanges()}),fo.forms&&eo.extend(n,{atala_forms:fo.forms.stringifyChanges()}),fo.document&&eo.extend(n,{atala_document:fo.document.stringifyChanges()}),wn(n,e)}/**
	* Gets the current page index
	* @returns number indicating the zero based page index
	*/
function Yn(){return mo.number-1}/**
	* jQuery bind shortcut
	* @returns object, WebDocumentViewer
	*/
function Gn(){return ue(arguments,!0),uo.bind.apply(uo,arguments),no}/**
	* jQuery unbind shortcut
	* @returns object, WebDocumentViewer
	*/
function Qn(){return ue(arguments,!1),uo.unbind.apply(uo,arguments),no}/**
	* jQuery trigger shortcut
	* @returns object, WebDocumentViewer
	*/
function Kn(){return uo.trigger.apply(uo,arguments),no}/**
	* Gets the current document info
	* @returns object indicating document main page size, and number of pages
	*/
function to(){return{count:mo.count,dpi:mo.dpi,size:{height:mo.size.height,width:mo.size.width},vector:mo.vector}}var eo=Atalasoft.$,no={typeOf:e.type||"Atalasoft.Controls.WebDocumentViewer"},oo="Atalasoft.Controls.WebDocumentThumbnailer"===no.typeOf,ao="",io=150,ro=500,lo="atala-ui-icon",so=document.createElement("div"),uo=eo({}),co={/** Main outer object that holds the scrollbars */
main:null,/** Toolbar wrapper object */
toolbar:null,/** Inner object that controls scrolling */
scroller:null,/** Inner object that defines the viewable area */
viewport:null,/** Inner content container object */
content:null,/** Inner horizontal scroll bar object */
scrollH:null,/** Inner vertical scroll bar object */
scrollV:null,/** Edge objects of viewable area */
edges:[],/** Image objects already requested */
loadedImgs:[],/** Page wrapper objects recycle pool */
pageDivs:[],/** Span tag containing the page number */
pageLabel:null,/** Status div */
status:null},fo={annotations:null,document:null,forms:null,mouseTool:null,memory:null},po=Atalasoft.Utils.Fitting,go=Atalasoft.Utils.ScrollDirection,ho=Atalasoft.Utils.MouseToolType,mo={size:{width:0,height:0},sizes:[{width:0,height:0}],smallest:{width:0,height:0},count:0,number:-1,numberoutof:-1,buffer:3,dpi:96,vector:!1},vo={prpr:0,loading:!1,zooming:!1,initialized:!1,newpagedivsize:null,newpagedivfullzoom:1,scrollPos:{x:0,y:0,t:0},scrollBuffer:null,scrollTimeout:null,changes:{},activepage:null},yo={/** Page element class */
atala_page_div:"atala_page_div",/** Page image anchor container element claass*/
atala_page_image_anchor:"atala_page_image_anchor",/** Page image element claass*/
atala_page_image:"atala_page_image",/** Page index element class. see config.showpagenumber. */
atala_page_number:"atala_page_number",/** Active page class */
atala_active_page:"atala_active_page",/** Active thumbnail class */
atala_active_thumb:"atala_active_thumb",/** Document toolbar element class */
atala_toolbar:"atala_toolbar",/** Annotations toolbar element class */
atala_annotation_toolbar:"atala_annotation_toolbar",/** Toolbar button element class */
atala_toolbar_button:"atala_toolbar_button",/** Class of the main outer object that holds the scrollbars */
atala_main_container:"atala_main_container",/** Class of the inner object that controls scrolling */
atala_scroller:"atala_scroller",/** Class of the inner object that defines the viewable area */
atala_viewport:"atala_viewport",/** Inner content container object class */
atala_content:"atala_content",/** Inner horizontal scroll bar object class */
atala_scroll_horizontal:"atala_scroll_horizontal",/** Inner vertical scroll bar object */
atala_scroll_vertical:"atala_scroll_vertical",/** Toolbar span element containing the page number */
atala_page_label:"atala_page_label",/** Status div */
atala_statusbar:"atala_statusbar",/** "Save Changes" toolbar button */
atala_tool_button_save:"atala_tool_button_save",/** "Previous Page" toolbar button */
atala_tool_button_page_prev:"atala_tool_button_page_prev",/** "Next Page" toolbar button */
atala_tool_button_page_next:"atala_tool_button_page_next",/** "Zoom Out" toolbar button */
atala_tool_button_zoom_out:"atala_tool_button_zoom_out",/** "Zoom In" toolbar button */
atala_tool_button_zoom_in:"atala_tool_button_zoom_in",/** "Full Size" toolbar button */
atala_tool_button_fit_none:"atala_tool_button_fit_none",/** "Best Fit" toolbar button */
atala_tool_button_fit_best:"atala_tool_button_fit_best",/** "Fit To Width" toolbar button */
atala_tool_button_fit_width:"atala_tool_button_fit_width",/** "Zoom Area" toolbar button */
atala_tool_button_zoom_area:"atala_tool_button_zoom_area",/** "Rotate Left" tooltip button */
atala_tool_button_rotate_left:"atala_tool_button_rotate_left",/** "Rotate Right" tooltip button */
atala_tool_button_rotate_right:"atala_tool_button_rotate_right",/** "Draw Ellipse" annotation toolbar button */
atala_tool_button_ellipse_anno:"atala_tool_button_ellipse_anno",/** "Draw Highlight" annotation toolbar button */
atala_tool_button_highlight_anno:"atala_tool_button_highlight_anno",/** "Draw Line" annotation toolbar button */
atala_tool_button_line_anno:"atala_tool_button_line_anno",/** "Draw Poly Lines" annotation toolbar button */
atala_tool_button_lines_anno:"atala_tool_button_lines_anno",/** "Draw Freehand" annotation toolbar button */
atala_tool_button_freehand_anno:"atala_tool_button_freehand_anno",/** "Draw Polygon" annotation toolbar button */
atala_tool_button_polygon_anno:"atala_tool_button_polygon_anno",/** "Draw Rectangle" annotation toolbar button */
atala_tool_button_rect_anno:"atala_tool_button_rect_anno",/** "Filled Rectangle" annotation toolbar button */
atala_tool_button_fillrect_anno:"atala_tool_button_fillrect_anno",/** "Draw Text" annotation toolbar button */
atala_tool_button_text_anno:"atala_tool_button_text_anno",/** "Add a Stamp" annotation toolbar button */
atala_tool_button_stamp_anno:"atala_tool_button_stamp_anno",/** "Add a Sticky Note" annotation toolbar button */
atala_tool_button_note_anno:"atala_tool_button_note_anno",/** "Add a Comment" annotation toolbar button */
atala_tool_button_commment_anno:"atala_tool_button_commment_anno",/** Selection Rubberband div object */
atala_tool_selection_band:"atala_tool_selection_band",/** Selection Rubberband grip div object */
atala_tool_selection_grip:"atala_tool_selection_grip",/** Selection Rubberband mask div object */
atala_tool_selection_mask:"atala_tool_selection_mask",/** Selection Rubberband tooltip div object */
atala_tool_selection_tooltip:"atala_tool_selection_tooltip"},_o={/** Index of the page. applies to elements having .atala_page_div class */
atala_page_index:"atala_page_index"},xo={/** Triggers before a request is sent to the server. Populated keys: e.request */
beforehandlerrequest:null,/** Triggers when the document info has changed, usually after a new document is opened. Populated keys: none */
documentinfochanged:null,/** Triggers when the document is done loading. Populated keys: none */
documentloaded:null,/** Triggers after a response from the server while saveing the document. Populated keys: e.success */
documentsaved:null,/** Triggers when the document has been unloaded from the control. Populated keys: none */
documentunloaded:null,/** Triggers when the control has encountered and error. Populated keys: e.name, e.message */
error:null,/** Triggers when the control has initialized. Populated keys: none */
initialized:null,/** Triggers when the page number has changed. Populated keys: e.number */
pagenumberchanged:null,/** Triggers when the control has recycled a pageDiv object. Populated keys: e.page */
pagerecycled:null,/** Triggers when the control has resized a pageDiv object. Populated keys: e.page, e.image, e.index */
pageresize:null,/** Triggers when the control has shown a page in the viewable area. Populated keys: e.page, e.index */
pageshown:null,/** Triggers when the page size returned from the server is different than expected. Populated keys: e.index, e.height, e.width */
pagesizechanged:null,/** Triggers for every pixel movement registered by the scrollable area. Populated keys: e.x, e.y, e.dx, e.dy */
scroll:null,/** Triggers when depencies have finished loading. Populated keys: none */
scriptsloaded:null,/** Triggers when the control has updated the status bar. Populated keys: e.message */
statusmessage:null,/** Triggers when a zoom operation has been started. Populated keys: none */
zoomstarted:null,/** Triggers when the zoom level of the control has changed. Populated keys: e.zoom */
zoomchanged:null},bo={/** Turns annotation support on or off. */
allowannotations:!1,/** Turns flick scrolling support on or off. */
allowflick:!0,/** Turns forms support on or off. */
allowforms:!1,/** Annotations specific config options */
annotations:{/** Pre defined annotations to be drawn with the mouse. */
defaults:null,/** Pre defined stamp annotations to be drawn with the mouse. */
stamps:null,/** Pre defined image annotations to be drawn with the mouse. */
images:null,/** Indicates whether the server handler will save the username property when saving all annotations. */
saveusername:!1},/** Number of columns to show when displaying tabular pages, -1 is automatic. */
columns:-1,/** Parameter to change the scroll directopm of the viewer. */
direction:go.Vertical,/** To specify a document (that is on the server) to be displayed when the document is first opened. */
documenturl:"",/** To specify annotation data (an .xmp file on the server) that should be displayed along with the displayed document. */
annotationsurl:"",/** To specify PDF form data (.pdf file on the server) that should be displayed along with the displayed document. */
formurl:"",/** Specifies the initial page fit when displayed in the viewer. */
fitting:po.Width,/** Specifies whether all pages should be resized to fit into the bounds of the first page. */
forcepagefit:!1,/** Allows a custom page size to be used for force fitting all pages to. Ignored if forcepagefit is false. */
forcepagesize:{height:-1,width:-1},/** Allows image requests to be returned as jpeg instead of png. */
jpeg:!1,/** Specifies the maximum amount of pixel width allowed for zooming in. */
maxwidth:3e3,/** Maximum number of bytes in memory before larger memory objects are recycled. */
memorythreshold:5e8,/** Specifies the minimum amount of pixel width allowed for zooming out. */
minwidth:150,/** Specifies the pixel border width around each page in a document. */
pageborderwidth:1,/** The number of pages to keep in memory while scrolling. Negative values will automatically calculate the optimal number based on available screen space. Values lower than can be displayed will be ignored, and higher values will cause a degradation in performance. */
pagebuffersize:-1,/** Specifies the distance (in pixels) between pages displayed. */
pagespacing:4,/** Specifies the location to determine the current page number. */
pageselectlocation:eo.extend({},Atalasoft.Utils.PageSelection.TopLeft),/** [Required] Used to specify the jQuery object that the control will be created in. */
parent:null,/** Number of rows to show when displaying tabular pages, -1 is automatic. */
rows:-1,/** Specifies the path that the document, annotation data, and form data will be saved to on the server. */
savepath:"",/** Url location to the server where all JavaScript files are put when not in the default location. */
scripturl:"",/** [Required] Url location to the server handler. */
serverurl:"",/** If the toolbar is displayed, this can be used to hide or show the button text for the toolbar items. */
showbuttontext:!0,/** Specifies whether a black border will be added around each page in the displayed document. */
showpageborder:!0,/** Specifies whether a page number will be added to the bottom left of each page. */
showpagenumber:!0,/** Specifies whether error messages are allowed to show up in the console instead of being caught. */
showerrors:!1,/** Specifies whether status messages will be output to an area in the toolbar. */
showstatus:!1,/** Specifies whether scrollbars will be shown. */
showscrollbars:!0,/** Specifies whether rubberband selection tools are shown in the toolbar. */
showselecttools:!1,/** Specifies whether pages should be displayed in a tabular fashion, rather than one row or column. */
tabular:!1,/** [Experimental] Used to set the base DOM element size underneath each page. */
tilesize:-1,/** Specifies the jQuery object where the toolbar will be created. */
toolbarparent:null,/** Sets the initial zoom level of the dosument. Ignored when fitting is anything besides Fitting.None. */
zoom:1,/** Specifies whether to persist page rotation during document save. */
persistrotation:!0};e&&eo.extend(!0,bo,e),ce(),i(),/** WARNING: Changing values from these references can cause instability.*/
no.config=bo,/** WARNING: Changing values from these references can cause instability.*/
no.events=xo,/** WARNING: Changing values from these references can cause instability.*/
no.domclasses=yo,/** WARNING: Changing values from these references can cause instability.*/
no.domattributes=_o;var wo={height:0,isEmpty:function(){return 0===this.width&&0===this.height},width:0,zero:function(){this.width=0,this.height=0},zoom:1};/**
	* [Internal] Gets debug info object
	* @returns debug info object if available, otherwise null
	*/
return no.__getDebugInfo=Bn,/**
	* [Internal] Gets the viewer linkage for controls that inherit this one
	* @param viewer object of type WebDocumentViewer
	* @param linker internal object of type __LVlinker
	* @returns linker object if possible, otherwise undefined
	*/
no.__getViewerLink=In,no.dispose=l,no.empty=Hn,no.fit=rn,no.getZoom=Rn,no.isReady=Ln,no.scrollTo=jn,no.scrollBy=qn,no.next=Nn,no.previous=Wn,no.zoom=Qe,no.zoomIn=Zn,no.zoomOut=$n,no.openUrl=no.OpenUrl=Xn,no.save=Jn,no.getCurrentPageIndex=Yn,no.bind=Gn,no.unbind=Qn,no.trigger=Kn,no.getDocumentInfo=to,no.showPage=De,no.showPageNumber=Te,Atalasoft.Annotations.AnnotationController(),Atalasoft.Document.ManipulationController(),Atalasoft.Forms.FormController(),no.annotations=Atalasoft.Annotations.AnnotationController.__exposedApi,no.document=Atalasoft.Document.ManipulationController.__exposedApi,no.forms=Atalasoft.Forms.FormController.__exposedApi,o(),no}}(),Atalasoft.Document.ManipulationController=function(t,e){function n(){C.bind({pagerecycled:y,pageshown:v,documentinfochanged:a}),S._state.initialized?o():C.bind({initialized:o})}function o(){F=!0}function a(){O.info=C.getDocumentInfo(),O.mapping=null,O.changes.length=0}function i(){E=null,C=null,S=null,O.changes.length=0,O.mapping=null,O.info=null}function r(){"Atalasoft.Controls.WebDocumentViewer"===C.typeOf&&U.extend(C,V)}function l(){null==O.mapping&&s()}function s(){var t=C.getDocumentInfo(),e=Math.max(t.count,0);O.mapping=new Array(e);for(var n=0;e>n;++n){var o=t.pagesizes?t.pagesizes[n]:null;O.mapping[n]={index:n,fitmultiplier:{},pageref:null,angle:0,size:o}}}function u(t){return l(),t>=0&&t<O.mapping.length?null!=O.mapping[t].pageref?O.mapping[t].pageref:O.mapping[t].index:null}function c(t,e){return l(),t>=0&&t<O.mapping.length&&e in O.mapping[t].fitmultiplier?O.mapping[t].fitmultiplier[e]:1}function d(t,e,n){l(),t>=0&&t<O.mapping.length&&(O.mapping[t].fitmultiplier[n]=e)}/**
     * Gets the rotation angle of the specified page.
     * @param index: number, zero based index of the page to retreive rotation
     * @returns page rotation angle.
     */
function f(t){return l(),t>=0&&t<O.mapping.length?O.mapping[t].angle:0}function p(t,e){l(),t>=0&&t<O.mapping.length&&(O.mapping[t].angle=e)}function g(t,e,n){null==n||n>O.mapping.length?n=O.mapping.length:0>n&&(n=0);var o=e;t&&(o.pageref={url:t,index:e.index,mapsto:O.info.count+O.inserted},O.changes.push({type:"insertpage",url:t,src:o.index,dest:n})),O.count++,O.inserted++,O.mapping.splice(n,0,o)}function h(t){return t<O.mapping.length?(O.count--,O.mapping.splice(t,1)[0]):-1}function m(t,e){g(null,h(t),e),O.changes.push({type:"movepage",src:t,dest:e})}function v(){}function y(){}/**
	* Inserts a page at the destination index from the given source url and index.
	* @param sourceUrl: string, source url of the document
	* @param sourceIndex: number, zero based source index to get the page from
	* @param index: number, zero based destination index to insert the page
	* @param callback: function to execute when the operation has completed
	*/
function _(t,e,n,o){g(t,e,n),"function"==typeof o&&o(),C.trigger({type:B.inserted,srcurl:t,srcindex:e,index:n}),C.trigger(B.changed)}/**
	* Removes the page at the given index.
	* @param index: number, zero based index of the page to remove
	* @param callback: function to execute when the operation has completed
	*/
function x(t,e){h(t),"function"==typeof e&&e(),C.trigger({type:B.removed,index:t}),C.trigger(B.changed)}/**
	* Moves a page from the source index to the destination index.
	* @param sourceIndex: number, zero based source index to get the page from
	* @param destIndex: number, zero based destination index to insert the page
	* @param callback: function to execute when the operation has completed
	*/
function b(t,e,n){m(t,e),"function"==typeof n&&n(),C.trigger({type:B.moved,srcindex:t,destindex:e}),C.trigger(B.changed)}/**
     * Rotates the specified angle page.
     * @param index: number, zero based index of the page to rotate
     * @param angle: number, clockwise rotation angle in degrees
     * @param callback: function to execute when the operation has completed
     */
function w(t,e,n){var o=0;if(l(),t>=0&&t<O.mapping.length){e=(e-e%90)%360,p(t,e);var a=null,i=!1;for(o=0;o<S._pages.length;++o){var r=S._pages[o];r._index===t&&(a=r),i=i||!!r&&r._index===t&&!!r._img}for(n="function"==typeof n?n:null,i?(S.startDomManipulation(),n=n?Atalasoft.Utils.__functionFromArray([S.endDomManipulation,n]):S.endDomManipulation,S.adjustVisiblePages(!0,n)):"function"==typeof n&&n(),C.trigger({type:B.rotated,index:t,page:a,angle:e}),o=0;o<O.changes.length;o++)if("rotatepage"===O.changes[o].type&&O.changes[o].index===O.mapping[t].index){0!==e?O.changes[o].angle=e:O.changes.splice(o,1);break}0!==e&&o===O.changes.length&&O.changes.push({type:"rotatepage",index:O.mapping[t].index,angle:O.mapping[t].angle})}}function z(){var t={};return U.extend(!0,t,{data:O,changes:O.changes}),t}function A(t){t&&(null===t._changes?t._changes=O:O=t._changes)}function k(t){"function"==typeof t&&t(),C.trigger(B.changed)}function P(){return O.info.count+O.count}function D(t){return l(),t>=0&&t<O.mapping.length?O.mapping[t].size:void 0}function T(t,e){l(),t>=0&&t<O.mapping.length&&(O.mapping[t].size=e)}function M(){var t=[];for(var e in O.changes)if(O.changes.hasOwnProperty(e)&&(C.config.persistrotation||"rotatepage"!==O.changes[e].type)){var n={};for(var o in O.changes[e])O.changes[e].hasOwnProperty(o)&&(n[o]=O.changes[e][o]);t.push(n)}return JSON.stringify({changes:t})}var U=Atalasoft.$,E=this,C=t,S=e,V={document:{events:{/** Triggers when a page is added to the document. Populated keys: e.srcurl, e.srcindex, e.index */
pageinserted:null,/** Triggers when a page is removed from the document. Populated keys: e.index */
pageremoved:null,/** Triggers when a page is moved within the same document. Populated keys: e.srcindex, e.destindex */
pagemoved:null,/** Triggers when the document is changed. Populated keys: none */
documentchanged:null,/** Triggers when a page is rotated. 
                * Populated keys: 
                * e.index : index of the rotated page, 
                * e.angle : clockwise rotation angle
                */
pagerotated:null},insertPage:_,removePage:x,movePage:b,rotatePage:w,getPageRotation:f}};if(Atalasoft.Document.ManipulationController.__exposedApi=V.document,!t)return null;var F=!1,O={changes:[],mapping:null,count:0,inserted:0,info:{count:0,dpi:96,size:{width:0,height:0},vector:!1}},B={inserted:"pageinserted",removed:"pageremoved",moved:"pagemoved",changed:"documentchanged",rotated:"pagerotated"};E.dispose=i,E.getPageReference=u,E.insertPage=g,E.removePage=h,E.movePage=m,E.rotatePage=w,E.getPageFitMultiplier=c,E.setPageFitMultiplier=d,E.getPageRotation=f,E.getPageSize=D,E.setPageSize=T,E.__getDebugInfo=z,E.__linkChanges=A,E.clear=k,E.getPageCount=P,E.stringifyChanges=M,r(),n()},Atalasoft.Document.MemoryTracker=function(t){function e(){g()}function n(){return x.bytesInUse}function o(t){b.colorDepth=t}function a(){return b.colorDepth}function i(t){b.highWaterMark=t}function r(){return b.highWaterMark}function l(t,e){b.pageSize.width=t,b.pageSize.height=e}function s(){return b.pageSize}function u(){return y.bind.apply(y,arguments),v}function c(){return y.unbind.apply(y,arguments),v}function d(){return y.trigger.apply(y,arguments),v}function f(t){return _.memoryEntries.push(t),x.bytesInUse+=h(t),x.bytesInUse>b.highWaterMark&&d("exceededhighwatermark"),x.bytesInUse}function p(){var t=_.memoryEntries.shift();return m(t),t}function g(){_.memoryEntries.length=0,x.bytesInUse=0}function h(t){var e=t.width()||b.pageSize.width,n=t.height()||b.pageSize.height,o=e*n*b.colorDepth/8*b.compression;return o}function m(t){return x.bytesInUse-=h(t),x.bytesInUse<0&&(x.bytesInUse=0),x.bytesInUse}var v={typeOf:"Atalasoft.Document.MemoryTracker"},y=$({}),_={memoryEntries:[]},x={bytesInUse:0},b={colorDepth:8,compression:1,highWaterMark:5e8,pageSize:{width:800,height:1132}};return t&&$.extend(b,t),v.dispose=e,v.getBytesInUse=n,v.setColorDepth=o,v.getColorDepth=a,v.setHighWatermark=i,v.getHighWatermark=r,v.setPageSize=l,v.getPageSize=s,v.bind=u,v.unbind=c,v.trigger=d,v.allocate=f,v.deallocateOldestEntry=p,v.clearEntries=g,v},Atalasoft.Controls.ToolController=function(t,e,n,o,a){function i(){S=new Atalasoft.Controls.PointerTool,M.bind(S.events.viewport),S.events.wdv&&D.bind(S.events.wdv),S.bind({clickzoom:h,fit:g,panstart:m,panmove:v,panend:y,zoomstart:w,zoommove:z,zoomend:A,selectstart:_,selectmove:x,selectend:b,zoomareastart:_,zoomareamove:x,zoomareaend:b})}function r(){S&&S.events&&(S.events.wdv&&D&&D.unbind&&D.unbind(S.events.wdv),S.events.viewport&&M&&M.unbind&&M.unbind(S.events.viewport)),I&&I.length>0&&(I.length=0),S&&S.dispose&&S.dispose(),C=null,E=null,U=null,M=null,D=null,P=null}function l(t,e){switch(S.setTool(t,e),t){case E.None:f(C.Arrow);break;case E.Pan:f(C.Move);break;case E.ZoomIn:f(C.ZoomIn);break;case E.ZoomOut:f(C.ZoomOut);break;case E.Selection:T.raiseDrawLayer(),L=1,f(C.Crosshair);break;case E.ZoomArea:T.raiseDrawLayer(),L=1,f(C.Crosshair);break;default:f(C.Arrow)}}function s(){var t={};return k.extend(!0,t,{cursor:O,custom:B,flick:I,resourcepath:F,flickdelay:H,scroller:U,tool:S,toolcusors:C,tooltypes:E,viewport:M,zoom:V}),t}function u(){return S.getTool()}function c(){return S.pauseTool()}function d(){return S.resumeTool()}function f(t){var e=""===F?"?atalacsr=":F;O="%2"===t?O=B:t.replace("%1",e),M.css({cursor:O})}function p(t){B=t}function g(t){D.fit(t.fit)}function h(t){t.zoomout?D.zoomOut():D.zoomIn()}function m(t){U.data("ox",U.scrollLeft()+t.x).data("oy",U.scrollTop()+t.y),U.stop()}function v(t){U.scrollLeft(U.data("ox")-t.x),U.scrollTop(U.data("oy")-t.y),j.allowflick&&(I.push({x:t.x,y:t.y,time:(new Date).getTime()}),I.length>10&&I.shift())}function y(){if(j.allowflick){if(I.length>1){var t=(new Date).getTime(),e=I.pop();if(t-e.time<100){var n=I.shift(),o=-n.time+e.time;U.animate({scrollLeft:U.scrollLeft()+Math.round((n.x-e.x)/o*250),scrollTop:U.scrollTop()+Math.round((n.y-e.y)/o*250)},H,"easeOutQuad")}}I.length=0}}function _(t){R=T.getActivePage(),R&&R._rubberband.startSelect(t)}function x(t){R=T.getActivePage(),R&&R._rubberband.moveSelect(t)}function b(t){R=T.getActivePage(),R&&(R._rubberband.endSelect(t),"zoomareaend"===t.type&&(R._rubberband.hide(),R._rubberband.zoomToSelection())),L--,0===L&&(L=-1,T.resetDrawLayer(),l(E.Pan,E.None))}function w(){T.zoomStart(),V=D.getZoom()}function z(t){var e=V*t.scale;T.zoom(e)}function A(){T.zoomEnd()}if(!n||!o)return Atalasoft.Event.Throw("Atalasoft.Controls.ToolController",0,null,"ToolController requires a WDV and two jQuery objects passed in as input, one for mouse events, the other for scrolling."),!1;var k=Atalasoft.$,P=this,D=t,T=e,M=n,U=o,E=Atalasoft.Utils.MouseToolType,C=Atalasoft.Utils.MouseToolCursor,S=null,V=1,F="",O=null,B="",I=[],H=1e3,R=null,L=-1,j={allowflick:!0};a&&k.extend(j,a),i(),P.dispose=r,P.setTool=l,P.__getDebugInfo=s,P.getTool=u,P.pauseTool=c,P.resumeTool=d,P.setCursor=f,P.setCustomCursor=p},Atalasoft.Controls.PointerTool=function(){function t(){U(),K.events={viewport:{click:P,dblclick:D,mousedown:M,mousemove:E,mouseout:C,mouseover:S,mouseup:V,contextmenu:T,mousewheel:F}},Atalasoft.Utils.Browser.Features.Touch&&Q.extend(!0,K.events,{viewport:{touchstart:N,touchmove:W,touchend:Z},wdv:{annotationdrawstart:u,annotationdrawend:c,annotationdragstart:u,annotationdragend:c}})}function e(){ee&&(ee=null),ne&&(ne=null),K=null}function n(){return te.bind.apply(te,arguments),K}function o(){return te.unbind.apply(te,arguments),K}function a(){return te.trigger.apply(te,arguments),K}function i(t,e){switch(ae=t,ie=e,U(),ae){case oe.None:O=Atalasoft.Utils.__rf;break;case oe.Pan:H=h;break;case oe.ZoomIn:O=L;break;case oe.ZoomOut:O=j;break;case oe.Selection:H=y;break;case oe.ZoomArea:H=y;break;case oe.PassThrough:}switch(ie){case oe.None:break;case oe.Pan:R=h;break;case oe.ZoomIn:B=L;break;case oe.ZoomOut:B=j;break;case oe.Selection:R=y;break;case oe.ZoomArea:R=y;break;case oe.PassThrough:}}function r(){return{primary:ae,secondary:ie}}function l(){ee.prpt++}function s(){ee.prpt>0&&ee.prpt--}function u(){ee&&(ee.drawing=!0)}function c(){ee&&(ee.drawing=!1)}function d(t){if(!ee.prpt){t.stopPropagation(),ee.pinching=!0;var e=t.originalEvent.touches[0],n=t.originalEvent.touches[1];ne={start:Atalasoft.Utils.CalcDistance(e.clientX,e.clientY,n.clientX,n.clientY)},a({type:"zoomstart",touches:t.originalEvent.touches})}}function f(t){if(!ee.prpt&&(t.stopPropagation(),!ee.zooming)){ee.zooming=!0;var e=t.originalEvent.touches[0],n=t.originalEvent.touches[1],o=Atalasoft.Utils.CalcDistance(e.clientX,e.clientY,n.clientX,n.clientY,ne.start),i=o.x/ne.start.x,r=o.y/ne.start.y;setTimeout(p,40),a({type:"zoommove",touches:t.originalEvent.touches,scale:i,scalex:i,scaley:r,dx:o.dx,dy:o.dy})}}function p(){ee.zooming=!1}function g(t){ee.prpt||(t.stopPropagation(),ee.pinching=!1,a({type:"zoomend",touches:t.originalEvent.touches}),1===t.originalEvent.touches.length&&N(t))}function h(t){return ee.prmt?void 0:(a({type:"panstart",x:t.clientX,y:t.clientY}),Q(document).bind({mousemove:m,mouseup:v,ondrag:Atalasoft.Utils.__rf}),!1)}function m(t){return t=null==t?event:t,ee.prpt?void 0:0===t.which?(v(),void 0):(a({type:"panmove",x:t.clientX,y:t.clientY}),!1)}function v(){return ee.prpt?void 0:(Q(document).unbind({mousemove:m,mouseup:v,ondrag:Atalasoft.Utils.__rf}),a({type:"panend"}),!1)}function y(t){return ee.prmt?void 0:(a({type:ae===oe.Selection?"selectstart":"zoomareastart",x:t.clientX,y:t.clientY,toolEvent:t}),re=Q(t.target),re._binds={mousemove:_,mouseup:x,ondrag:Atalasoft.Utils.__rf},re.bind(re._binds),!1)}function _(t){return t=null==t?event:t,ee.prpt?void 0:0===t.which?(x(),void 0):(a({type:ae===oe.Selection?"selectmove":"zoomareamove",x:t.clientX,y:t.clientY,toolEvent:t}),!1)}function x(t){return ee.prpt?void 0:(re.unbind(re._binds),re=null,a({type:ae===oe.Selection?"selectend":"zoomareaend",toolEvent:t}),!1)}function b(t){ae===oe.Pan&&(t.type="panstart",a(t))}function w(t){ae===oe.Pan&&(t.type="panmove",a(t))}function z(t){ae===oe.Pan&&(t.type="panend",a(t))}function A(t){t.type="contextmenu",a(t)}function k(t){t.type="fit",a(t)}function P(t){return t=null==t?event:t,O(t)}function D(t){t=null==t?event:t}function T(t){return t=null==t?event:t,B(t)}function M(t){return t=null==t?event:t,2===t.button?R(t):H(t),I(t)}function U(){O=ae===oe.PassThrough?Atalasoft.Utils.__ef:Atalasoft.Utils.__rf,B=ie===oe.PassThrough?Atalasoft.Utils.__ef:Atalasoft.Utils.__rf,I=Atalasoft.Utils.__ef,H=Atalasoft.Utils.__ef,R=Atalasoft.Utils.__ef}function E(){}function C(){}function S(){}function V(){}function F(){}function O(){}function B(){}function I(){}function H(){}function R(){}function L(t){return ee.prpt?void 0:(q(t,!1),!1)}function j(t){return ee.prpt?void 0:(q(t,!0),!1)}function q(t,e){return ee.prpt?void 0:(a({type:"clickzoom",x:t.clientX,y:t.clientY,zoomout:e}),!1)}function N(t){ee.prpt||ee.drawing||ee.pinching||Q(t.target).is(".ui-menu,.ui-menu-item,.ui-corner-all")||(t.preventDefault(),ee.e=t,2===t.originalEvent.touches.length&&G(t.originalEvent.touches)?(Y(),ee.touching=!1,d(t)):1===t.originalEvent.touches.length&&(ee.touching=!0,ee.point.x=t.originalEvent.touches[0].pageX,ee.point.y=t.originalEvent.touches[0].pageY,ee.hold=setTimeout(J,1500),b({x:ee.point.x,y:ee.point.y})))}function W(t){if(!ee.prpt&&!ee.drawing)if(t.preventDefault(),ee.e=t,ee.pinching)f(t);else if(ee.touching){var e=t.originalEvent.touches[0];ee.moves++,ee.touching=!0,w({x:e.pageX,y:e.pageY})}}function Z(t){ee.prpt||ee.drawing||(t.preventDefault(),ee.pinching?g(t):(ee.touching=!1,Y(),ee.moves>0?(ee.moves=0,z({})):ee.tapped?X(t):(ee.tapped=!0,setTimeout($,300))))}function $(){ee.tapped=!1}function X(t){k(t)}function J(){if(ee.moves>0&&null!=ee.e){var t=Atalasoft.Utils.getMousePositionJquery(ee.e);Math.abs(ee.point.x-t.x)<5&&Math.abs(ee.point.y-t.y)<5&&(ee.moves=0)}0===ee.moves&&ee.touching&&A({x:ee.point.x,y:ee.point.y})}function Y(){null!=ee.hold&&(clearTimeout(ee.hold),ee.hold=null)}function G(t){for(var e=null,n=0;n<t.length;n++){var o=t[n].target;if(o)if(null==e)e=o;else if(e!==o)return!1}return!0}var Q=Atalasoft.$,K=this,te=Q({}),ee={tapped:!1,touching:!1,pinching:!1,zooming:!1,origin:{x:0,y:0},point:{x:0,y:0},delta:{x:0,y:0},drawing:!1,moves:0,prpt:0},ne=null,oe=Atalasoft.Utils.MouseToolType,ae=oe.None,ie=oe.None,re=null;return t(),K.dispose=e,K.bind=n,K.unbind=o,K.trigger=a,K.setTool=i,K.getTool=r,K.pauseTool=l,K.resumeTool=s,K},Atalasoft.Controls.RubberBandTool=function(t,e,n,o){function a(){ue.rect=c(),ue.rectback=c(),ue.mask.top=d(),ue.mask.bottom=d(),ue.mask.left=d(),ue.mask.right=d(),oe=u("div"),oe.addClass(le.domclasses.atala_tool_selection_tooltip),oe.hide(),oe.css({fontFamily:"Arial, helvetica, san-serif",fontSize:"8pt",padding:"1px",backgroundColor:"#FFFFE1",border:"1px solid #000000",position:"absolute",zIndex:"1"}),fe.append(ue.rectback),fe.append(ue.rect),fe.append(oe),fe.append(ue.mask.top),fe.append(ue.mask.bottom),fe.append(ue.mask.left),fe.append(ue.mask.right),ne=new s,B(),se.visible?F():O(),fe.bind({pageresize:r,pagezoom:l})}function i(){null!=ne&&(ne.dispose(),ne=null),ie=null,ue.rect=null,ue.rectback=null,oe=null,ue.mask.top=null,ue.mask.bottom=null,ue.mask.left=null,ue.mask.right=null}function r(){te(),H()}function l(){te(),H()}function s(){function t(){for(var t=0;9>t;t++)c[t].dispose(),c[t]=null;u=null,c=null,d=null,f=null}function e(t,e,n,o){p=n,m=o,c[0].setPos(t,e),c[1].setPos(t-4,e-4),c[3].setPos(t+n-4,e-4),c[6].setPos(t-4,e+o-4),c[8].setPos(t+n-4,e+o-4),c[0].setSize(n,o),se.showgrips?(c[2].setPos(t+Math.round(n/2)-4,e-4),c[4].setPos(t-4,e+Math.round(o/2)-4),c[5].setPos(t+n-4,e+Math.round(o/2)-4),c[7].setPos(t+Math.round(n/2)-4,e+o-4)):(c[2].setPos(t+4,e-4),c[4].setPos(t-4,e+4),c[5].setPos(t+n-4,e+4),c[7].setPos(t+4,e+o-4),c[2].setSize(n-8,8),c[4].setSize(8,o-8),c[5].setSize(8,o-8),c[7].setSize(n-8,8)),r()}function n(){for(var t=0;9>t;t++)c[t].resetColors()}function o(){for(var t=0;9>t;t++)c[t].resetGripSize(),c[t].resetColors()}function a(){for(var t=0;9>t;t++)c[t].hide()}function i(){for(var t=0;9>t;t++)f[t]===!0?c[t].show():c[t].hide()}function r(){for(var t=0;9>t;t++)f[t]=!0;f[0]=!0,8>p&&8>m&&(f[1]=!1),(12>p||12>m)&&(f[3]=!1,f[6]=!1),(16>p||8>m)&&(f[2]=!1,f[7]=!1),(16>m||8>p)&&(f[4]=!1,f[5]=!1),i()}function l(){v()===!0?(c[0].grip.onmousedown=Z,c[0].grip.style.cursor="move"):(c[0].grip.onmousedown=Atalasoft.Utils.__rf,c[0].grip.style.cursor="default");for(var t=1;9>t;t++)b()===!0?(c[t].bind({mousedown:c[t].onResize}),c[t].grip.style.cursor=u[t]+"-resize"):(c[t].unbind({mousedown:c[t].onResize}),c[t].grip.style.cursor="default")}function s(t){function e(){v=null,f=null,p=null,_=null}function n(){return m.bind.apply(m,arguments),m}function o(){return m.unbind.apply(m,arguments),m}function a(t,e){p.left=t+"px",p.top=e+"px"}function i(t,e){w()===!0&&"move"!==_&&(t-=2,e-=2),0>=t&&(t=1),0>=e&&(e=1),p.width=t+"px",p.height=e+"px"}function r(){x&&(p.visibility="hidden",x=!1)}function l(){x||(p.visibility="visible",x=!0)}function s(){"move"!==_&&(se.showgrips===!0?y()===!0?(p.backgroundColor="#"+g(),p.border="1px solid #"+h()):(p.backgroundColor="#"+h(),p.border="1px solid #"+h()):(p.backgroundColor="",p.border=""))}function c(){se.showgrips===!0?(p.width="6px",p.height="6px"):(p.width="8px",p.height="8px")}function d(t){return W(t,_)}var f,p,m,v=this,_=u[t],x=!1;f=document.createElement("div"),p=f.style,m=ae(f),m.addClass(le.domclasses.atala_tool_selection_grip),s(),c(),v.grip=f,v.dispose=e,v.setPos=a,v.setSize=i,v.hide=r,v.show=l,v.resetColors=s,v.resetGripSize=c,v.onResize=d,v.bind=n,v.unbind=o,p.display="block",p.position="absolute",p.visibility="hidden",p.zIndex="2",f.onclick=Atalasoft.Utils.__rf,f.onselectstart=Atalasoft.Utils.__rf,f.onselect=Atalasoft.Utils.__rf,f.oncontextmenu=Atalasoft.Utils.__rf}for(var u=new Array("move","nw","n","ne","w","e","sw","s","se"),c=[],d=!1,f=[],p=0,m=0,_=0;9>_;_++)c[_]=new s(_),fe.append(c[_].grip);this.dispose=t,this.setRectangle=e,this.resetColors=n,this.resetGrips=o,this.hide=a,this.show=i,this.showGrips=r,this.resetEvents=l,l()}function u(t,e,n,o){var a=ae("<"+t+"></"+t+">");return e&&e.append&&a.appendTo(e),n&&a.attr("id",n),o&&a.html(o),a}function c(){var t=u("div");return t.addClass(le.domclasses.atala_tool_selection_band),t.css({position:"absolute",zIndex:"1"}),t}function d(){var t=u("div");return t.addClass(le.domclasses.atala_tool_selection_mask),t.hide(),t.css({left:"0px",top:"0px",width:"1px",height:"1px",position:"absolute",background:"#000",opacity:"0.6",zIndex:"0"}),t}function f(){return se.animated}function p(){return se.aspectratio}function g(){return se.backcolor}function h(){return se.forecolor}function m(){return se.height}function v(){return se.movable}function y(){return se.multicolor}function _(){return{x:se.x,y:se.y}}function x(){return{x:se.x,y:se.y,width:se.width,height:se.height}}function b(){return se.resizable}function w(){return se.showgrips}function z(){return se.showmask}function A(){return se.showtooltip}function k(){return{width:se.width,height:se.height}}function P(){return se.visible}function D(){return se.width}function T(){return re.bind.apply(re,arguments),ie}function M(){return re.unbind.apply(re,arguments),ie}function U(){return re.trigger.apply(re,arguments),ie}function E(){O(),se.x=0,se.y=0,se.width=0,se.height=0}function C(){ue.mask.left.hide(),ue.mask.right.hide(),ue.mask.top.hide(),ue.mask.bottom.hide()}function S(t,e,n,o){return se.showmask?(e>0?(ue.mask.top.css({left:ce.pageoffset.x,top:ce.pageoffset.y,width:Q(),height:e}),ue.mask.top.show()):ue.mask.top.hide(),e+o<G()?(ue.mask.bottom.css({left:ce.pageoffset.x,top:ce.pageoffset.y+e+o,width:Q(),height:G()-(e+o)}),ue.mask.bottom.show()):ue.mask.bottom.hide(),t>0?(ue.mask.left.css({left:ce.pageoffset.x,top:ce.pageoffset.y+e,width:t,height:o}),ue.mask.left.show()):ue.mask.left.hide(),t+n<Q()?(ue.mask.right.css({left:ce.pageoffset.x+t+n,top:ce.pageoffset.y+e,width:Q()-(t+n),height:o}),ue.mask.right.show()):ue.mask.right.hide(),void 0):(C(),void 0)}function V(){oe.css({left:(se.x+se.width)*ce.zoom+8+"px",top:(se.y+se.height)*ce.zoom+4+"px"}),oe.text(Math.round(se.width/ce.zoom)+"x"+Math.round(se.height/ce.zoom)),oe.is(":hidden")&&oe.show()}function F(){se.visible=!0,ue.rectback.show(),ue.rect.show(),f()===!0&&y()===!0&&J()}function O(){se.visible=!1,C(),ne.hide(),ue.rectback.hide(),ue.rect.hide()}function B(){var t=se.multicolor?"dashed":"solid",e="1px solid #"+se.backcolor,n="1px "+t+" #"+se.forecolor;ue.rectback.css("border",e),ue.rect.css("border",n),ne.resetColors()}function I(){H()}function H(){var t=se.x,e=se.y,n=ce.pagesize.width,o=ce.pagesize.height;(t>=n||t+se.width>n)&&(t=n-se.width,0>t&&(t=0)),(e>=o||e+se.height>o)&&(e=o-se.height,0>e&&(e=0)),t!==se.x&&(se.x=t),e!==se.y&&(se.y=e);var a=Math.round(se.x*ce.zoom),i=Math.round(se.y*ce.zoom),r=Math.round(se.width*ce.zoom),l=Math.round(se.height*ce.zoom);R(a,i),L(r,l),ne.setRectangle(a,i,r,l),se.visible?(F(),S(a,i,r,l)):O()}function R(t,e){ue.rectback.css({left:t+"px",top:e+"px"}),ue.rect.css({left:t+"px",top:e+"px"})}function L(t,e){0===t&&(t=1),ue.rectback.css({width:t+"px",height:e+"px"}),ue.rect.css({width:t+"px",height:e+"px"})}function j(t){t.stopPropagation(),t.preventDefault(),te();var e=Y(t);return F(),ce.origin.x=e.x,ce.origin.y=e.y,se.x=Math.round(e.x/ce.zoom),se.y=Math.round(e.y/ce.zoom),se.width=1,se.height=1,ce.changing=!0,ce.vert=0,ce.horiz=0,H(),se.showtooltip===!0&&V(),!1}function q(t,e){t.stopPropagation(),t.preventDefault();var n=e?e:Y(t),o=Math.round(ce.origin.x/ce.zoom),a=Math.round(ce.origin.y/ce.zoom),i=Math.abs((n.x-ce.origin.x)/ce.zoom),r=Math.abs((n.y-ce.origin.y)/ce.zoom);if(se.aspectratio>0){var l=Math.abs((n.y-ce.origin.y)/(n.x-ce.origin.x));l>1/se.aspectratio&&0===ce.horiz||1===ce.vert?i=Math.round(r*se.aspectratio):r=Math.round(i/se.aspectratio)}return n.x<ce.origin.x?(o-=i,o-ce.pageoffset.x<0&&(i=ce.origin.x-ce.pageoffset.x,se.aspectratio>0&&(r=Math.round(i/se.aspectratio)),o=ce.origin.x-i)):o+i>ce.pagesize.width+ce.pageoffset.x&&(i=ce.pagesize.width-o+ce.pageoffset.x,se.aspectratio>0&&(r=Math.round(i/se.aspectratio))),n.y<ce.origin.y?(a-=r,a-ce.pageoffset.y<0&&(r=ce.origin.y-ce.pageoffset.y,se.aspectratio>0&&(i=Math.round(r*se.aspectratio)),a=ce.origin.y-r,n.x<ce.origin.x&&(o=ce.origin.x-i))):a+r>ce.pagesize.height+ce.pageoffset.y&&(r=ce.pagesize.height-a+ce.pageoffset.y,se.aspectratio>0&&(i=Math.round(r*se.aspectratio)),n.x<ce.origin.x&&(o=ce.origin.x-i)),(0===ce.vert||se.aspectratio>0)&&(se.x=o-ce.pageoffset.x,se.width=i),(0===ce.horiz||se.aspectratio>0)&&(se.y=a-ce.pageoffset.y,se.height=r),H(),se.showtooltip===!0&&V(),!1}function N(t){return q(t,Atalasoft.Utils.getMousePositionJquery(t,null,!0))}function W(t,e){t=t||event,K(t),ce.vert=0,ce.horiz=0,ce.changing=!0;var n={x:0,y:0};switch(e){case"nw":n.x=se.x+se.width,n.y=se.y+se.height;break;case"n":n.x=se.x,n.y=se.y+se.height,ce.vert=1;break;case"ne":n.x=se.x,n.y=se.y+se.height;break;case"w":n.x=se.x+se.width,n.y=se.y+se.height,ce.horiz=1;break;case"e":n.x=se.x,n.y=se.y+se.height,ce.horiz=1;break;case"sw":n.x=se.x+se.width,n.y=se.y;break;case"s":n.x=se.x,n.y=se.y,ce.vert=1;break;case"se":n.x=se.x,n.y=se.y}ce.origin.x=Math.round(n.x*ce.zoom)+ce.pageoffset.x,ce.origin.y=Math.round(n.y*ce.zoom)+ce.pageoffset.y,de.raiseDrawLayer();var o={mousemove:N,mouseup:X};return null!==ce.boundevents?ae.extend(ce.boundevents,o):ce.boundevents=o,fe.bind(o),!1}function Z(t){t=t||event,K(t);var e=Atalasoft.Utils.getMousePosition(t,null,fe[0]);ce.origin.x=e.x-Math.round(se.x*ce.zoom),ce.origin.y=e.y-Math.round(se.y*ce.zoom),ce.changing=!0;var n={mousemove:$,mouseup:X,ondrag:Atalasoft.Utils.__rf};return null!==ce.boundevents?ae.extend(ce.boundevents,n):ce.boundevents=n,fe.bind(n),!1}function $(t){t=t||event,K(t);var e=Atalasoft.Utils.getMousePosition(t,null,fe[0]),n={x:0,y:0};return n.x=Math.round((e.x-ce.origin.x)/ce.zoom),n.y=Math.round((e.y-ce.origin.y)/ce.zoom),n.x>ce.pagesize.width-se.width&&(n.x=ce.pagesize.width-se.width),n.x<0&&(n.x=0),n.y>ce.pagesize.height-se.height&&(n.y=ce.pagesize.height-se.height),n.y<0&&(n.y=0),se.x=n.x,se.y=n.y,H(),!1}function X(t){return t=t||event,K(t),ce.changing=!1,se.showtooltip===!0&&oe.hide(),ce.changing&&(ce.changing=!1,U("changed")),null!==ce.boundevents&&(fe.unbind(ce.boundevents),ce.boundevents=null,de.resetDrawLayer()),!1}function J(){se.animated===!0&&0===ce.colorswap?(ue.rect.css("border","1px dashed #"+g()),ue.rectback.css("border","1px solid #"+h()),ce.colorswap=1):(ue.rect.css("border","1px dashed #"+h()),ue.rectback.css("border","1px solid #"+g()),ce.colorswap=0),se.animated!==!0||ue.rect.is(":hidden")||ce.animating||(ce.animating=setTimeout(function(){ce.animating=!1,J()},250))}function Y(t){var e=Atalasoft.Utils.getMousePositionJquery(t.toolEvent?t.toolEvent:t);if(fe._paper){var n=Atalasoft.Utils.getSVGOffset(fe._paper.canvas,fe);e.x-=n.left,e.y-=n.top}return e}function G(){return Math.round(ce.pagesize.height*ce.zoom)}function Q(){return Math.round(ce.pagesize.width*ce.zoom)}function K(t){"undefined"!=typeof t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function te(){var t=fe._img.getSize();ce.zoom=fe._img.getFitZoom(),ce.pagesize.width=t.width,ce.pagesize.height=t.height}function ee(){var t=de.getMaxZoom();if(le.getZoom()<t){var e,n=de.getViewportSize(),o=fe._img.getFitMultiplier(),a=1,i=0,r=0;e=n.width/se.width===n.height/se.height?Math.min(n.width/(se.width*o),n.height/(se.height*o),t):n.width/se.width<n.height/se.height?Math.min(n.width/(se.width*o),t):Math.min(n.height/(se.height*o),t),a=o*e,i=Math.round(se.x*a),r=Math.round(se.y*a),r-=Math.max(0,Math.round((n.height-se.height*a)/2)),i-=Math.max(0,Math.round((n.width-se.width*a)/2));var l=de.getPageOffsets(fe._index,null,null,e);le.zoom(e,function(){le.scrollTo(l.width+i,l.height+r)})}}var ne,oe,ae=Atalasoft.$,ie=this,re=ae({}),le=t,se={animated:!1,aspectratio:0,backcolor:"fff",forecolor:"000",movable:!0,multicolor:!0,resizable:!0,showgrips:!1,showmask:!1,showtooltip:!1,visible:!1,x:0,y:0,width:0,height:0},ue={/** Main RubberBand dom object */
rect:null,/** Dom object underneath Main RubberBand */
rectback:null,/** Mask objects */
mask:{top:null,bottom:null,left:null,right:null}},ce={animating:!1,boundevents:null,changing:!1,colorswap:0,origin:{x:0,y:0},pagesize:{width:0,height:0},pageoffset:{x:0,y:0},vert:!1,horiz:!1,zoom:1},de=o,fe=n;return ie.dispose=i,ie.getAnimated=f,ie.getAspectRatio=p,ie.getBackColor=g,ie.getForeColor=h,ie.getHeight=m,ie.getMovable=v,ie.getMultiColor=y,ie.getPosition=_,ie.getRectangle=x,ie.getResizable=b,ie.getShowGrips=w,ie.getShowMask=z,ie.getShowTooltip=A,ie.getSize=k,ie.getVisible=P,ie.getWidth=D,ie.bind=T,ie.hide=O,ie.reset=E,ie.show=F,ie.synchronize=I,ie.trigger=U,ie.unbind=M,ie.zoomToSelection=ee,ie.startSelect=j,ie.moveSelect=q,ie.endSelect=X,a(),ie},Atalasoft.Annotations.AnnotationController=function(t,e,n){function o(t){je.push(t)}function a(){Ce.setAnnos(Ne.annos),Ce.setPages(Oe)}function i(){if(a(),"undefined"==typeof Raphael)return d("DependencyError","Raphael did not load properly."),void 0;for("2.1.2"!==Raphael.version&&d("DependencyError","Raphael version must be equal to 2.1.2, other versions may cause instability."),Atalasoft.Utils._raphaelLoader&&Atalasoft.Utils._raphaelLoader===Ue&&delete Atalasoft.Utils._raphaelLoader,Ue.trigger("raphaelloaded"),s(),Ue.trigger("raphaelextended");je.length;)je.shift().call();qe=Raphael.matrix(1,0,0,1,0,0),Ue.bind({scroll:c,pagerecycled:A,pageshown:x,zoomchanged:f,pagerotated:P}),Re={Delete:V,Properties:F},Ee._state.initialized?r():Ue.bind({initialized:r})}function r(){Be=!0,Ne.readonly||(He=C(Re),Le=new T,null!=Fe.annotations.defaults&&Z(Fe.annotations.defaults),null!=Fe.annotations.stamps&&$(Fe.annotations.stamps),null!=Fe.annotations.images&&X(Fe.annotations.images),null!=Fe.annotations.custom&&J(Fe.annotations.custom))}/**
	* [Internal] Disposes memory intensive objects
	* @returns undefined
	*/
function l(){Me=null,Ue=null,Ee=null,Fe=null,Oe=null,Ie=null,He=null,Re=null,Le=null,je.length=0,Ne.annos.length=0,Ne.activepage=null,Ne.activeanno=null,Ne.zoom=null,Ce.dispose(),Ce=null}function s(){function t(t,e,o,a,i){function r(t){var e=l.matrix.split();if(t.hasOwnProperty("x")&&"undefined"!=typeof t.x&&t.hasOwnProperty("y")&&"undefined"!=typeof t.y){var n={x:t.x*e.scalex,y:t.y*e.scaley};if(0!==e.rotate){var o=Atalasoft.Utils.__calcPathBounds([{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],l.matrix);n=o}s.style.left=Math.round(n.x)+"px",s.style.top=Math.round(n.y)+"px"}}var l=n(this,this,null,"div",e,o,a,i),s=l.node;return s.innerHTML=t?t:"",l.innerDom=s,s.style.position="absolute",l.__tsfm=l.transform,l.transform=function(){this.__tsfm.apply(this,arguments),this.repaint(),r(this.attrs)},l.backgroundColor=function(t){s.style.backgroundColor=t,this.repaint()},l.repaint=function(){s.style.filter='progid:DXImageTransform.Microsoft.Chroma(color="'+s.style.backgroundColor+'"); '+this.matrix.toFilter()},l.__attr=l.attr,l.attr=function(t){this.__attr.apply(this,arguments),t&&(r(t),t.hasOwnProperty("width")&&(s.style.width=t.width+"px"),t.hasOwnProperty("height")&&(s.style.height=t.height+"px"))},l.isHtml=!0,l}function e(t,e,o,i,r){var l="http://www.w3.org/1999/xhtml",s="http://www.w3.org/2000/xmlns/",u="http://www.w3.org/2000/svg",c=a?"image":"foreignObject",d=n(this,this,u,c,e,o,i,r),f=null;return a||(f=document.createElementNS(l,"div"),f.setAttributeNS(s,"xmlns",s),f.innerHTML=t?t:"",d.node.appendChild(f),d.isHtml=!0),d.innerDom=f,d}function n(t,e,n,o,a,i,r,l,s){var u=null===n?document.createElement(o):document.createElementNS(n,o);e.canvas&&e.canvas.appendChild&&e.canvas.appendChild(u);var c=new t.constructor.el.constructor(u,t);c.attrs={x:a,y:i,width:r,height:l,r:s||0,rx:s||0,ry:s||0,fill:"none",stroke:"#000"},c.skew={},c.type=o,"g"===o&&(c.canvas=c.node);for(var d in c.attrs)c.attrs.hasOwnProperty(d)&&void 0!==c.attrs[d]&&u.setAttribute(d,c.attrs[d]+"");return c}function o(){var t={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},e={},n=function(t,e){if(e){"string"==typeof t&&(t=n(t));for(var o in e)e.hasOwnProperty(o)&&("xlink:"===o.substring(0,6)?t.setAttributeNS("http://www.w3.org/1999/xlink",o.substring(6),String(e[o])):t.setAttribute(o,String(e[o])))}else t=Raphael._g.doc.createElementNS("http://www.w3.org/2000/svg",t),t.style&&(t.style.webkitTapHighlightColor="rgba(0,0,0,0)");return t};Raphael.fn.addArrow=function(o,a,i){if("path"===o.type){for(var r,l,s,u,c,d=String(a).toLowerCase().split("-"),f=o.paper,p=i?"end":"start",g=o.node,h=o.attrs,m=h["stroke-width"],v=d.length,y="classic",_=3,x=3,b=5;v--;)switch(d[v]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":y=d[v];break;case"wide":x=5;break;case"narrow":x=2;break;case"long":_=5;break;case"short":_=2}if("open"===y?(_+=2,x+=2,b+=2,s=1,u=i?4:1,c={fill:"none",stroke:h.stroke}):(u=s=_/2,c={fill:h.stroke,stroke:"none"}),o._.WDVarrows?i?(o._.WDVarrows.endPath&&e[o._.WDVarrows.endPath]--,o._.WDVarrows.endMarker&&e[o._.WDVarrows.endMarker]--):(o._.WDVarrows.startPath&&e[o._.WDVarrows.startPath]--,o._.WDVarrows.startMarker&&e[o._.WDVarrows.startMarker]--):o._.WDVarrows={},"none"!==y){var w=Math.random().toString(36).substring(7),z="dave-marker-"+y,A="dave-marker-"+p+y+_+x+w;Raphael._g.doc.getElementById(z)?e[z]++:(f.defs.appendChild(n(n("path"),{"stroke-linecap":"round",d:t[y],id:z})),e[z]=1);var k,P=Raphael._g.doc.getElementById(A);P?(e[A]++,k=P.getElementsByTagName("use")[0]):(P=n(n("marker"),{id:A,markerHeight:x,markerWidth:_,orient:"auto",refX:u,refY:x/2}),k=n(n("use"),{"xlink:href":"#"+z,transform:(i?"rotate(180 "+_/2+" "+x/2+") ":"")+"scale("+_/b+","+x/b+")","stroke-width":(1/((_/b+x/b)/2)).toFixed(4)}),P.appendChild(k),f.defs.appendChild(P),e[A]=1),n(k,c);var D=s*("diamond"!==y&&"oval"!==y);i?(r=o._.WDVarrows.startdx*m||0,l=Raphael.getTotalLength(h.path)-D*m):(r=D*m,l=Raphael.getTotalLength(h.path)-(o._.WDVarrows.enddx*m||0)),l=0>l?0:l,c={},c["marker-"+p]="url(#"+A+")",(l||r)&&(c.d=Raphael.getSubpath(h.path,r,l)),n(g,c),o._.WDVarrows[p+"Path"]=z,o._.WDVarrows[p+"Marker"]=A,o._.WDVarrows[p+"dx"]=D,o._.WDVarrows[p+"Type"]=y,o._.WDVarrows[p+"String"]=a}else i?(r=o._.WDVarrows.startdx*m||0,l=Raphael.getTotalLength(h.path)-r):(r=0,l=Raphael.getTotalLength(h.path)-(o._.WDVarrows.enddx*m||0)),o._.WDVarrows[p+"Path"]&&n(g,{d:Raphael.getSubpath(h.path,r,l)}),delete o._.WDVarrows[p+"Path"],delete o._.WDVarrows[p+"Marker"],delete o._.WDVarrows[p+"dx"],delete o._.WDVarrows[p+"Type"],delete o._.WDVarrows[p+"String"];for(c in e)if(e.hasOwnProperty(c)&&!e[c]){var T=Raphael._g.doc.getElementById(c);T&&T.parentNode.removeChild(T)}}}}var a=Raphael.svg&&!Atalasoft.Utils.Browser.Features.foreignObject;Raphael.vml?Raphael.fn.html=t:(Raphael.fn.html=e,o())}function u(){"Atalasoft.Controls.WebDocumentViewer"===Ue.typeOf&&Te.extend(Ue,Ve)}function c(t){qe.translate(t.dx,t.dy)}function d(t,e){Ue.trigger({type:"throwerror",name:t,msg:e})}function f(t){Ne.zoom=t.zoom}function p(t){if(t instanceof jQuery){if("undefined"!=typeof Raphael){t._paper=Raphael(t[0]),t._paper.canvas.style.position="absolute",t._paper.canvas.style.zIndex="2",Fe.pageborderwidth>0&&(t._paper.canvas.style.left=Fe.pageborderwidth+"px",t._paper.canvas.style.top=Fe.pageborderwidth+"px"),t._paper._annos=t._paper.set(),t._paper._trash=t._paper.set(),t._paper._page=t,t._matrix=Raphael.matrix(1,0,0,1,0,0),t._matrix.translate(-t.offset().left,-t.offset().top),t._grips=new Atalasoft.Annotations.Grips(t,Ne);var e=function(){z(t),Ce.deselectPage(t),E()};t.bind("mousedown",e),Atalasoft.Utils.Browser.Features.Touch&&t.bind("touchstart",e),t.bind({pageresize:function(e){e.page=t,_(e)},pagezoom:function(e){e.page=t,k(e)}})}else o(function(){p(t)});return!0}return!1}function g(t){return t instanceof jQuery?("undefined"!=typeof Raphael&&(t._paper&&(t._paper._annos=null,t._paper._page=null,t._paper=null),t._matrix=null,t._grips=null),!0):!1}function h(t,e,n){if(null==t&&"number"==typeof e&&(e=m(e)),e=e||[],null==n?n=Ne.annos.length:0>n&&(n=0),n>Ne.annos.length){var o=Ne.annos.length;Ne.annos[n]=e;for(var a=o;a<Ne.annos.length;++a)Ne.annos[a]||(Ne.annos[a]=[])}else Ne.annos.splice(n,0,e)}function m(t){return t<Ne.annos.length?Ne.annos.splice(t,1)[0]:null}function v(t,e){h(null,m(t),e)}function y(t){t&&t.remove&&!t.grip&&t.paper&&t.paper._trash&&t.paper._trash.push(t)}function _(t){t.page._paper.setSize(t.width,t.height),t.page._paper.canvas.style.width=t.width,t.page._paper.canvas.style.height=t.height,D(t.page)}function x(t){b(t.index,t.page)}function b(t,e){if("undefined"!=typeof Raphael){if(t<Ne.annos.length&&(w(e),Ne.annos[t]&&Ne.annos[t].length))for(var n,a=0;a<Ne.annos[t].length;a++)n=Ne.annos[t][a],n._pageindex=t,n.repaint(e._paper),n.get("selected")&&Ce.select(n,t,!0)}else o(function(){b(t,e)})}function w(t){t._grips.clear(),t._paper._annos.remove(),t._paper._annos.clear(),t._paper.forEach(function(t){t&&t.remove&&!t.grip&&t.paper&&t.paper._trash&&t.paper._trash.push(t)}),t._paper._trash.remove(),t._paper._trash.clear()}function z(t){Ne.activepage=t}function A(t){t.page._paper&&(w(t.page),t.page.append(t.page._paper.canvas))}function k(t){isFinite(t.width)&&isFinite(t.height)&&t.width&&t.height&&(Ne.zoom=t.zoom,t.page._paper.setSize(t.width,t.height),t.page._paper.canvas.style.width=t.width,t.page._paper.canvas.style.height=t.height,t.page._paper.forEach(function(e){if(e&&e.transform&&!e.grip){"undefined"!=typeof e._linewidth&&e.attr("stroke-width",e._linewidth*Ne.zoom);var n=e.attr("clip-rect");if("object"==typeof n&&"number"==typeof n.length){if(Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)<9)for(var o=0;o<n.length;o++)n[o]=n[o]/t.prevzoom*t.zoom;e.attr("clip-rect",n)}}}),D(t.page))}function P(t){D(t.page)}function D(t){if(t&&t._index>=0&&Ne.annos[t._index]){for(var e=0;e<Ne.annos[t._index].length;e++)Ne.annos[t._index][e].repaint();t&&t._grips.repaint()}}function T(){function t(){p.appendTo(f),f.dialog({minWidth:320,dialogClass:"atala-ui",resizable:!1,autoOpen:!1,buttons:{Ok:n,Reset:i,Cancel:a}})}function e(t){g=t,p.empty(),h={};for(var e in m)if(m.hasOwnProperty(e)){var n={};n[e]=g.get(e),Te.extend(!0,h,n)}r(g.get(),"",m),f.dialog("open")}function n(){f.dialog("close")}function o(){return f.dialog("isOpen")}function a(){i(),n()}function i(){g.set(h,!0),g.updateView(),g.repaint(),p.empty(),r(g.get(),"",m)}function r(t,e,n){function o(e){if(this.value&&"boolean"!=typeof this.value)if("number"==typeof t[this.title]){var n=parseFloat(this.value);isNaN(n)||"rotation"!==this.title||n===t[this.title]?"opacity"===this.title&&n>=0&&1>=n||"opacity"!==this.title&&this.value>=0?t[this.title]=n:this.value=t[this.title]:(g.set({rotation:n}),g.repaint())}else t[this.title]=this.value;else e&&"boolean"==typeof this.value?t[this.title]=e.target.id.indexOf("true")>=0:this.value=t[this.title];g.updateView(),g.repaint()}for(var a in t)if("object"==typeof t[a]){var i="text"!==a?c(a):"";n[a]&&("text"!==a||"text"===a&&"text"===g.get("type"))&&r(t[a],(e?e+" ":e)+i,n[a])}else if("type"===a)f.dialog("option","title",c(t[a].replace("fillrect","rectangle"))+" Annotation Properties");else if(n[a]){var s=Te("<div/>"),d=l(a,t[a],o,n[a]);s.addClass("ui-helper-clearfix atala-ui-dialog-clearfix"),s.css({overflow:"hidden"}),d.appendTo(s),u(s,(e?e+" ":e)+c(a)+":"),s.appendTo(p)}}function l(t,e,n,o){var a=typeof e,i=null;if(Te.isArray(o))i=Te("<select/>").attr({title:t}),Te.each(o,function(t,e){var n=e,o=e,a=e.split(":");a.length>1&&(o=a[0],n=a[1]),i.append(Te("<option/>",{value:n,text:o}))}),i.change(n),i.val(e);else if("string"===a||"number"===a)i=Te("<input/>").attr({type:"text",title:t}),i.val(e),i.change(n),i.focus(function(){this.select(),this._focused=!0}),i.mouseup(function(t){this._focused&&(t.preventDefault(),this._focused=!1)});else if("boolean"===a){var r="bool"+t;i=Te("<div/>").attr({title:t}),s(i,r+!0,r,"True",e),s(i,r+!1,r,"False",!e),i.buttonset(),i.change(n),i[0].value=e}else i=Te("<div>"+e+"</div");return i.css({"float":"right"}),i}function s(t,e,n,o,a){t.append(Te("<input/>").attr({type:"radio",id:e,name:n,checked:a})),t.append(Te("<label/>").attr({"for":e}).text(o))}function u(t,e){t.append(Te("<span/>").text(e))}function c(t){return t.charAt(0).toUpperCase()+t.slice(1)}var d=this,f=Te("<div />"),p=Te("<div />"),g=null,h=null,m={fill:{color:!0,opacity:!0},rotation:!0,outline:{color:!0,opacity:!0,width:!0,startcap:{style:["None:none","Arrow:open","Filled Arrow:block","Filled Ellipse:oval","Filled Diamond:diamond"],width:["medium","long","short"],height:["medium","wide","narrow"]},endcap:{style:["None:none","Arrow:open","Filled Arrow:block","Filled Ellipse:oval","Filled Diamond:diamond"],width:["medium","long","short"],height:["medium","wide","narrow"]}},text:{font:{bold:!0,italic:!0,color:!0,family:!0,size:!0}}};return d.show=e,d.hide=n,d.isVisible=o,d.cancel=a,d.reset=i,t(),d}function M(t){if(He){if(Ne.activeanno.get("readonly"))He.children(":contains(Properties)").unbind("click").children("a").css("color","#cdc9c9");else{var e=He.children(":contains(Properties)");void 0!==e.data("events")&&"click"in e.data("events")||e.bind("click",F),e.children("a").css("color","#000000")}0===He.closest().length&&Ie.prepend(He);var n={x:t.x-6,y:t.y-6};He.css({left:n.x,top:n.y}),He.show(),He.visible=!0}}function U(t){He&&(He.visible&&E(),He.remove());var e=Te.extend(!0,{},Re);if(Ue.trigger("contextmenu",[Ne.activeanno.getClonedData(),e]),Te.isEmptyObject(e))He=null;else{for(var n in e)e.hasOwnProperty(n)&&(e[n]=S(e[n]));He=C(e)}M(t)}function E(){He&&(He.hide(),He.visible=!1)}function C(t){var e=Ee.createMenu(t);return e.css({position:"fixed","z-index":99999}),e.mouseleave(E),e.visible=!1,e}function S(t){return function(){return E(),t.call(this,Ne.activeanno.getClonedData())}}function V(){var t=Ne.activepage?Ne.activepage._index:0;if(Ne.annos[t]){var e=Te.inArray(Ne.activeanno,Ne.annos[t]);-1!==e&&(Ne.activeanno=null,R(e,t))}E()}function F(){E(),Le.show(Ne.activeanno)}/**
	* Clears the annotations and related data from all pages
	*/
function O(){if(Ne.annos.length>0){if(Ne.annos.length=0,Oe)for(var t=0;t<Oe.length;t++)Oe[t]._grips.clear(),Oe[t]._paper.forEach(y),Oe[t]._paper._trash.remove(),Oe[t]._paper._trash.clear(),Oe[t]._paper._annos.remove(),Oe[t]._paper._annos.clear();Ue.trigger({type:"annotationscleared"})}}/**
	* Creates an annotation on the desired page with the given annotation data.
	* @param aConfig: object, Key value pairs representing annotation data.
	* @param pgNum: number, The zero based index of the page the annotation should be created on.
	* @param callback: function, Function to be called when the operation has completed.
	* @returns object: Atalasoft.Annotations.Annotation.
	*/
function B(t,e,n){var o={};t.multiview?o=t:(t&&t.type&&We[t.type]&&Te.extend(!0,o,We[t.type]),Te.extend(!0,o,t));var a=new Atalasoft.Annotations.Annotation(o,Ne);return a._pageindex=e,"undefined"==typeof Ne.annos[e]&&(Ne.annos[e]=[]),Ne.annos[e].push(a),Ee.redrawPageFromIndex(e,!0),"function"==typeof n&&n(a),ge(a),a}/**
	* Creates an annotation on the desired page with the given annotation data.
	* @param aConfig: object, Key value pairs representing annotation data.
	* @param pgNum: number, The zero based index of the page the annotation should be created on.
	* @param callback: function, Function to be called when the operation has completed.
	* @returns object, Key value pairs representing annotation data.
	*/
function I(t,e,n){var o=B(t,e,n).getClonedData();return Ue.trigger({type:Xe.annocreate,anno:o,page:e}),o}/**
	* Deletes an annotation on the given z-index and zero based page index.
	* @param pgNum: number, Zero based page index the annotation is located on.
	* @param annIndex: number, Zero based z-index of the annotation.
	*/
function H(t,e){R(e,t)}/**
	* Deletes an annotation on the given z-index and zero based page index.
	* @param annIndex: number, Zero based z-index of the annotation.
	* @param pgNum: number, Zero based page index the annotation is located on.
	*/
function R(t,e){var n=Ne.annos[e].splice(t,1)[0];Ne.activepage&&Ne.activepage._paper._annos.exclude(n.getObject()),Ne.activeanno===n&&(Ne.activeanno=null),n.dispose(),Ne.activepage&&Ne.activepage._grips.repaint(),Ue.trigger({type:"annotationdeleted",page:e,index:t})}/**
	* Gets an array of annotion data objects located on the given zero based page index.
	* @param pageNum: number, Zero based page index the annotations are located on.
	* @returns array: Array of annotation data objects on the given page index. 
	*/
function L(t){var e=[];if(0===Ne.annos.length||"undefined"==typeof Ne.annos[t])return e;for(var n=0;n<Ne.annos[t].length;n++)e[n]=Ne.annos[t][n].getClonedData();return e}function j(t,e){var n;if(isFinite(e)){if(e<Ne.annos.length)for(n=0;n<Ne.annos[e].length;++n)if(Ne.annos[e][n].isCloneSource(t))return Ne.annos[e][n]}else for(n=0;n<Ne.annos.length;++n){var o=j(t,n);if(o)return o}return null}/**
	* Inserts a layer of annotations at the source URL and index into the given page index.
	* @param sourceUrl: string, Url of the desired xmp annotation file.
	* @param sourceIndex: number, Zero based page index the layer is copied from.
	* @param index: number, Zero based page index the layer is to be inserted into.
	* @param callback: function, Function to be called when the operation has completed.
	*/
function q(t,e,n,o){h(t,e,n),"function"==typeof o&&o(),Ue.trigger({type:Xe.layerinserted,srcurl:t,srcindex:e,index:n}),Ue.trigger(Xe.layerschanged)}/**
	* Removes a layer of annotations.
	* @param index: number, Zero based page index of the layer to be removed.
	* @param callback: function, Function to be called when the operation has completed.
	*/
function N(t,e){m(t),"function"==typeof e&&e(),Ue.trigger({type:Xe.layerremoved,index:t}),Ue.trigger(Xe.layerschanged)}/**
	* Moves a layer of annotations from one page index to another.
	* @param sourceIndex: number, Zero based page index of the layer to be moved.
	* @param destIndex: number, Destination zero based page index.
	* @param callback: function, Function to be called when the operation has completed.
	*/
function W(t,e,n){v(t,e),"function"==typeof n&&n(),Ue.trigger({type:Xe.layermoved,srcindex:t,destindex:e}),Ue.trigger(Xe.layerschanged)}/**
	* Sets the default annotation properties for initially created annotations.  This accepts the same input as the main config.
	* @param aConfig: array, An array of JSON objects representing the starting properies of the associated type.
	* @returns object: Atalasoft.Controls.WebDocumentViewer
	*/
function Z(t){Fe.annotations.defaults=t;for(var e=0;e<t.length;e++)"string"==typeof t[e].type&&(We[t[e].type]=t[e]);return Ue}/**
	* Sets the default annotation properties for initially created stamp annotations.  This accepts the same input as the main config.
	* @param sConfig: array, An array of JSON objects representing pre-made stamp annotations.
	* @returns object: Atalasoft.Controls.WebDocumentViewer
	*/
function $(t){Fe.annotations.stamps=t;for(var e=0;e<t.length;e++)Ae(t[e]);if(Be){var n={type:"button",id:Ee._id+"_toolbar_Button_Stamp",icon:"stamp",tooltip:"Draw Stamp",text:""},o=Ee.createDropDownButton(n);n.onclick=Ee.drawAnnotation,Ee.createDropDownMenu(o,n,t)}return Ue}/**
	* Sets the default annotation properties for initially created image annotations.  This accepts the same input as the main config.
	* @param iConfig: array, An array of JSON objects representing pre-made image annotations.
	* @returns object: Atalasoft.Controls.WebDocumentViewer
	*/
function X(t){Fe.annotations.images=t;for(var e=0;e<t.length;e++)Pe(t[e]);if(Be){var n={type:"button",id:Ee._id+"_toolbar_Button_Image",icon:"image",tooltip:"Draw Image",text:""},o=Ee.createDropDownButton(n);n.onclick=Ee.drawAnnotation,Ee.createDropDownMenu(o,n,t)}return Ue}/**
	* Sets the default annotation properties for initially created custom annotations.  This accepts the same input as the main config.
	* @param cConfig: array, An array of JSON objects representing custom annotation types.
	* @returns object: Atalasoft.Controls.WebDocumentViewer
	*/
function J(t){Fe.annotations.custom=t;for(var e=0;e<t.length;e++)De(t[e]);if(Be){var n={type:"button",id:Ee._id+"_toolbar_Button_Custom",icon:"image",tooltip:"Draw Custom",text:""},o=Ee.createDropDownButton(n);n.onclick=Ee.drawAnnotation,Ee.createDropDownMenu(o,n,t)}return Ue}/**
    * Shows the text annotation editor. Ignores other types of annotations.
    * @param annotation: the annotation object to show editor for.     
    * @returns undefined 
    */
function Y(t){return Q(t,!0)}/**
    * Hides the text annotation editor. Ignores other types of annotations.
    * @param annotation: the annotation object to hide editor for.     
    * @returns undefined 
    */
function G(t){return Q(t,!1)}function Q(t,e){if("text"===t.type&&t){var n=t.getPageIndex(),o=j(t,n);if(e){var a=t.visible;a&&(Ee.isPageInView(n)?K(o,n):Ue.showPage(t.getPageIndex(),function(){K(o,n)}))}else o.trigger("hideeditor")}}function K(t,e){t&&(t.get("selectable")!==!1&&Ce.select(t,e,!1),t.trigger("showeditor"))}function te(){var t={};return Te.extend(!0,t,{data:Ne,defaults:We,drawing:Ze,drawready:$e,matrix:qe,menu:He,menuconfig:Re,pages:Oe,props:Le,viewport:Ie}),t}function ee(t){t&&(null===t._annos?t._annos=Ne.annos:Te.isArray(t._annos)&&(Ne.annos=t._annos))}function ne(t){t&&(t instanceof jQuery||(t=Te(t)),Ie=t)}function oe(t,e,n){return Ze?null:(t&&t.type&&We[t.type]&&Te.extend(!0,t,We[t.type]),Ne.activeanno&&null===Ne.activeanno.getObject()&&ce(),re(),Ne.activeanno=new Atalasoft.Annotations.Annotation(t,Ne),Ne.activeanno.bind({drawn:ue,cancelled:ce}),"function"==typeof e&&(ae=e),"function"==typeof n&&(ie=n),Ne.activeanno)}function ae(){}function ie(){}function re(){if(!$e){Ie.bind("mousedown",se),Atalasoft.Utils.Browser.Features.Touch&&Ie.bind("touchstart",se);for(var t=0;t<Oe.length;t++)Oe[t]._draw.toFront();$e=!0}}function le(){if($e){Ie.unbind("mousedown",se),Atalasoft.Utils.Browser.Features.Touch&&Ie.unbind("touchstart",se);for(var t=0;t<Oe.length;t++)Oe[t]._draw.reset();$e=!1}}function se(t){Ze=!0,Ie.unbind("mousedown",se),Atalasoft.Utils.Browser.Features.Touch&&Ie.unbind("touchstart",se),Ue.trigger({type:"annotationdrawstart",ann:Ne.activeanno.getClonedData()}),Ne.activeanno._pageindex=Ne.activepage._index,Ne.activeanno.startDraw(t,Ne.activepage._paper,{}),Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)<8&&Ne.activepage._draw.height(Ne.activepage.height())}function ue(){fe(),pe(Ne.activeanno),Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)<8&&Ne.activepage._draw.height("100%")}function ce(){Ne.activeanno.dispose(),Ne.activeanno=null,Ze&&fe(!0)}/**
	* Cancels the drawing of an annotation and returns the viewer to the previous tool.
	*/
function de(){$e&&(Ze?ce():(Ne.activeanno&&(Ne.activeanno.dispose(),Ne.activeanno=null),le()),ie({annotation:null}),ie=function(){})}function fe(t){Ze=!1,le(),Ue.trigger({type:"annotationdrawend",ann:t?null:Ne.activeanno.getClonedData(),cancelled:t?!0:!1})}function pe(t){var e=Ne.activepage,n=e?e._index:0;Ne.annos[n]?Ne.annos[n].push(t):Ne.annos[n]=[t],Ne.activeanno.unbind({drawn:ue,cancelled:ce}),ge(Ne.activeanno),Ce.select(Ne.activeanno,e,!1),ae({annotation:t}),ae=function(){},Ue.trigger({type:Xe.annocreate,anno:t.getClonedData(),page:n})}function ge(t){function e(e){Ue.trigger({type:Xe[e.type],anno:t.getClonedData()})}t.bind({dragstart:function(){Ue.trigger({type:"annotationdragstart",ann:t.getClonedData()})},dragend:function(){Ue.trigger({type:"annotationdragend",ann:t.getClonedData()})},interactstart:function(){Ne.activepage&&Ne.activepage._paper===t.getObject().paper||z(t.getObject().paper._page),Ne.activeanno=t},selected:he,deselected:he,reselected:he,contextmenu:U,serverrenderurlrequested:me,moved:e,rotated:e,annoresized:e,interactend:e,touchstart:e,touchmove:e,pinchmove:e,click:e,dblclick:e,rightclick:e,mousedown:e,mousedownleft:e,mousedownright:e,mousemove:e,mouseout:e,mouseup:e,mouseover:e,repaint:e})}function he(t){var e=t.page||t.pageindex>=0?t.pageindex:Ne.activepage;e=Ce.resolvePage(e),"selected"===t.type||"reselected"===t.type?(Ne.activeanno=t.ann,Ce.select(t.ann,e,t.append),Le&&Le.isVisible()&&Le.show(t.ann)):(Ce.deselect(t.ann,e,t.append),Le&&Le.isVisible()&&Le.cancel()),e._grips.repaint()}function me(t){var e=t.complete,n=ye(t.data);"function"==typeof e&&e.call(n)}function ve(){var t=[];for(var e in Ne.annos)if(Ne.annos.hasOwnProperty(e)){t[e]={items:[]};var n=0,o=Ee.getPageScale(e),a=Raphael.matrix();if(Ee._config.persistrotation){n=Ee.getPageRotation(e),a=Ee.getViewerTransform(e);var i=1/o;a.scale(i,i,0,0),a.e*=i,a.f*=i}for(var r in Ne.annos[e])if(Ne.annos[e].hasOwnProperty(r)){var l=Te.extend(!0,{},Ne.annos[e][r].get());if(l.rotation||n){var s=Ne.annos[e][r].getBox(),u=s.width/2,c=s.height/2,d=Raphael.matrix();d.add(a),d.add(Ne.annos[e][r].getTransform());var f={x:d.x(s.x+u,s.y+c),y:d.y(s.x+u,s.y+c)},p=f.x-u-s.x,g=f.y-c-s.y;if(l.points)for(var h=0;h<l.points.length;h++)if("line"===l.type){var m=d.x(l.points[h].x,l.points[h].y);l.points[h].y=d.y(l.points[h].x,l.points[h].y),l.points[h].x=m}else l.points[h].x+=p,l.points[h].y+=g;else"custom"!==l.type&&l.points||(l.x+=p,l.y+=g);l.rotation="line"!==l.type?(l.rotation+n)%360:0}t[e].items[r]=l,_e(l)}}return JSON.stringify(t)}function ye(t){return _e(t),JSON.stringify(t)}function _e(t){for(var e in t)if("color"===e&&null!=t[e]){var n=Raphael.getRGB(t[e]);n.error&&(n.hex="#000000"),t[e]=n.hex}else"points"!==e&&"object"==typeof t[e]&&_e(t[e])}function xe(t,e,n,o){var a={type:"annodata",serverurl:t,query:"?atalaanndata=",method:"GET",data:{atala_annurl:e,atala_a_ofs:n,atala_a_len:o},cancel:!1,info:{layers:[],offset:0,error:void 0}};return a}function be(t,e){function n(t){ze(t),"function"==typeof e&&e.call()}O(),Ee.makeHandlerRequest(t,n,n)}function we(t,e,n,o,a){null!=n&&"function"==typeof n&&(a=n,n=void 0);var i=xe(t,e,n,o);be(i,a)}function ze(t){if(t)if("undefined"!=typeof Raphael){var e={type:"annotationsloaded"};if(t.layers)for(var n=0;n<t.layers.length;n++){var a=t.offset+n;Ne.annos[a]&&Ne.annos[a].length>0?Ne.annos[a].length=0:Ne.annos[a]=[];var i=t.layers[n];if(i._index=isFinite(i._index)&&i._index>=0?i._index:a,i.visible=void 0!==i.visible?i.visible:!0,i.items)for(var r=0;r<i.items.length;r++)i.items[r].visible=i.items[r].visible&&i.visible,Ne.annos[a][r]=new Atalasoft.Annotations.Annotation(i.items[r],Ne),Ne.annos[a][r]._pageindex=i._index,Ue.trigger({type:Xe.annoload,anno:Ne.annos[a][r].getClonedData()}),ge(Ne.annos[a][r])}else t.error&&(e.error=t.error);e.offset=t.offset,e.length=t.layers?t.layers.length:0,Ue.trigger(e)}else o(function(){ze(t)})}function Ae(t){return t.type="stamp",t.text&&(ke(t.text),t.text.readonly=!0),t}function ke(t){return t&&t.font&&t.font.size&&(t.font.size=parseFloat(t.font.size)),t}function Pe(t){return t.type="image",t}function De(t){t.type="custom"}var Te=Atalasoft.$,Me=this,Ue=t,Ee=e,Ce=new Atalasoft.Annotations.AnnotationSelector,Se={/** Triggers when the user uses the mouse to click on an annotation. Populated keys: e.anno */
annotationclicked:null,/** Triggers when the user uses the mouse to create an annotation. Populated keys: e.anno */
annotationcreated:null,/** Triggers when the user uses the mouse to double-click on an annotation. Populated keys: e.anno */
annotationdoubleclicked:null,/** Triggers when an annotation is loaded into the document. Populated keys: e.anno */
annotationloaded:null,/** Triggers when the user has depressed a mouse button on an annotation. Populated keys: e.anno */
annotationmousedown:null,/** Triggers when the user has depressed the left mouse button on an annotation. Populated keys: e.anno */
annotationmousedownleft:null,/** Triggers when the user has depressed the right mouse button on an annotation. Populated keys: e.anno */
annotationmousedownright:null,/** Triggers when the user moves the mouse pointer over an annotation. Populated keys: e.anno */
annotationmousemove:null,/** Triggers when the user has moved the mouse pointer out of the bounds of the annotation. Populated keys: e.anno */
annotationmouseout:null,/** Triggers when the user has moved the mouse pointer into the bounds of the annotation. Populated keys: e.anno */
annotationmouseover:null,/** Triggers when the user has released a mouse button on an annotation. Populated keys: e.anno */
annotationmouseup:null,/** Triggers when an annotation has been moved. Populated keys: e.anno */
annotationmoved:null,/** Triggers when an annotation has been rotated. Populated keys: e.anno */
annotationrotated:null,/** Triggers when a pinch gesture has been detected on an annotation. Populated keys: e.anno */
annotationpinchresize:null,/** Triggers when an annotation has been repainted. Populated keys: e.anno */
annotationrepainted:null,/** Triggers when an annotation has been resized. Populated keys: e.anno */
annotationresized:null,/** Triggers when the user right clicks on an annotation. Populated keys: e.anno */
annotationrightclicked:null,/** Triggers when a touch end event has been finished on an annotation. Populated keys: e.anno */
annotationtouchend:null,/** Triggers when a touch move event is happening on an annotation. Populated keys: e.anno */
annotationtouchmove:null,/** Triggers when a touch event has started on an annotation. Populated keys: e.anno */
annotationtouchstart:null,/** Triggers when a layer has been inserted into the document. Populated keys: e.srcurl, e.srcindex, e.index */
layerinserted:null,/** Triggers when a layer has moved from one index to another within the document. Populated keys: e.srcindex, e.destindex */
layermoved:null,/** Triggers when a layer has been removed from the document. Populated keys: e.index */
layerremoved:null,/** Triggers when a layer has been changed. Populated keys: none */
layerschanged:null,/** Triggers when all annotations have been deleted. Populated keys: none */
annotationscleared:null,/** Triggers when an annotation is deleted. Populated keys: e.page, e.index */
annotationdeleted:null,/** Triggers when a user has started drawing an annotation with the mouse or a touch event. Populated keys: e.ann */
annotationdrawstart:null,/** Triggers when a user has finished drawing an annotation with the mouse or a touch event. Populated keys: e.ann */
annotationdrawend:null,/** Triggers when an annotation has started dragging. Populated keys: e.ann */
annotationdragstart:null,/** Triggers when an annotation has finished dragging. Populated keys: e.ann */
annotationdragend:null,/** Triggers when the context menu is shown for an annotation. Event signature: function(event, anno, menu) */
contextmenu:null,/** Triggers when the Raphael dependency has finished loading. Populated keys: none */
raphaelloaded:null},Ve={annotations:{events:Se,getSelected:Ce.getSelected,selectAll:Ce.selectAll,deselectAll:Ce.deselectAll,selectAllOnPage:Ce.selectPage,deselectAllOnPage:Ce.deselectPage,cancelDraw:de,getFromPage:L,createOnPage:I,deleteFromPage:H,showEditor:Y,hideEditor:G,setDefaults:Z,setImages:X,setStamps:$,insertLayer:q,removeLayer:N,moveLayer:W},deselectAll:Ce.deselectAll,createAnnotationOnPage:I,getAnnotationsFromPage:L,deleteAnnotationOnPageAtIndex:H,setAnnotationDefaults:Z,setImages:X,setStamps:$};if(Atalasoft.Annotations.AnnotationController.__exposedApi=Ve.annotations,!t)return null;var Fe=e._config,Oe=e._pages,Be=!1,Ie=null,He=null,Re=null,Le=null,je=[],qe=null,Ne={annos:[],activepage:null,activeanno:null,readonly:n?!0:!1,zoom:Ue.getZoom(),getZoom:Ee.getPageScale,getViewerTransform:Ee.getViewerTransform,getPageRotation:Ee.getPageRotation},We={},Ze=!1,$e=!1,Xe={click:"annotationclicked",dblclick:"annotationdoubleclicked",touchstart:"annotationtouchstart",interactend:"annotationtouchend",touchmove:"annotationtouchmove",pinchmove:"annotationpinchresize",rightclick:"annotationrightclicked",mousedown:"annotationmousedown",mousedownleft:"annotationmousedownleft",mousedownright:"annotationmousedownright",mousemove:"annotationmousemove",mouseout:"annotationmouseout",mouseup:"annotationmouseup",mouseover:"annotationmouseover",annocreate:"annotationcreated",annoload:"annotationloaded",moved:"annotationmoved",rotated:"annotationrotated",annoresized:"annotationresized",repaint:"annotationrepainted",layerinserted:"layerinserted",layerremoved:"layerremoved",layermoved:"layermoved",layerschanged:"layerschanged"};"undefined"==typeof Raphael?(Atalasoft.Utils._scriptLoader=Atalasoft.Utils.__loadDependencies(Fe.scripturl,Fe.allowannotations),Atalasoft.Utils._scriptLoader&&Atalasoft.Utils._scriptLoader.bind({scriptsloaded:i})):i(),u(),Me.addDrawingSurface=p,Me.removeDrawingSurface=g,Me.insertLayer=h,Me.removeLayer=m,Me.moveLayer=v,Me.showLayer=b,Me.clear=O,Me.createAnnotation=B,Me.deleteAnnoOnPage=H,Me.drawAnnotation=oe,Me.getAnnosFromPage=L,Me.setStamps=$,Me.setAnnotationDefaults=Z,Me.setImages=X,Me.setCustom=J,Me.dispose=l,/**
	* [Internal] Gets debug info object
	* @returns debug info object if available, otherwise null
	*/
Me.__getDebugInfo=te,/**
	* [Internal] Links the annotation data between two controls
	* @param linker internal object of type __LVlinker
	* @returns undefined
	*/
Me.__linkAnnotations=ee,Me.setViewPort=ne,Me.stringifyChanges=ve,Me.stringifyAnnotationData=ye,Me.createHandlerRequest=xe,Me.makeHandlerRequest=be,Me.loadAnnotationsUrl=we,Me.loadAnnotations=ze},Atalasoft.Annotations.Grips=function(t,e){function n(){var e;for(var n in C)if(C.hasOwnProperty(n)){var i=t._paper.rect(0,0,M,M),r=o(i,n);O.push(r),O[C[n]]=r,e=Raphael.matrix(),e.rotate(C[n]),S[n]={x:e.x(1,0),y:e.y(1,0)}}H=a(),k()}function o(t,e){return t.attr({fill:"#FFFFE1",cursor:(e||"ne")+"-resize"}),t.grip=!0,t.rect=t.getBBox(),t.hide(),t.center=function(t,e,n,o){n=n||1;var a=M/n,i=M/n,r=a/2,l=Math.round(a/2)+.5,s=Math.round(i/2)+.5;Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)>8&&(s-=.5);var u=Math.round(t)-l,c=Math.round(e)-s;this.ellipse?(u+=r,this.attr({cx:u,cy:c,r:r,"stroke-width":1})):this.attr({x:u,y:c,width:a,height:i,"stroke-width":1}),this.node.setAttribute("stroke-width",1),this.transform(o)},e&&(t.d={key:e,n:~e.indexOf("n"),s:~e.indexOf("s"),w:~e.indexOf("w"),e:~e.indexOf("e")},t.mousedown(function(t){return _(t,this.d)})),t}function a(){var e=t._paper.circle(0,0,M/2),n=o(e).attr({fill:"#00FF40",cursor:"pointer"});return n.ellipse=!0,O.push(n),n.mousedown(function(t){return m(t,n)}),n}function i(t){return-1!==T.inArray(t,I)}function r(){for(var t=0;t<I.length;t++)s(I[t]);I.length=0,B.clear(),O.hide()}function l(t){t.getEventObject().bind(q)}function s(t){t.getEventObject().unbind(q)}function u(){B.length>0?d():I.length>0?r():O.hide()}function c(t){for(var e in C)C.hasOwnProperty(e)&&A(O[C[e]],t)}function d(){if(B.length>0){var t=1===B.length?I[0].getBox():B.getBBox();j.x=t.x,j.y=t.y,j.width=t.width,j.height=t.height,j.x2=t.x+t.width,j.y2=t.y+t.height,j.xmid=t.x+t.width/2,j.ymid=t.y+t.height/2,g()}}function f(t,e,n,o){0===L&&(j.x=t,j.width=Math.max(n,1),j.x2=t+j.width,j.xmid=t+j.width/2),0===D&&(j.y=e,j.height=Math.max(o,1),j.y2=e+j.height,j.ymid=e+j.height/2),g()}function p(){for(var t=0;t<I.length;t++)I[t].transform(j.x,j.y,j.width,j.height)}function g(){var e=1===B.length,n=Raphael.matrix(),o=1,a="";n.add(F.getViewerTransform(t._index)),e&&(n.add(I[0].getTransform()),o=F.getZoom(t._index),a=n.toTransformString(!0)),O[C.nw].center(j.x,j.y,o,a),O[C.ne].center(j.x2,j.y,o,a),O[C.sw].center(j.x,j.y2,o,a),O[C.se].center(j.x2,j.y2,o,a),O[C.n].center(j.xmid,j.y,o,a),O[C.w].center(j.x,j.ymid,o,a),O[C.e].center(j.x2,j.ymid,o,a),O[C.s].center(j.xmid,j.y2,o,a),H.center(j.xmid,j.y-U/o,o,a);var i=1===I.length?I[0].get().rotation:0;c(i+F.getPageRotation(t._index))}function h(e){var n=t.offset(),o=Atalasoft.Utils.getSVGOffset(t._paper.canvas,t),a={x:e.pageX-(n.left+o.left),y:e.pageY-(n.top+o.top)};return a}function m(e){if(e.stopPropagation(),1===I.length&&1===B.length){for(var n=0;n<I.length;n++){var o=I[n].get("resizable");if(o.hasOwnProperty("selectable")&&!o.selectable||o.hasOwnProperty("movable")&&!o.movable||o.readOnly)return}T.extend(R,j);var a=I[0].getTransform(),i=a.x(R.xmid,R.ymid);R.ymid=a.y(R.xmid,R.ymid),R.xmid=i,T(t._paper.canvas).bind({mouseup:y,mousemove:v})}}function v(e){e.stopPropagation();var n=z(h(e)),o=180*Math.atan2(n.y-R.ymid,n.x-R.xmid)/Math.PI+90;return 1===I.length&&(I[0].set({rotation:o}),I[0].repaint()),t._grips.repaint(),!1}function y(e){return e.stopPropagation(),T(t._paper.canvas).unbind({mouseup:y,mousemove:v}),1===I.length&&I[0].getEventObject().trigger("rotated"),!1}function _(e,n){if(e.stopPropagation(),!(I.length>1)){for(var o=0;o<I.length;o++)if(!I[o].get("resizable"))return;return T.extend(R,j),L=C[n.key]===C.n||C[n.key]===C.s?1:0,D=C[n.key]===C.w||C[n.key]===C.e?1:0,(n.n||1===D)&&(R.y=R.y2),n.w&&(R.x=R.x2),T(t._paper.canvas).bind({mouseup:b,mousemove:x}),!1}}function x(t){if(t.stopPropagation(),1===B.length){var e=w(h(t)),n=Math.abs(e.x-R.x),o=Math.abs(e.y-R.y),a=e.x<R.x?R.x-n:R.x,i=e.y<R.y?R.y-o:R.y;f(a,i,n,o),p()}return!1}function b(e){e.stopPropagation();for(var n=0;n<I.length;n++)I[n].getEventObject().trigger("resized"),I[n].getEventObject().trigger("annoresized"),I[n].repaint();return B.length>0&&d(),T(t._paper.canvas).unbind({mouseup:b,mousemove:x}),!1}function w(t){if(1===B.length){var e=B[0].matrix.invert(),n={x:e.x(t.x,t.y),y:e.y(t.x,t.y)};return n}return t}function z(e){var n=F.getViewerTransform(t._index).invert(),o=n.x(e.x,e.y);return e.y=n.y(e.x,e.y),e.x=o,e}function A(t,e){if(t&&t.d&&t.d.key){var n=Raphael.matrix();n.rotate(e);var o={x:n.x(S[t.d.key].x,S[t.d.key].y),y:n.y(S[t.d.key].x,S[t.d.key].y)};for(var a in V)if(V.hasOwnProperty(a)&&P(o,V[a].start,V[a].end)){t.attr({cursor:(V[a].dir||"ne")+"-resize"});break}}}function k(){var t=Raphael.matrix();t.rotate(E,0,0);for(var e=function(e,n){var o={dir:n,start:{x:t.x(S[e].x,S[e].y),y:t.y(S[e].x,S[e].y)},end:{x:t.x(S[n].x,S[n].y),y:t.y(S[n].x,S[n].y)}};return o},n=["e","ne","n","nw","w","sw","s","se"],o=0;o<n.length-1;++o)0===o&&(V[n[o]]=e(n[n.length-1],n[o])),V[n[o+1]]=e(n[o],n[o+1])}function P(t,e,n){function o(t,e){return-t.x*e.y+t.y*e.x>0}return!o(e,t)&&o(n,t)}var D,T=Atalasoft.$,M=8,U=25,E=-22.5,C={e:0,ne:315,n:270,nw:225,w:180,sw:135,s:90,se:45},S={},V={},F=e,O=t._paper.set(),B=t._paper.set(),I=[],H=null,R={},L=null,j={x:0,y:0,width:1,height:1,x2:1,y2:1},q={dragstart:function(){},dragmove:function(){O.hide()},moved:function(){u(),O.show()}};n(),this.push=function(t){i(t)||(I.push(t),B.push(t.getObject()),t.get("selectable")===!0&&l(t),u(),O.toFront(),O.show())},this.contains=i,this.remove=function(t){for(var e=0;e<I.length;e++)I[e]===t&&I.splice(e,1);B.exclude(t.getObject()),s(t)},this.clear=r,this.repaint=u,this.updateCursor=c},Atalasoft.Annotations.AnnotationSelector=function(t,e){function n(t){_=t}function o(t){x=t}function a(){y=null,_=null,x=null,b.length=0}function i(t,e,n){l(!0,t,e,n)}function r(t,e,n){l(!1,t,e,n)}function l(t,e,n,o){var a,i,r=[].concat(e),l=null;l=c(n),l===n&&(n=l._index),o||f(l||n);for(var s=0;s<r.length;s++)a=r[s],i=v.inArray(a,b[n]),i>=0?t||b[n][i]!==a||b[n].splice(i,1):t&&(b[n]?b[n].push(a):b[n]=[a]),l&&(t?l._grips.push(a):l._grips.remove(a)),a.get("selected")!==t&&a.toggleSelected({append:!0,pageindex:n,page:l})}function s(t,e){var n="object"==typeof e?e._index:e;_[n]&&l(t,_[n],e,!0)}function u(t){for(var e=[],n=0;n<t.length;n++)if(t[n]){e[n]=[];for(var o=0;o<t[n].length;o++)e[n][o]=t[n][o].getClonedData()}return e}function c(t){var e=null;if("object"==typeof t)e=t;else{t=Math.max(t,0);var n=v.grep(x,function(e){return e._index===t});n.length>=1&&(e=n[0])}return e}/**
	* Selects all annotations on the given page.
	* @param fIndex: number, The zero based index of the page the annotations should be selected on.
	* @returns undefined
	*/
function d(t){s(!0,t)}/**
	* Deselects all annotations on the given page.
	* @param fIndex: number, The zero based index of the page the annotations should be deselected on.
	* @returns undefined
	*/
function f(t){var e=c(t);s(!1,e),e._grips.repaint()}/**
	* Selects all annotations on every page.
	* @returns undefined
	*/
function p(){for(var t=0;t<_.length;t++)d(t)}/**
	* Deselects all annotations on every page.
	* @returns undefined
	*/
function g(){for(var t=0;t<_.length;t++)f(t)}/**
	* Gets an array of selected annotation data objects.
	* @returns array containing annotation data objects for selected annotations only.
	*/
function h(){return u(b)}/**
	* Gets an array of all annotation data objects.
	* @returns array of arrays containing annotation data objects for each page of the document.
	*/
function m(){return u(_)}var v=Atalasoft.$,y=this,_=t,x=e,b=[];y.dispose=a,y.select=i,y.deselect=r,y.setAnnos=n,y.setPages=o,y.resolvePage=c,y.deselectAll=g,y.deselectPage=f,y.getAnnotations=m,y.getSelected=h,y.selectAll=p,y.selectPage=d},Atalasoft.Annotations.Annotation=function(t,e){function n(){t.multiview||w(t.type),f(t,!0),u(),G=new Atalasoft.Annotations.DrawHandler(ee,N,Z,W),i({repaint:G.events.update,viewchanged:G.events.viewchanged,drawn:A,resized:c}),ee.points&&(ee.x>0||ee.y>0)&&(D(ee.x,ee.y),ee.x=0,ee.y=0,ee.width=1,ee.height=1),o()}function o(){oe={selectable:{selectchange:x},movable:{dragstart:G.events.dragstart,dragmove:G.events.dragmove,dragend:G.events.dragend},resizable:{pinchstart:G.events.pinchstart,pinchmove:G.events.pinchmove,pinchend:G.events.pinchend},boundEvents:{resizable:!1,movable:!1,selectable:!1},isBound:function(t){return this.boundEvents[t]},bound:function(t){this.boundEvents[t]=!0},unbound:function(t){this.boundEvents[t]=!1}}}function a(){ee.selected&&x(),Z&&Z.unbind(),X&&X.remove(),J&&J.dispose(),Y&&Y.remove(),N=null,W=null,Z=null,X=null,J=null,Y=null,ee=null}function i(){Z.bind.apply(Z,arguments)}function r(){Z.unbind.apply(Z,arguments)}function l(){return Z.trigger.apply(Z,arguments),W}function s(t,e){var n=(t-e+360)%360,o=Raphael.matrix();o.add(g());var a=P();o.rotate(n,a.x+a.width/2,a.y+a.height/2);var i=o.x(a.x,a.y),r=o.y(a.x,a.y);D(i-a.x,r-a.y),u()}function u(){var t=Raphael.matrix(),e=P();t.rotate(ee.rotation,e.x,e.y),ee.transform=t}function c(){var t=P(),e=j(g(),t);(e.x!==t.x||e.y!==t.y)&&D(e.x-t.x,e.y-t.y)}function d(t,e){if(t){var n=ee.rotation;t.hasOwnProperty("rotation")&&(t.rotation=(t.rotation+360)%360),f(t,e,!1),n!==ee.rotation&&s(ee.rotation,n)}}function f(t,e){e?q.extend(!0,ee,t):q.extend(ee,t)}function p(t){return t?ee[t]:ee}function g(){return ee.transform}function h(){function t(){delete ee.update,delete ee.getPageIndex}K={/**
            * Updates the annotatin state.
            * @param viewOnly: bool, indicates whether
            *  to update data from this instace or only repaint view.
            */
update:function(e){ee.selected!==K.selected&&x(),e||d(K,!0),t(),F(),V(),k()},getPageIndex:function(){return W._pageindex}},q.extend(!0,K,ee)}function m(){return K?q.extend(!0,K,ee):h(),delete K.transform,K}function v(){return X}function y(){return Z}function _(){return JSON.stringify(ee)}function x(t){if(ee){var e={ann:W,append:!0,page:null,pageindex:W._pageindex,type:""};t&&(e.append=t.shiftKey||t.ctrlKey||"undefined"!=typeof t.append&&t.append,e.page=t.page,e.pageindex=t.pageindex),e.append||!ee.selected?(ee.selected=!ee.selected,e.type=ee.selected?"selected":"deselected"):ee.selected&&!e.append&&(e.type="reselected"),""!==e.type&&l(e)}}function b(t){return K&&K===t}function w(t){q.extend(!0,ee,ne[t])}function z(t){var e=null;switch(ee.type){case"image":e=t.image(),e.attr("src",ee.src);break;case"highlight":e=t.rect();break;case"rectangle":e=t.rect();break;case"fillrect":e=t.rect();break;case"text":e=t.rect();break;case"stamp":e=t.rect();break;case"ellipse":e=t.path();break;case"line":e=t.path();break;case"lines":e=t.path();break;case"freehand":e=t.path();break;case"polygon":e=t.path();break;case"custom":Q=Atalasoft.Annotations.AnnotationCustomRenderer(ee,Z),e=Q.construct(t)}return t._annos&&t._annos.push(e),e}function A(){null!==$&&(X?Z.unbind(X,$):Z.unbind($));var t={};ee.selectable&&(q.extend(t,oe.selectable),oe.bound("selectable"),!N.readonly&&ee.movable&&(q.extend(t,oe.movable),oe.bound("movable")),!N.readonly&&ee.resizable&&Atalasoft.Utils.Browser.Features.Touch&&(q.extend(t,oe.resizable),oe.bound("resizable"))),$=t,Z.bind(X,t)}function k(){null!==$&&(ee.selectable?(oe.isBound("selectable")||(Z.bind(oe.selectable),oe.bound("selectable")),ee.movable&&!oe.isBound("movable")?(Z.bind(oe.movable),oe.bound("movable")):!ee.movable&&oe.isBound("movable")&&(Z.unbind(oe.movable),oe.unbound("movable")),Atalasoft.Utils.Browser.Features.Touch&&(ee.resizable&&!oe.isBound("resizable")?(Z.bind(oe.resizable),oe.bound("resizable")):!ee.resizable&&oe.isBound("resizable")&&(Z.unbind(oe.resizable),oe.unbound("resizable")))):!ee.selectable&&oe.isBound("selectable")&&(Z.unbind(oe.selectable),oe.unbound("selectable"),Z.unbind(oe.movable),oe.unbound("movable"),Z.unbind(oe.resizable),oe.unbound("resizable")))}/**
     * Returns bounding box of the annotation in document space.
    */
function P(){!te&&ee.points&&(te=Atalasoft.Utils.__calcPathBounds(ee.points));var t=ee.points?te:ee;return{x:t.x,y:t.y,width:t.width,height:t.height}}function D(t,e){if(ee.points){for(var n=0;n<ee.points.length;n++)ee.points[n].x+=t,ee.points[n].y+=e;te&&(te.x+=t,te.y+=e)}"custom"!==ee.type&&ee.points||(ee.x+=t,ee.y+=e),u(),E()}function T(t,e,n,o){var a=P(),i=n/a.width,r=o/a.height;if(ee.points&&ee.points.length>0&&"custom"!==ee.type){for(var s=0;s<ee.points.length;s++)ee.points[s].x=t+(ee.points[s].x-a.x)*i,ee.points[s].y=e+(ee.points[s].y-a.y)*r;te.x=t,te.y=e,te.width*=i,te.height*=r}else ee.x=t,ee.y=e,ee.width*=i,ee.height*=r;l({type:"annoresizing"}),E()}function M(){G.transformUI.apply(G,arguments)}function U(){G.commitTransform()}function E(){ae||(ae=!0,setTimeout(C,ie))}function C(){ae=!1,V()}function S(t,e,n){d(n),X=z(e),X.transform(G.getTransform()),("text"===ee.type||"stamp"===ee.type)&&(J=new Atalasoft.Annotations.TextAnnotationUI(W,e,N)),F(),G.drawStart(t,X,J,Q)}function V(t){t&&(Y&&(Y=null),X=z(t),Q&&Q.render(X,ee),F(),A(),"text"!==ee.type&&"stamp"!==ee.type||null!==J||(J=new Atalasoft.Annotations.TextAnnotationUI(W,t,N)),J&&J.changepaper(t),l({type:"viewchanged",annview:X,textview:J})),l("repaint")}function F(){if(X){var t=I();q.extend(t,H()),X.attr(t),R(),ee.visible?X.show():X.hide()}O(),B()}function O(){J&&(J.set(ee.text),J.updateView())}function B(){X&&""!==ee.src&&"image"===ee.type&&("unknown"!=typeof X.node.src&&X.node.src?X.node.src=ee.src:X.node.href.baseVal=ee.src)}function I(){return{fill:ee.fill.color,"fill-opacity":ee.fill.opacity}}function H(){var t={stroke:ee.outline.color,"stroke-width":ee.outline.width*N.getZoom(W._pageindex),"stroke-opacity":ee.outline.opacity};return X._linewidth=ee.outline.width,Raphael.fn.addArrow||(ee.outline.startcap&&(t["arrow-start"]=L(ee.outline.startcap)),ee.outline.endcap&&(t["arrow-end"]=L(ee.outline.endcap))),t}function R(){Raphael.fn.addArrow&&(ee.outline.startcap&&Raphael.fn.addArrow(X,L(ee.outline.startcap),!1),ee.outline.endcap&&Raphael.fn.addArrow(X,L(ee.outline.endcap),!0))}function L(t){return[t.style,"-",t.width,"-",t.height].join("")}function j(t,e){return{x:t.x(e.x,e.y),y:t.y(e.x,e.y)}}var q=Atalasoft.$,N=e,W=this,Z=new Atalasoft.Annotations.EventHelper(W),$=null,X=null,J=null,Y=null,G=null,Q=null,K=null,te=null,ee=t.multiview?t:{type:"",x:0,y:0,width:0,height:0,rotation:0,transform:Raphael.matrix(),visible:!0,movable:!0,resizable:!0,selected:!1,selectable:!0,readonly:!1,tooltip:"",name:"",username:"",zindex:null,aspectratio:0,fill:{color:"white",opacity:1},outline:{color:"black",opacity:1,width:2},src:"",text:{value:null,align:"left",font:{bold:!1,italic:!1,strike:!1,underline:!1,color:"black",family:"Arial",size:12},readonly:!1,replies:null,parent:null}},ne={highlight:{readonly:!0,fill:{color:"yellow",opacity:.5},outline:{opacity:0}},image:{readonly:!0,fill:{color:null},outline:{opacity:0}},rectangle:{fill:{opacity:0}},stamp:{readonly:!0},line:{fill:{color:null},outline:{opacity:1,startcap:{width:"medium",height:"medium",style:"none"},endcap:{width:"medium",height:"medium",style:"none"}}},lines:{fill:{color:null},outline:{opacity:1}},freehand:{fill:{color:null},outline:{opacity:1}},ellipse:{},fillrect:{},polygon:{},text:{}},oe={};n(),W.dispose=a,W.bind=i,W.unbind=r,W.trigger=l,W.set=d,W.get=p,W.getTransform=g,W.getClonedData=m,W.getObject=v,W.getEventObject=y,W.getZoom=function(){return N.getZoom(W._pageindex)},W.stringify=_,W.getJSON=_,W.toggleSelected=x,W.isCloneSource=b,W.getBox=P,W.translate=D,W.transform=T,W.transformUI=M,W.commitTransform=U;var ae=!1,ie=Atalasoft.Utils.Browser.Explorer?20:5;return W.startDraw=S,W.repaint=V,W.updateView=F,W},Atalasoft.Annotations.EventHelper=function(t){function e(){V=new Atalasoft.Annotations.PointerHandler,V.bind({click:x,dblclick:b,mousedown:w,mousemove:z,mouseover:k,mouseout:A,mouseup:P,touchmove:D,touchstart:M,interactstart:l,interactend:s,pinchstart:g,pinchmove:h,pinchend:m,selectchange:v,contextmenu:y,showeditor:_,annoresized:T})}function n(t){F.px=F.mx,F.py=F.my,t.originalEvent?(F.mx=t.originalEvent.targetTouches[0].pageX,F.my=t.originalEvent.targetTouches[0].pageY):(F.mx=t.targetTouches[0].pageX,F.my=t.targetTouches[0].pageY),F.dx=F.mx-F.px,F.dy=F.my-F.py}function o(t){F.px=F.mx,F.py=F.my,F.mx=t.screenX,F.my=t.screenY,F.dx=F.mx-F.px,F.dy=F.my-F.py}function a(t){var e=arguments;!t||t.constructor.prototype!==Raphael.el&&t.constructor.prototype!==Raphael.st||(t.drag(u,c,d),t.hover(f,p),U(t[0]).bind(V.events),e=Array.prototype.slice.call(e,1)),e.length>0&&C.bind.apply(C,e)}function i(t){var e=arguments;t&&t.constructor.prototype===Raphael.el?(t.undrag(),t.unhover(f,p),U(t[0]).unbind(V.events),e=Array.prototype.slice.call(e,1)):null===t&&e.length>1&&(e=Array.prototype.slice.call(e,1)),C.unbind.apply(C,e)}function r(){C.trigger.apply(C,arguments)}function l(){r({type:"interactstart",target:S})}function s(){r({type:"interactend",target:S})}function u(t,e,a,i,l){(t||e)&&(Atalasoft.Utils.Browser.Features.Touch&&l.target!==F.target||(null===F.px&&c(null,null,l),l.touches?n(l):o(l),r({type:"dragmove",dx:F.dx,dy:F.dy,mx:F.mx,my:F.my,originalEvent:l})))}function c(t,e,a){F.target=a.target,l(),a.touches?n(a):o(a),r({type:"dragstart",mx:F.mx,my:F.my,originalEvent:a})}function d(t){Atalasoft.Utils.Browser.Features.Touch&&t.target!==F.target||(F.target=null,F.px=null,F.py=null,F.mx=null,F.my=null,r({type:"dragend",originalEvent:t}))}function f(){r("hoverin")}function p(){r("hoverout")}function g(t){r(t)}function h(t){r(t)}function m(t){F.px=null,F.py=null,r(t)}function v(t){r(t)}function y(t){r(t)}function _(t){r(t)}function x(t){r(t)}function b(t){r(t)}function w(t){r(t),1===t.which?r("mousedownleft"):3===t.which&&r("mousedownright")}function z(t){r(t)}function A(t){r(t)}function k(t){r(t)}function P(t){r(t),3===t.which&&r("rightclick")}function D(t){r(t)}function T(t){r(t)}function M(t){r(t)}var U=Atalasoft.$,E=this,C=U({}),S=t,V=null,F={target:null,mx:null,my:null,px:null,py:null,dx:null,dy:null};e(),E.bind=a,E.unbind=i,E.trigger=r},Atalasoft.Annotations.DrawHandler=function(t,e,n,o){function a(){}function i(t){var e=Atalasoft.Utils.getMousePositionJquery(t);if(j.paper){var n=Atalasoft.Utils.getSVGOffset(j.paper.canvas,j.paper._page);e.x-=n.left,e.y-=n.top}return e}function r(t){var e=R.getViewerTransform(W._pageindex).invert(),n=e.x(t.x,t.y);return t.y=e.y(t.x,t.y),t.x=n,t}function l(){L.trigger.apply(L,arguments)}function s(t,e,n,o){j=e,q=n,N=o,t.stopPropagation(),t.preventDefault();var a=r(i(t));H.visible=!0,$={x:a.x,y:a.y},H.x=Math.round(a.x),H.y=Math.round(a.y),H.width=1,H.height=1,"path"===j.type&&"custom"!==H.type?"ellipse"!==H.type?(H.points=[{x:H.x,y:H.y}],("lines"===H.type||"polygon"===H.type)&&H.points.push({x:H.x,y:H.y}),H.x=0,H.y=0,Y=c,G=D):(Y=d,G=P):(Y=d,G=k),z(),Z={events:Atalasoft.Utils.Browser.Features.Touch?{touchend:f,touchmove:u,mouseup:f,mousemove:u}:{mouseup:f,mousemove:u},src:B(t.srcElement||t.target),main:B(t.currentTarget)},Z.src.bind(Z.events),Z.main.bind({mouseup:f})}function u(t){t.stopPropagation(),Y(t),z()}function c(t){var e=r(i(t));switch(H.type){case"line":H.points[1]=e;break;case"freehand":H.points.push(e);break;case"lines":H.points[H.points.length-1]=e;break;case"polygon":H.points[H.points.length-1]=e}"path"===j.type&&("ellipse"===H.type?T():M(),j._&&0===j._.dirty&&(j._.dirty=1))}function d(t){var e=r(i(t)),n=$.x,o=$.y,a=Math.max(Math.abs(e.x-$.x),1),l=Math.max(Math.abs(e.y-$.y),1);if(H.aspectratio>0){var s=Math.abs((e.y-$.y)/(e.x-$.x));s>1/H.aspectratio?a=Math.round(l/H.aspectratio):l=Math.round(a/H.aspectratio)}e.x<$.x&&(n=$.x-a),e.y<$.y&&(o=$.y-l),H.x=n,H.y=o,H.width=a,H.height=l}function f(t){t.stopPropagation();var e=!1;if("lines"===H.type||"polygon"===H.type){if(H.points.push(r(i(t))),2!==t.button)return}else H.points?H.points&&H.points.length<2&&"custom"!==H.type&&(e=!0):(H.width<4&&H.height<4&&(H.width=100,H.height=100),z());Z.src.unbind(Z.events),Z.main.unbind({mouseup:f}),Z=null,e?l("cancelled"):l("drawn")}function p(t){if(!R.readonly){t.originalEvent.stopPropagation();var e=W.getBox();$={x:e.x,y:e.y}}}function g(t){if(!R.readonly){t.originalEvent.stopPropagation();var e=r({x:0,y:0}),n=r({x:t.dx,y:t.dy});W.translate(n.x-e.x,n.y-e.y),l("moving")}}function h(t){if(!R.readonly){t.originalEvent.stopPropagation();var e=W.getBox();if(j.paper&&j.paper._page){var n=j.getBBox(),o={x:0,y:0,width:j.paper._page.width(),height:j.paper._page.height()};if(!S(o,n))return W.translate($.x-e.x,$.y-e.y),void 0}($.x!==e.x||$.y!==e.y)&&l("moved")}}function m(t){if(!H.points&&!R.readonly){var e=r({x:t.touches[0].clientX,y:t.touches[0].clientY}),n=r({x:t.touches[1].clientX,y:t.touches[1].clientY}),o=W.getBox();J={start:Atalasoft.Utils.CalcDistance(e.x,e.y,n.x,n.y),rect:o}}}function v(t){if(J){var e=r({x:t.touches[0].clientX,y:t.touches[0].clientY}),n=r({x:t.touches[1].clientX,y:t.touches[1].clientY}),o=Atalasoft.Utils.CalcDistance(e.x,e.y,n.x,n.y,J.start),a=o.x-J.start.x,i=o.y-J.start.y,l=J.rect.x-o.dx,s=J.rect.y-o.dy,u=J.rect.width+a,c=J.rect.height+i;H.points?W.transform(l,s,u,c):(H.x=l,H.y=s,H.width=u,H.height=c),j.paper&&j.paper._page&&j.paper._page._grips&&j.paper._page._grips.repaint(),z()}}function y(){l("resized"),l("annoresized"),J=null}function _(){z()}function x(t){j=t.annview,q=t.textview,"path"===j.type&&"custom"!==H.type?"ellipse"!==H.type?(Y=c,G=D):(Y=d,G=P):(Y=d,G=k)}function b(){j.transform(X.toTransformString()),q&&q.repaint()}function w(){j.transform(A()),z()}function z(){G(),j&&j.transform(A()),q&&q.repaint()}function A(){var t=Raphael.matrix();return t.add(R.getViewerTransform(W._pageindex)),t.add(W.getTransform()),t.toTransformString()}function k(){j.attr({x:H.x,y:H.y,width:H.width,height:H.height}),N&&N.render(j,H),Atalasoft.Utils.Browser.Features.VML&&j.transform(A())}function P(){T(),j._&&0===j._.dirty&&(j._.dirty=1)}function D(){M(),j._&&0===j._.dirty&&(j._.dirty=1)}function T(){var t=H.width/2,e=H.height/2,n=Q*t,o=Q*e,a=H.x+H.width/2,i=H.y+H.height/2,r=["M",a,i-e,"C",a+n,i-e,a+t,i-o,a+t,i,"C",a+t,i+o,a+n,i+e,a,i+e,"C",a-n,i+e,a-t,i+o,a-t,i,"C",a-t,i-o,a-n,i-e,a,i-e,"Z"];j.attr({path:r})}function M(){for(var t=["M",H.points[0].x,H.points[0].y],e=1;e<H.points.length;e++)t=t.concat(["L",H.points[e].x,H.points[e].y]);"polygon"===H.type&&t.push("Z"),j.attr({path:t}),U()}/**
	* Work around outlined by this post:
	* http://stackoverflow.com/questions/15693178/svg-line-markers-not-updating-when-line-moves-in-ie10
	*/
function U(){if(Atalasoft.Utils.Browser.Explorer){var t=parseInt(Atalasoft.Utils.Browser.Version,10);t>=10&&12>t&&j.node&&j.node.parentNode&&j.node.parentNode.insertBefore(j.node,j.node)}}function E(){B.extend(H,O(X,R.getZoom(W._pageindex))),w(),K=null}function C(t,e,n,o){X=Raphael.matrix(n,0,0,o,t,e),K||(K=F(H,1)),X.add(K),b()}function S(t,e){return V(t,e.x,e.y)||V(t,e.x+e.width,e.y)||V(t,e.x,e.y+e.height)||V(t,e.x+e.width,e.y+e.height)}function V(t,e,n){return e>=t.x&&e<=t.x+t.width&&n>=t.y&&n<=t.y+t.height}function F(t,e){var n;if(t.points&&t.points.length>1){var o=W.getBox();n=Raphael.matrix(1,0,0,1,0,0),n.scale(1/o.width,1/o.height,0,0),n.translate(-o.x,-o.y)}else n=Raphael.matrix(e,0,0,e,0,0),n.translate(t.x,t.y),n.scale(t.width,t.height,0,0);return n}function O(t,e){var n=t.split(),o={x:n.dx/e,y:n.dy/e,width:n.scalex/e,height:n.scaley/e};return o}var B=Atalasoft.$,I=this,H=t,R=e,L=n,j=null,q=null,N=null,W=o,Z=null,$=null,X=null,J=null,Y=function(){},G=function(){};I.events={drawstart:s,drawmove:u,drawend:f,dragstart:p,dragmove:g,dragend:h,update:_,viewchanged:x,pinchstart:m,pinchmove:v,pinchend:y},a(),I.drawStart=s,I.repaint=z,I.getTransform=A;var Q=.5522847498307936;I.commitTransform=E,I.transformUI=C;var K=null},/**
* Mouse and Touch event handler for annotations
*/
Atalasoft.Annotations.PointerHandler=function(){function t(){return k.bind.apply(k,arguments),A}function e(){return k.unbind.apply(k,arguments),A}function n(){k.trigger.apply(k,arguments)}function o(){n({type:"interactstart"})}function a(){n({type:"interactend"})}function i(t){n(t)}function r(t){n(t);var e=Atalasoft.Utils.getMousePositionJquery(t);n({type:"showeditor",x:e.x,y:e.y})}function l(t){return o(),n(t),n({type:"selectchange",shiftKey:t.shiftKey,ctrlKey:t.ctrlKey}),3===t.which&&n({type:"contextmenu",x:t.pageX,y:t.pageY,event:t}),!1}function s(t){n(t)}function u(t){n(t)}function c(t){n(t)}function d(t){n(t),a()}function f(t){t.stopPropagation(),t.preventDefault(),P.pinching=!0,n({type:"pinchstart",touches:t.originalEvent.touches})}function p(t){t.stopPropagation(),t.preventDefault(),n({type:"pinchmove",touches:t.originalEvent.touches})}function g(t){t.stopPropagation(),t.preventDefault(),P.pinching=!1,n({type:"pinchend",touches:t.originalEvent.touches}),1===t.originalEvent.touches.length&&h(t)}function h(t){if(P.e=t,o(),n(t),2===t.originalEvent.touches.length&&w(t.originalEvent.touches))b(),P.touching=!1,f(t);else if(1===t.originalEvent.touches.length){n("selectchange"),P.touching=!0;var e=Atalasoft.Utils.getMousePositionJquery(t);P.point.x=e.x,P.point.y=e.y,P.hold=setTimeout(x,1500)}}function m(t){P.e=t,n(t),P.pinching?p(t):P.moves++}function v(t){P.e=t,n(t),P.pinching?g(t):P.touching&&(P.touching=!1,b(),P.moves>0?P.moves=0:P.tapped?_(t):(P.tapped=!0,setTimeout(y,300))),a()}function y(){P.tapped=!1}function _(t){P.e=t,n({type:"showeditor",x:P.point.x,y:P.point.y})}function x(){if(P.moves>0&&null!==P.e){var t=Atalasoft.Utils.getMousePositionJquery(P.e);Math.abs(P.point.x-t.x)<5&&Math.abs(P.point.y-t.y)<5&&(P.moves=0)}0===P.moves&&P.touching&&P.e&&(P.touching=!1,n({type:"contextmenu",x:P.e.originalEvent.touches[0].pageX,y:P.e.originalEvent.touches[0].pageY}))}function b(){null!==P.hold&&(clearTimeout(P.hold),P.hold=null)}function w(t){for(var e=null,n=0;n<t.length;n++){var o=t[n].target;if(!o||!o.raphael&&!o.raphaelParent)return!1;if(null===e)e=o;else if(e!==o)return!1}return!0}var z=Atalasoft.$,A=this,k=z({}),P={drawing:!1,hold:null,pinching:!1,tapped:!1,touching:!1,delta:{x:0,y:0},origin:{x:0,y:0},point:{x:0,y:0},moves:0,e:null};A.events={click:i,dblclick:r,mousedown:l,mousemove:s,mouseout:u,mouseover:c,mouseup:d},Atalasoft.Utils.Browser.Features.Touch&&z.extend(!0,A.events,{touchstart:h,touchmove:m,touchend:v}),A.bind=t,A.unbind=e,A.trigger=n},Atalasoft.Annotations.FontUI=function(t,e){function n(){a(t)}function o(){g=null,h=null,m=null}function a(t){t&&p.extend(m,t),r()}function i(t){return t?m[t]:m}function r(t,e,n){t=t?t:h,t&&(e=void 0!==e?e:v,n||s(),l(t,e))}function l(t,e){var n="none";(m.strike||m.underline)&&(n=m.strike?"line-through ":"",n+=m.underline?"underline":""),t.css({color:m.color,"font-family":m.family,"font-style":m.italic?"italic":"normal","font-weight":m.bold?"bold":"normal","font-size":m.size*(e||1)+"px","text-decoration":n})}function s(){var t=document.width||window.outerWidth,e=t/window.innerWidth;_!==e&&(_=e),v=m.size*y<x?x/_/m.size:y}function u(){return s(),v}function c(){return s(),_}function d(){return y}function f(t){y=t,r()}var p=Atalasoft.$,g=this,h=e,m={bold:!1,italic:!1,strike:!1,underline:!1,color:"#000000",family:"Arial",size:12},v=1,y=1,_=1,x=Atalasoft.Utils.Browser.Mobile.Any()?18:8;n(),g.dispose=o,g.set=a,g.get=i,g.repaint=r,g.applyTo=l,g.getAdjustedZoom=u,g.getUserZoom=c,g.getZoom=d,g.setZoom=f},Atalasoft.Annotations.AnnotationTextRenderer=function(t,e){function n(){o(),g=c("<canvas "+(m?'dir="rtl"':"")+"/>"),h=c('<span style="position:absolute; visibility:hidden; left: -5000px;">{[|,0123456789Thqkbfjplyg</span>'),c(document.body).append(h)}function o(){var t,e=document.body;e.currentStyle?t=e.currentStyle.direction:window.getComputedStyle&&(t=document.defaultView.getComputedStyle(e,null).getPropertyValue("direction")),"rtl"===t.toLowerCase()&&(m=!0)}function a(){d=null,f=null,p=null,g&&g.remove&&(g.remove(),g=null),h&&h.remove&&(h.remove(),h=null)}function i(t){g&&h||n(),p.applyTo(h),g[0].width=t.width,g[0].height=t.height;var e=g[0].getContext("2d"),o=[f.text.font.italic?"italic":"normal",f.text.font.bold?"bold":"normal",f.text.font.size+"px",f.text.font.family];e.font=o.join(" "),e.fillStyle=f.text.font.color,e.textAlign="start",e.textBaseline="top";for(var a=s(e,f.text.value,t.width),i=0,r=l(),u=e.measureText(f.text.value).width,c=m?t.width:0,d=0;d<a.length;d++)e.fillText(a[d],c,i,u),i+=r;return g[0].toDataURL()}function r(t,e){t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i(e))}function l(){return p.applyTo(h,1),h[0].offsetHeight}function s(t,e,n){var o=[],a=[];if("string"==typeof e){for(var i="\n",r=e,l=n,s=u(r),d="",f="",p=0;p<s.length;p++)if(d=f,f=s[p],t.measureText(f).width>l)for(var g=f.split(""),h=0;h<g.length;h++)a.push(g[h]),t.measureText(a.join("")).width>l&&(a.pop(),o.push(a.join("")),a.length=0,a.push(g[h]));else a.push(f),(t.measureText(c.trim(a.join(""))).width>l||d.indexOf(i)>=0)&&(a.pop(),o.push(a.join("")),a.length=0,a.push(f));a.length>0&&(o.push(a.join("")),a.length=0)}return o}function u(t){for(var e=[],n="",o=0,a=0;a<t.length;a++){var i=t[a];v[n]&&(e.push(t.substr(o,a-o)),o=a),n=i}return a>o&&e.push(t.substr(o,a-o)),e}var c=Atalasoft.$,d=this,f=t,p=e,g=null,h=null,m=!1,v={" ":!0,"-":!0,"?":!0,"\n":!0,"	":!0};d.dispose=a,d.renderToDataURL=i,d.renderToSVGImage=r},Atalasoft.Annotations.AnnotationCustomRenderer=function(t,e){function n(){h=g.constructor?g.constructor:u,m=g.renderer?g.renderer:c}function o(){p=null,g=null,h=null,m=null}function a(){return v.bind.apply(v,arguments),p}function i(){return v.unbind.apply(v,arguments),p}function r(){return v.trigger.apply(v,arguments),p}function l(t){return h(t,g)}function s(t){m(t,g)}function u(t){return t.image()}function c(t){g.customurl?t.attr("src",g.customurl):d()}function d(){r("serverrenderurlrequested",{data:g,complete:f})}function f(t){t.customurl=t}var p=this,g=t,h=null,m=null,v=e;return p.dispose=o,p.bind=a,p.unbind=i,p.trigger=r,p.construct=l,p.render=s,n(),p},Atalasoft.Annotations.PathHelper=function(t){function e(){m.points&&(m.points.length=0)}function n(){h=null,m=null,v.length=0,v=null}function o(t,e,n){v=v.concat([n?"m":"M",t,e]),g(t,e)}function a(t,e,n){v=v.concat([n?"l":"L",t,e]),g(t,e)}function i(t,e){v=v.concat([e?"h":"H",t]),g(t,null)}function r(t,e){v=v.concat([e?"v":"V",t]),g(null,t)}function l(t,e,n,o,a,i,r){v=v.concat([r?"c":"C",t,e,n,o,a,i]),g(a,i)}function s(t,e,n,o,a){v=v.concat([a?"s":"S",t,e,n,o])}function u(t,e,n,o,a){v=v.concat([a?"q":"Q",t,e,n,o])}function c(t,e,n){v=v.concat([n?"t":"T",t,e])}function d(t,e,n,o,a,i,r,l){v=v.concat([l?"a":"A",t,e,n,o,a,i,r])}function f(){v.push("Z")}function p(){return v}function g(t,e){m.points.push({x:t,y:e})}var h=this,m=t,v=[];return h.dispose=n,h.moveTo=o,h.lineTo=a,h.lineToHorizontal=i,h.lineToVertical=r,h.curveTo=l,h.curveToSmooth=s,h.curveToQuadratic=u,h.curveToQuadraticSmooth=c,h.ellipticalArc=d,h.close=f,h.toArray=p,e(),h},Atalasoft.Forms.Field=function(t,e,n){function o(){Atalasoft.Forms.Field.__staticInitOccured||(Atalasoft.Forms.Field.__staticInitOccured=!0,Atalasoft.Utils.Browser.Explorer&&Atalasoft.Utils.Browser.Version<=9&&!function(){var t=null,e=null,n=null,o={get:function(){return n.get.call(this)},set:function(t){e=t,n.set.call(this,t)}},a=function(n){if("value"===n.propertyName){var o=n.srcElement.value;o!==e&&(e=o,null!=I(n.srcElement).data("ataladata")&&I(t).trigger("input"))}},i=function(i){t=i,e=i.value,n=Object.getOwnPropertyDescriptor(i.constructor.prototype,"value"),Object.defineProperty(t,"value",o),t.attachEvent("onpropertychange",a)},r=function(){t&&(delete t.value,t.detachEvent("onpropertychange",a),t=null,e=null,n=null)};I(document).on("focusin",function(t){("TEXTAREA"===t.target.nodeName||"INPUT"===t.target.nodeName&&("text"===t.target.type||"password"===t.target.type))&&(r(),i(t.target))}),I(document).on("focusout",function(){r()}),I(document).on("selectionchange keyup keydown",function(n){t&&t.value!==e&&(e=t.value,null!=I(n.srcElement).data("ataladata")&&I(t).trigger("input"))})}())}function a(){R._pageindex=n,i(t.type),c(t,!0)}function i(t){I.extend(!0,Z,$[t])}function r(){L&&L.unbind(),H=null,R=null,L=null,Z=null}function l(){L.bind.apply(L,arguments)}function s(){L.unbind.apply(L,arguments)}function u(){return L.trigger.apply(L,arguments),R}function c(t,e){t&&(e?I.extend(!0,Z,t):I.extend(Z,t))}function d(t){return t?Z[t]:Z}function f(t){W=t,R.hasOwnProperty("_pageindex")&&(R._pageindex=t)}function p(){function t(){delete Z.update}N={update:function(){I.extend(!0,Z,N),t(),U(),M(),w()}},I.extend(!0,N,Z)}function g(){return N?I.extend(!0,N,Z):p(),N}function h(){return q}function m(){return L}function v(){return JSON.stringify(Z)}function y(t){var e,n,o,a,i,r=0,l=0;return"number"==typeof t.selectionStart&&"number"==typeof t.selectionEnd?(r=t.selectionStart,l=t.selectionEnd):(n=document.selection.createRange(),n&&n.parentElement()===t&&(a=t.value.length,e=t.value.replace(/\r\n/g,"\n"),o=t.createTextRange(),o.moveToBookmark(n.getBookmark()),i=t.createTextRange(),i.collapse(!1),o.compareEndPoints("StartToEnd",i)>-1?r=l=a:(r=-o.moveStart("character",-a),r+=e.slice(0,r).split("\n").length-1,o.compareEndPoints("EndToEnd",i)>-1?l=a:(l=-o.moveEnd("character",-a),l+=e.slice(0,l).split("\n").length-1)))),{start:r,end:l}}function _(t,e){return e-(t.value.slice(0,e).split("\r\n").length-1)}function x(t,e){if("number"==typeof t.selectionStart&&"number"==typeof t.selectionEnd)t.selectionStart=e.start,t.selectionEnd=e.end;else{var n=t.createTextRange(),o=_(t,e.start);n.collapse(!0),e.start===e.end?n.move("character",o):(n.moveEnd("character",_(t,e.end)),n.moveStart("character",o)),n.select()}}function b(t){var e=null;switch(Z.type){case"button":e=I("<button/>"),e.click(function(){return u({type:"buttonclicked",name:Z.fieldname}),!1});break;case"textbox":case"signature":e=Z.text.multiline?I('<textarea style="overflow-y:'+(Z.text.scrollable?"auto":"hidden")+';resize:none"></textarea>'):I('<input type="text" />'),Z.text.value=e.val(Z.text.value).val();var n=!1;e.on("paste",function(){return n=!0,!0}),e.on("input",function(t){-1===Z.text.maximumfieldheight&&(Z.text.maximumfieldheight=I(this).get(0).clientHeight);var e=Z.text.maxlength>0&&I(this).val().length>Z.text.maxlength,o=!Z.text.scrollable&&I(this).get(0).scrollHeight>Z.text.maximumfieldheight,a=I(this).val().length>Z.text.value.length;if(a&&(e||o)){var i=y(t.target);if(n&&Z.text.maxlength>0){var r=I(this).val(),l=r.length===i.start;if(l)I(this).val(r.substr(0,Z.text.maxlength));else{var s=r.length-Z.text.value.length,u=Z.text.maxlength-Z.text.value.length,c=r.substr(0,i.start-s+u),d=Z.text.value.substr(i.start-s);I(this).val(c+d),x(t.target,{start:c.length,end:c.length})}}else I(this).val(Z.text.value),x(t.target,{start:i.start-1,end:i.start-1})}!Z.text.preserveoverflow&&I(this).get(0).scrollHeight<Z.text.maximumfieldheight&&(Z.text.maximumfieldheight=I(this).get(0).scrollHeight),Z.text.value=I(this).val(),n=!1});break;case"checkbox":e=I('<input type="checkbox" />').prop({name:Z.group,checked:Z.checked}),e.val(Z.value);break;case"radio":e=I('<input type="radio" />').prop({name:Z.group,checked:Z.checked}),e.val(Z.value);break;case"choice":if(e=I("<select></select>"),e.text(Z.value),e.attr({multiple:Z.multiple,size:Z.multiline&&Z.items?Z.items.length:0}),Z.items){e.items=[];for(var o in Z.items)if(Z.items.hasOwnProperty(o)){var a=I("<option></option>",{selected:Z.items[o].checked,value:Z.items[o].value,text:Z.items[o].text});e.append(a),e.items[o]=a}}if(Z.multiline&&Z.items){var i=function(){I(this).trigger("change")};e.bind({mouseup:i,touchend:i})}break;case"generic":e=I("<div></div>")}if(e){if("textbox"===Z.type||"signature"===Z.type){var r=Z.text.font.paddingtop,l=Z.text.font.linespacing>0?Z.text.font.linespacing+"px":"1.14pt";e.css({resize:"none",position:"absolute",paddingTop:Z.multiline?r:0,paddingBottom:Z.multiline?"2pt":0,lineHeight:l,margin:0,"-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"})}else e.css({resize:"none",position:"absolute",padding:0,margin:0,"-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"});e.bind({click:Atalasoft.Utils.__sp,mousedown:Atalasoft.Utils.__sp,mouseup:Atalasoft.Utils.__sp,change:k,uncheck:P,focusin:D,focusout:T})}return t._fields&&t._fields.push(e),Atalasoft.Utils.Browser.Explorer&&Atalasoft.Utils.Browser.Version<=9&&e.data("ataladata",{}),t.append(e),e}function w(){null!==j&&(Z.selectable?(X.isBound("selectable")||(L.bind(X.selectable),X.bound("selectable")),Z.movable&&!X.isBound("movable")?(L.bind(X.movable),X.bound("movable")):!Z.movable&&X.isBound("movable")&&(L.unbind(X.movable),X.unbound("movable")),Atalasoft.Utils.Browser.Features.Touch&&(Z.resizable&&!X.isBound("resizable")?(L.bind(X.resizable),X.bound("resizable")):!Z.resizable&&X.isBound("resizable")&&(L.unbind(X.resizable),X.unbound("resizable")))):!Z.selectable&&X.isBound("selectable")&&(L.unbind(X.selectable),X.unbound("selectable"),L.unbind(X.movable),X.unbound("movable"),L.unbind(X.resizable),X.unbound("resizable")))}function z(){var t=Z.fieldname.lastIndexOf(".");return t>=0?Z.fieldname.substr(0,t):null}function A(){var t=Z.fieldname.lastIndexOf(".");return t>=0?Z.fieldname.substr(t+1):Z.fieldname}function k(t){switch(Z.type){case"button":break;case"textbox":case"signature":Z.text.value=this.value;var e=z(Z);if(H.multiviewFields.hasOwnProperty(e)){var n=H.multiviewFields[e];for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];if(a!==R){var i=a.get();i.text.value=this.value,a.updateView()}}}break;case"checkbox":Z.checked=this.checked,Z.group&&Z.checked&&(I('input[name="'+Z.group+'"]').trigger("uncheck"),Z.checked=!0,this.checked=!0);break;case"radio":Z.group&&I('input[name="'+Z.group+'"]').trigger("uncheck"),Z.checked=this.checked;break;case"choice":var r=[];if("undefined"!=typeof t.target.selectedOptions)r=t.target.selectedOptions;else if(t.target.multiple)for(var l=0;l<t.target.options.length;l++)t.target.options[l].selected&&r.push(t.target.options[l]);else t.target.selectedIndex>=0&&r.push(t.target.options[t.target.selectedIndex]);for(var s in Z.items)if(Z.items.hasOwnProperty(s)){var u=Z.items[s];u.checked=!1;for(var c in r)if(r.hasOwnProperty(c)){var d=r[c];d.value===u.value&&(u.checked=!0)}}}}function P(t){"checkbox"===t.target.type&&(t.target.checked=!1),Z.checked=!1}function D(){S(!0),u({type:"fieldfocusin",field:R})}function T(){S(!1),u({type:"fieldfocusout",field:R})}function M(t){t&&(q=b(t),q.zoom=O,U(),u({type:"viewchanged",fieldview:q})),u("repaint")}function U(){if(q){if(Z.hidden||Z.noview)return q.hide(),void 0;q.show();var t=I.extend({},C(),E());q.css(t),V(),F(),"textbox"===Z.type?S(q.is(":focus")):"button"===Z.type&&q.text(Z.text.value)}}function E(){var t=Z.border&&"underline"===Z.border.style;return{backgroundColor:Z.backgroundcolor,color:Z.color||Z.text.font.color,borderStyle:Z.border&&Z.border.style&&!t?Z.border.style:"none",borderBottomStyle:t?"solid":"inherit",borderColor:Z.border?Z.border.color:null,fontFamily:Z.text.font.family,fontStyle:Z.text.font.italic?"italic":Z.text.font.oblique?"oblique":"normal",fontWeight:Z.text.font.bold?"bold":"",textAlign:Z.text.align}}function C(){var t=H.getViewerTransform(W),e=B(t,Z.x,Z.y),n=B(t,Z.x+Z.width,Z.y+Z.height),o=H.getZoom(W),a=Z.width*o,i=Z.height*o,r={x:(e.x+n.x-a)/2,y:(e.y+n.y-i)/2},l=H.getPageRotation(W)+Z.rotation,s="rotate("+l+"deg)",u={left:Math.round(r.x)+"px",top:Math.round(r.y)+"px",width:a+"px",height:i+"px","max-width":a+"px","max-height":i+"px"},c=0!==l?Atalasoft.Utils.__htmlTransformStyle(s):Atalasoft.Utils.__htmlTransformStyle("");return I.extend(u,c),("textbox"===Z.type||"signature"===Z.type)&&(u.cursor=l%180===0?"text":"vertical-text"),u.visibility=Atalasoft.Utils.Browser.Explorer8&&l%180!==0?"hidden":"visible",u}function S(t){"textbox"===Z.type&&(t||(Z.text.value?q.val()!==Z.text.value&&q.val(Z.text.value):q.val(Z.text.defaultvalue)))}function V(){H.highlighted?(q.addClass("atala-ui-form-highlight"),Z.required?q.addClass("atala-ui-form-required"):q.removeClass("atala-ui-form-required")):q.removeClass("atala-ui-form-highlight")}function F(){Z.readonly?q.attr("readonly","readonly"):q.removeAttr("readonly")}function O(t){t=t||H.getZoom(W),q.css({fontSize:Math.round((Z.text.font.size||12)*t*(H.dpi/96)),borderWidth:Z.border?Math.round(Z.border.width*t):0}),Z.text&&Z.text.align&&q.css({paddingLeft:Z.text.leftPadding*t+"px",paddingRight:Z.text.rightPadding*t+"px"}),U()}function B(t,e,n){return{x:t.x(e,n),y:t.y(e,n)}}var I=Atalasoft.$,H=e,R=this,L=I({}),j=null,q=null,N=null,W=n,Z={type:"",backgroundcolor:"",color:null,fieldname:"",hidden:!1,isfieldrequired:!1,items:null,locked:!1,norotate:!1,noview:!1,nozoom:!1,readonly:!1,required:!1,x:0,y:0,width:0,height:0,rotation:0,border:{color:"#000",style:"none",radius:{vertical:0,horizontal:0},width:0},text:{value:null,align:"left",font:{bold:!1,italic:!1,strike:!1,underline:!1,color:"black",family:"Arial",size:12,paddingtop:0,linespacing:0},ismultiline:!1,ispassword:!1,isrichtext:!1,scrollable:!1,maxlength:0,maximumfieldheight:-1,preserveoverflow:!1}},$={button:{},checkbox:{checked:!1,group:null},radio:{checked:!1,group:null},textbox:{text:{leftPadding:2,rightPadding:2,preserveoverflow:!1}},signature:{text:{leftPadding:2,rightPadding:2,preserveoverflow:!1}},choice:{multiline:!1}},X={};return o(),a(),R.dispose=r,R.bind=l,R.unbind=s,R.trigger=u,R.set=c,R.get=d,R.setPageIndex=f,R.getClonedData=g,R.getObject=h,R.getEventObject=m,R.getZoom=function(){return H.zoom},R.stringify=v,R.getJSON=v,R.getParentName=z,R.getName=A,R.repaint=M,R.updateView=U,R.zoom=O,R},Atalasoft.Forms.Field.__staticInitOccured=!1,Atalasoft.Forms.FormController=function(t,e,n){function o(){oe.bind({pagerecycled:v,pageshown:h,zoomchanged:l,pagerotated:b}),ae._state.initialized?a():oe.bind({initialized:a})}function a(){le=!0}function i(){ne=null,oe=null,ae=null,re=null,se=null,ue.fields.length=0,ue.multiviewFields=null,ue.activepage=null,ue.activefield=null}function r(){"Atalasoft.Controls.WebDocumentViewer"===oe.typeOf&&ee.extend(oe,ie)}function l(){}function s(t){if(t instanceof jQuery){if(t._form=ae.createDiv(t),t._form.css({position:"absolute",zIndex:10}),t._form._fields=[],!t._draw){if(t._draw=ee('<div style="width:100%; height:100%; position:absolute; left: 0px; top: 0px; background: #F00; opacity:0.0;"></div>'),Atalasoft.Utils.Browser.Explorer)if(parseInt(Atalasoft.Utils.Browser.Version,10)<=8)t._draw.css({filter:"alpha(opacity=0)"});else if(10===parseInt(Atalasoft.Utils.Browser.Version,10)){var e=!1;t._draw.reflow=function(){if(e)t._draw.empty();else{var n=ee("<hr/>");t._draw.append(n)}e=!e}}t.prepend(t._draw)}t._form._page=t;var n=function(){_(t)};return t.bind("mousedown",n),Atalasoft.Utils.Browser.Features.Touch&&t.bind("touchstart",n),t.bind({pageresize:function(e){e.page=t,y(e)},pagezoom:function(e){e.page=t,x(e)}}),!0}return!1}function u(t,e,n){if(null==t&&"number"==typeof e&&(e=c(e)),e=e||[],null==n?n=ue.fields.length:0>n&&(n=0),n>ue.fields.length){var o=ue.fields.length;ue.fields[n]=e;for(var a=o;a<ue.fields.length;++a)ue.fields[a]||(ue.fields[a]=[])}else ue.fields.splice(n,0,e)}function c(t){return t<ue.fields.length?ue.fields.splice(t,1)[0]:null}function d(t,e){u(null,c(t),e)}function f(t){return t instanceof jQuery?(t._form&&(t._form._fields=null,t._form._page=null,t._form=null),!0):!1}function p(t,e){if(t<ue.fields.length&&ue.fields[t]&&ue.fields[t].length){var n;g(e);for(var o=0;o<ue.fields[t].length;o++)n=ue.fields[t][o],n.setPageIndex(t),n.repaint(e._form)}}function g(t){t._form&&t._form._fields&&(t._form._fields.length=0,t._form.empty())}function h(t){p(t.index,t.page)}function m(){null!=pe.field&&pe.field.getObject()[0].blur()}function v(t){t.page._form&&g(t.page)}function y(t){w(t.page)}function _(t){ue.activepage=t}function x(t){for(var e in t.page._form._fields)t.page._form._fields.hasOwnProperty(e)&&t.page._form._fields[e].zoom(ae.getPageScale(t.index))}function b(t){w(t.page)}function w(t){if(t&&ue.fields.length&&ue.fields[t._index])for(var e=0;e<ue.fields[t._index].length;e++)ue.fields[t._index][e].updateView()}/**
	* Creates a field on the desired page with the given field data.
	* @param fConfig: object, Key value pairs representing field data.
	* @param pgNum: number, The zero based index of the page the field should be created on.
	* @param callback: function, Function to be called when the operation has completed.
	* @returns object, Key value pairs representing field data.
	*/
function z(t,e,n){var o=C(t,e,n).getClonedData();return oe.trigger({type:ge.fieldcreate,field:o}),o}/**
	* Deletes a field on the given z-index and zero based page index.
	* @param pgNum: number, Zero based page index the field is located on.
	* @param fieldIndex: number, Zero based z-index of the field.
	*/
function A(t,e){S(e,t)}/**
	* Gets an array of field data objects located on the given zero based page index.
	* @param pageNum: number, Zero based page index the fields are located on.
	* @returns array: Array of field data objects on the given page index. 
	*/
function k(t){var e=[];if(0===ue.fields.length||"undefined"==typeof ue.fields[t])return e;for(var n=0;n<ue.fields[t].length;n++)e[n]=ue.fields[t][n].getClonedData();return e}/**
	* Inserts a form from the source URL and index into the given page index.
	* @param sourceUrl: string, Url of the desired form.
	* @param sourceIndex: number, Zero based page index the form is copied from.
	* @param index: number, Zero based page index the form is to be inserted into.
	* @param callback: function, Function to be called when the operation has completed.
	*/
function P(t,e,n,o){u(t,e,n),"function"==typeof o&&o(),oe.trigger({type:ge.forminserted,srcurl:t,srcindex:e,index:n}),oe.trigger(ge.formschanged)}/**
	* Removes a form from the given page index.
	* @param index: number, Zero based page index of the form to be removed.
	* @param callback: function, Function to be called when the operation has completed.
	*/
function D(t,e){c(t),"function"==typeof e&&e(),oe.trigger({type:ge.formremoved,index:t}),oe.trigger(ge.formschanged)}/**
	* Moves a form from one page index to another.
	* @param sourceIndex: number, Zero based page index of the form to be moved.
	* @param destIndex: number, Destination zero based page index.
	* @param callback: function, Function to be called when the operation has completed.
	*/
function T(t,e,n){d(t,e),"function"==typeof n&&n(),oe.trigger({type:ge.formmoved,srcindex:t,destindex:e}),oe.trigger(ge.formschanged)}function M(){var t={};return ee.extend(!0,t,{data:ue,pages:re,viewport:se}),t}function U(t){t&&(null===t._fields?t._fields=ue.fields:ee.isArray(t._fields)&&(ue.fields=t._fields))}function E(){if(ue.fields.length>0){if(ue.fields.length=0,re)for(var t=0;t<re.length;t++)g(re[t]);oe.trigger({type:"formscleared"})}}function C(t,e,n){var o={};t&&t.type&&ce[t.type]&&ee.extend(!0,o,ce[t.type]),ee.extend(!0,o,t);var a=new Atalasoft.Forms.Field(o,ue,e);return"undefined"==typeof ue.fields[e]&&(ue.fields[e]=[]),ue.fields[e].push(a),ae.redrawVisiblePages(),"function"==typeof n&&n(a),X(a),a}function S(t,e){var n=ue.fields[e].splice(t,1)[0];ue.activepage&&ue.activepage._form._fields.splice(t,1),n.dispose(),oe.trigger({type:"fielddeleted",page:e,index:t})}function V(t){t&&(t instanceof jQuery||(t=ee(t)),se=t)}function F(t,e,n){return de?null:(t&&t.type&&ce[t.type]&&ee.extend(!0,t,ce[t.type]),ue.activefield&&null===ue.activefield.getObject()&&j(),I(),ue.activefield=new Atalasoft.Forms.Field(t,ue,ue.activepage?ue.activepage._index:void 0),ue.activefield.bind({drawn:L,cancelled:j}),"function"==typeof e&&(O=e),"function"==typeof n&&(B=n),ue.activefield)}function O(){}function B(){}function I(){if(!fe){se.bind("mousedown",R),Atalasoft.Utils.Browser.Features.Touch&&se.bind("touchstart",R);for(var t=0;t<re.length;t++)re[t]._draw.css({"z-index":"10"}),N(t);fe=!0}}function H(){if(fe){se.unbind("mousedown",R),Atalasoft.Utils.Browser.Features.Touch&&se.unbind("touchstart",R);for(var t=0;t<re.length;t++)re[t]._draw.css({"z-index":""}),N(t);fe=!1}}function R(t){de=!0,se.unbind("mousedown",R),Atalasoft.Utils.Browser.Features.Touch&&se.unbind("touchstart",R),oe.trigger({type:"fielddrawstart",field:ue.activefield.getClonedData()}),ue.activefield._pageindex=ue.activepage._index,ue.activefield.startDraw(t,ue.activepage._form,{}),Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)<8&&ue.activepage._draw.height(ue.activepage.height())}function L(){$(ue.activefield),q(),Atalasoft.Utils.Browser.Explorer&&parseInt(Atalasoft.Utils.Browser.Version,10)<8&&ue.activepage._draw.height("100%")}function j(){ue.activefield.dispose(),ue.activefield=null,de&&q(!0)}function q(t){de=!1,H(),oe.trigger({type:"fielddrawend",field:t?null:ue.activefield.getClonedData(),cancelled:t?!0:!1})}function N(t){re[t]._draw.reflow&&re[t]._draw.reflow()}function W(t){pe=t,oe.bind("scroll",m)}function Z(){oe.unbind("scroll",m)}function $(t){var e=ue.activepage,n=e?e._index:0;ue.fields[n]?ue.fields[n].push(t):ue.fields[n]=[t],ue.activefield.unbind({}),X(ue.activefield),O({field:t}),O=function(){},oe.trigger({type:ge.fieldcreate,field:t.getClonedData()})}function X(t){function e(e){oe.trigger({type:ge[e.type],field:t.getClonedData()})}t.bind({interactstart:function(){ue.activepage&&ue.activepage._form===t.getObject().form||_(t.getObject().form._page),ue.activefield=t},moved:e,resized:e,interactend:e,touchstart:e,touchmove:e,pinchmove:e,click:e,dblclick:e,rightclick:e,mousedown:e,mousedownleft:e,mousedownright:e,mousemove:e,mouseout:e,mouseup:e,mouseover:e,repaint:e,fieldfocusin:W,fieldfocusout:Z})}function J(){var t={},e=!1;for(var n in ue.fields)if(ue.fields.hasOwnProperty(n)){t[n]=[];for(var o in ue.fields[n])ue.fields[n].hasOwnProperty(o)&&(e=!0,t[n][o]=ue.fields[n][o].get())}return e?JSON.stringify({forms:{fields:t}}):void 0}function Y(t){var e=t.getParentName(),n=t.getName();n.indexOf("<~Atala_Unnamed_")>=0&&(ue.multiviewFields.hasOwnProperty(e)?ue.multiviewFields[e].push(t):ue.multiviewFields[e]=[t])}function G(t,e){var n={type:"formdata",serverurl:t,query:"?atalaformdata=",method:"GET",data:{atala_formurl:e},cancel:!1,info:{fields:[],error:void 0}};return n}function Q(t,e){function n(t){te(t),"function"==typeof e&&e.call()}E(),ae.makeHandlerRequest(t,n,n)}function K(t,e,n){var o=G(t,e);Q(o,n)}function te(t){if(t){var e={type:"formsloaded"};if(t.dpi&&(ue.dpi=t.dpi),t.forms&&t.forms.fields){for(var n in t.forms.fields)if(t.forms.fields.hasOwnProperty(n)){n=parseInt(n,10);var o=isFinite(t.offset)?t.offset+n:n;ue.fields[o]&&ue.fields[o].length>0?ue.fields[o].length=0:ue.fields[o]=[];var a=t.forms.fields[n];if(a&&a.length>0)for(var i=0;i<a.length;i++)ue.fields[o][i]=new Atalasoft.Forms.Field(a[i],ue,o),Y(ue.fields[o][i]),oe.trigger({type:ge.load,field:ue.fields[o][i].getClonedData()}),X(ue.fields[o][i])}}else t.error&&(e.error=t.error);oe.trigger(e)}}var ee=Atalasoft.$,ne=this,oe=t,ae=e,ie={forms:{events:{/** Triggers when the user uses the mouse to click on a field. Populated keys: e.field */
fieldclicked:null,/** Triggers when the user uses the mouse to create a field. Populated keys: e.field */
fieldcreated:null,/** Triggers when the user uses the mouse to double-click on a field. Populated keys: e.field */
fielddoubleclicked:null,/** Triggers when a field is loaded into the document. Populated keys: e.field */
fieldloaded:null,/** Triggers when the user has depressed a mouse button on a field. Populated keys: e.field */
fieldmousedown:null,/** Triggers when the user has depressed the left mouse button on a field. Populated keys: e.field */
fieldmousedownleft:null,/** Triggers when the user has depressed the right mouse button on a field. Populated keys: e.field */
fieldmousedownright:null,/** Triggers when the user moves the mouse pointer over a field. Populated keys: e.field */
fieldmousemove:null,/** Triggers when the user has moved the mouse pointer out of the bounds of the field. Populated keys: e.field */
fieldmouseout:null,/** Triggers when the user has moved the mouse pointer into the bounds of the field. Populated keys: e.field */
fieldmouseover:null,/** Triggers when the user has released a mouse button on a field. Populated keys: e.field */
fieldmouseup:null,/** Triggers when a field has been moved. Populated keys: e.field */
fieldmoved:null,/** Triggers when a pinch gesture has been detected on a field. Populated keys: e.field */
fieldpinchresize:null,/** Triggers when a field has been repainted. Populated keys: e.field */
fieldrepainted:null,/** Triggers when a field has been resized. Populated keys: e.field */
fieldresized:null,/** Triggers when the user right clicks on a field. Populated keys: e.field */
fieldrightclicked:null,/** Triggers when a touch end event has finished on a field. Populated keys: e.field */
fieldtouchend:null,/** Triggers when a touch move event is happening on a field. Populated keys: e.field */
fieldtouchmove:null,/** Triggers when a touch event has started on a field. Populated keys: e.field */
fieldtouchstart:null},createOnPage:z,deleteFromPage:A,getFromPage:k,insertForm:P,moveForm:T,removeForm:D}};if(Atalasoft.Forms.FormController.__exposedApi=ie.forms,!t)return null;var re=e._pages,le=!1,se=null,ue={fields:[],multiviewFields:{},activepage:null,activefield:null,highlighted:!0,readonly:n?!0:!1,getZoom:ae.getPageScale,getViewerTransform:ae.getViewerTransform,getPageRotation:ae.getPageRotation,dpi:96},ce={},de=!1,fe=!1,pe=null,ge={click:"fieldclicked",dblclick:"fielddoubleclicked",touchstart:"fieldtouchstart",interactend:"fieldtouchend",touchmove:"fieldtouchmove",pinchmove:"fieldpinchresize",rightclick:"fieldrightclicked",mousedown:"fieldmousedown",mousedownleft:"fieldmousedownleft",mousedownright:"fieldmousedownright",mousemove:"fieldmousemove",mouseout:"fieldmouseout",mouseup:"fieldmouseup",mouseover:"fieldmouseover",create:"fieldcreated",load:"fieldloaded",moved:"fieldmoved",resized:"fieldresized",repaint:"fieldrepainted"};ne.dispose=i,ne.addFormLayer=s,ne.insertForm=u,ne.removeForm=c,ne.moveForm=d,ne.removeFormLayer=f,ne.showLayer=p,ne.__getDebugInfo=M,ne.__linkForms=U,ne.clear=E,ne.createField=C,ne.deleteFieldOnPage=A,ne.getFieldsFromPage=k,ne.setViewPort=V,ne.drawField=F,ne.stringifyChanges=J,ne.createHandlerRequest=G,ne.makeHandlerRequest=Q,ne.loadFormUrl=K,ne.loadForms=te,r(),o()},Atalasoft.Annotations.TextAnnotationUI=function(t,e,n){function o(){a(),m(),t.bind(F)}function a(){if(null==T&&(T=new Atalasoft.Annotations.FontUI(U.font)),M){var n=M.removed!==!0?M:null;k.unbind(n,{showeditor:u,hideeditor:p})}var o=E;M=e.html(),M.isHtml||(M.renderer=new Atalasoft.Annotations.AnnotationTextRenderer(t.get(),T),v=y),null!=P&&e._page&&(e._page.append(P),e._page.bind(V)),Raphael.vml&&(t.getObject().node.style.overflow="hidden"),M.transform(_().toTransformString(!0)),k.bind(M,{showeditor:u,hideeditor:p}),o&&u()}function i(){P&&P.remove(),D&&D.remove(),T&&T.dispose(),M&&M.remove(),e&&e._page&&e._page.unbind(V),t.unbind(F),z=null,k=null,P=null,T=null,D=null,M=null,U=null}function r(t){t&&w.extend(U,t)}function l(t){return t?U[t]:U}function s(){return T}function u(){P||d(),f()}function c(e){e.stopPropagation(),U.value!==P.val()&&(U.value=P.val(),t.set({text:U}))}function d(){P=w("<textarea/>").hide(),e._page&&(e._page.append(P),e._page.bind(V)),P.bind("change keydown mouseup mousemove mousedown",c),P.bind({blur:p}),t.bind({deselected:p});var n=t.getObject();if(P.css({position:"absolute","overflow-x":"auto","overflow-y":"auto","z-index":99999,border:"0px solid",padding:"0px","background-color":"transparent"}),Atalasoft.Utils.Browser.Mobile.Any()){var o=t.get(),a=Atalasoft.Utils.getSVGOffset(e.canvas,e._page);P.css({left:o.x+a.left+"px",top:o.y+a.top+"px",width:o.width+"px","max-width":o.width+"px",height:o.height+"px","max-height":o.height+"px",border:n.attr("stroke")+" "+n.attr("strokewidth")+"px","background-color":n.attr("fill")})}T.setZoom(t.getZoom()),(Atalasoft.Utils.Browser.Chrome||Atalasoft.Utils.Browser.Safari)&&P.css({resize:"none"}),null!=U.value&&P.val(U.value),U.readonly&&P.prop("readonly","readonly"),T.repaint(P)}function f(){var e=t?t.get("visible"):!0;e&&((P.is(":hidden")||!E)&&(M.hide(),P.prop("readonly",U.readonly?"readonly":""),P.show(),m()),Atalasoft.Utils.Browser.Touch&&P.focus(function(){P[0].setSelectionRange(0,9999)}),Atalasoft.Utils.Browser.Explorer&&7===parseInt(Atalasoft.Utils.Browser.Version,10)||P[0].focus(),E=!0)}function p(){P&&((P.is(":visible")||E)&&(P.hide(),M.show(),m()),P[0].blur(),E=!1)}function g(){var e=t?t.get("visible"):!0;e?E?u():M.show():M.hide(),M.backgroundColor&&M.backgroundColor(t.get("fill").color)}function h(t){t&&(e!==t||M.removed)&&(e=t,null!=D&&(D.remove(),D=null),a(),g())}function m(n){if(h(n),v(),P&&(!P.is(":hidden")||E)){var o=t.get("outline").width/2,a=t.get(),i=t.getZoom(),r=t.getBox(),l=_(),s=b(l,r.x,r.y),u=b(l,r.x+r.width,r.y+r.height),c=r.width*i,d=r.height*i,f={x:(s.x+u.x-c)/2,y:(s.y+u.y-d)/2},p=C*i,g=o*i,m=2*(p+g),y=Math.max(Math.ceil(c-m),S.width),x=Math.max(Math.ceil(d-m),S.height),z=Atalasoft.Utils.getSVGOffset(e.canvas,e._page),k=a.rotation+A.getPageRotation(t._pageindex),D=0!==k?"rotate("+k+"deg)":"",M={left:Math.round(f.x+z.left+g)+"px",top:Math.round(f.y+z.top+g)+"px",width:y+"px",height:x+"px","max-width":y+"px","max-height":x+"px",padding:Math.ceil(p)+"px"};if(w.extend(M,Atalasoft.Utils.__htmlTransformStyle(D)),Atalasoft.Utils.Browser.Explorer8){var V=t.getObject(),F=V.attr("strokewidth")||1;P.css({border:"solid "+F+"px "+V.attr("stroke"),"background-color":V.attr("fill")})}P.css(M)}T&&(T.set(U.font),T.setZoom(t.getZoom()),T.repaint(P))}function v(){var e=t.get();D||(D=w('<textarea selectable="false"/>'),w(M.innerDom).append(D),D.css({"background-color":"transparent",border:"0px solid","overflow-x":"hidden","overflow-y":"hidden","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","user-select":"none",resize:"none",cursor:"inherit"}),D.attr("readonly","readonly"),D.bind({focus:function(){return this.blur(),!1}}),D[0].raphaelParent=!0),D.val(U.value);var n=t.get("outline").width/2,o=Math.max(Math.ceil(e.width-2*(n+C)),1),a=Math.max(Math.ceil(e.height-2*(n+C)),1);T&&(T.set(U.font),T.repaint(D,1,!0)),D.css({width:o+"px",height:a+"px","max-width":o+"px","max-height":a+"px",padding:C+"px"}),M.attr({x:Math.round(n+e.x),y:Math.round(n+e.y),width:e.width,height:e.height}),M.transform(_().toTransformString(!0))}function y(){var e=t.get("outline").width/2,n=t.get(),o=Math.ceil(n.width-2*(e+C)),a=Math.ceil(n.height-2*(e+C));T&&T.set(U.font),M.attr({x:Math.round(e+C+n.x),y:Math.round(e+C+n.y),width:o,height:a}),M.renderer&&M.renderer.renderToSVGImage(M[0],{width:o,height:a}),M.transform(_().toTransformString(!0))}function _(){var e=Raphael.matrix();return e.add(A.getViewerTransform(t._pageindex)),e.add(t.getTransform()),e}function x(){M&&m()}function b(t,e,n){return{x:t.x(e,n),y:t.y(e,n)}}var w=Atalasoft.$,z=this,A=n,k=t.getEventObject(),P=null,D=null,T=null,M=null,U=t.get("text"),E=!1,C=3,S=Atalasoft.Utils.Browser.Mobile.Any()?{width:200,height:200}:{width:1,height:1},V={},F={moving:x,resized:x,moved:x,rotated:x};o(),z.dispose=i,z.set=r,z.get=l,z.getFont=s,z.updateView=g,z.changepaper=h,z.repaint=m},Atalasoft.Utils.getMousePosition=function(t,e,n){return e||(e={x:0,y:0}),Atalasoft.Utils.Browser.Explorer?(null==t&&(t=event),"CSS1Compat"===document.compatMode?(e.x=t.x+document.documentElement.scrollLeft,e.y=t.y+document.documentElement.scrollTop):(e.x=t.x+document.body.scrollLeft,e.y=t.y+document.body.scrollTop)):(e.x=t.pageX,e.y=t.pageY),n&&(e.x-=n.offsetLeft,e.y-=n.offsetTop),e},Atalasoft.Utils.getMousePositionJquery=function(t,e,n){e||(e={x:0,y:0});var o=Atalasoft.Utils.Browser.Explorer&&Atalasoft.Utils.Browser.Version<=9;if(!t.offsetX&&!t.offsetY||o)if(Atalasoft.Utils.Browser.Explorer&&!o)e.x=t.originalEvent.x,e.y=t.originalEvent.y;else{var a=null,i=Atalasoft.$(t.target),r=Atalasoft.Utils.Browser.Features.Touch?t.originalEvent.touches[0]:t.originalEvent;r.pageX||r.pageY||(r.pageX=t.pageX,r.pageY=t.pageY),t.target.raphael?a=i.parents("div:eq(0)").offset():(t.target.raphaelParent||i.parents("svg").length>0)&&(a=i.parents("svg").parents("div:eq(0)").offset()),a||(a=i.offset()),e.x=r.pageX-a.left,e.y=r.pageY-a.top}else if(Atalasoft.Utils.Browser.Firefox){var l;l=t.target.raphaelParent?Atalasoft.$(t.target).parents("svg").offset():Atalasoft.$(t.target.offsetParent||t.target.parentNode).offset(),e.x=t.pageX-l.left,e.y=t.pageY-l.top}else if(t.originalEvent.currentTarget===t.originalEvent.target||n)Atalasoft.Utils.Browser.Explorer&&Atalasoft.Utils.Browser.Version<10?(e.x=t.originalEvent.x,e.y=t.originalEvent.y):(e.x=t.offsetX,e.y=t.offsetY);else if(t.originalEvent.currentTarget.offsetLeft||t.originalEvent.currentTarget.offsetTop||!t.originalEvent.currentTarget.ownerSVGElement)e.x=t.originalEvent.currentTarget.offsetLeft+t.offsetX,e.y=t.originalEvent.currentTarget.offsetTop+t.offsetY;else{var s=Atalasoft.Utils.Browser.Explorer?t.originalEvent.currentTarget.ownerSVGElement.getBBox():t.originalEvent.currentTarget.getBBox();e.x=Math.round(s.x),e.y=Math.round(s.y)}return e},/**
* Gets the normalized offsetLeft and offsetTop from an SVG element
* with respect to its parent jQuery object
* @param objSVG: object, svg object from the dom
* @param parent: object, jQuery object representing the parent DOM node
*/
Atalasoft.Utils.getSVGOffset=function(t,e){var n={left:0,top:0};if("offsetLeft"in t)n.left=t.offsetLeft,n.top=t.offsetTop;else{var o=Atalasoft.$(t).offset(),a=e.offset();n.left=o.left-a.left,n.top=o.top-a.top}return n},Atalasoft.Utils.getJSPath=function(t){var e=Atalasoft.$('script[src*="'+t+'"]');return e.length>0?e.attr("src").replace(t,""):""},Atalasoft.Utils.CalcDistance=function(t,e,n,o,a){var i=Math.max(t,n),r=Math.min(t,n),l=Math.max(e,o),s=Math.min(e,o);return{x:i-r,y:l-s,dx:a?a.left-r:0,dy:a?a.top-s:0,left:r,right:i,top:s,bottom:l}},/**
 * Creates a rectangle object. 
 */
Atalasoft.Utils.makeRect=function(t,e,n,o){return{x:t,y:e,width:n,height:o}},/**
 * Calculates rectangle bounds for the clockwise page rotation to the specified angle.
 * @param angle positive number, must be exactly divisible by 90.
 */
Atalasoft.Utils.rotateRect=function(t,e,n){if(0===n)return t;var o=t.x,a=t.y;switch(n){case 90:o=e.height-t.y-t.height,a=t.x;break;case 180:o=e.width-t.x-t.width,a=e.height-t.y-t.height;break;case 270:o=t.y,a=e.width-t.x-t.width}return Atalasoft.Utils.makeRect(o,a,90===n||270===n?t.height:t.width,90===n||270===n?t.width:t.height)},Atalasoft.Utils.__atalaNull=function(){this.typeOf=null},Atalasoft.Utils.__rf=function(){return!1},Atalasoft.Utils.__ef=function(){},Atalasoft.Utils.__sp=function(t){t.stopPropagation()},/**
 * creates a function that wraps multiple functions into one
 * @param arr: array of functions
 * @param arguments to pass to called functions
 */
Atalasoft.Utils.__functionFromArray=function(t){return function(){for(;t.length;)t.shift().apply(this,arguments)}},Atalasoft.Utils.__supportsVML=function(){var t;if("undefined"==typeof t){var e=Atalasoft.$("<div/>").appendTo("body"),n=Atalasoft.$('<v:shape id="vml_flag1" adj="1" />').appendTo(e);n.css("behavior","url(#default#VML)"),t=n[0]?"object"==typeof n[0].adj:!0,e.remove()}return t},Atalasoft.Utils.__htmlTransformStyle=function(t){return{" transform":t,"-moz-transform":t,"-webkit-transform":t,"-o-transform":t,"-ms-transform":t}},Atalasoft.Utils.__calcPathBounds=function(t,e){var n={x:0,y:0,width:0,height:0};if(!t||!t.length)return n;e=e||Raphael.matrix(),n.x=e.x(t[0].x,t[0].y),n.y=e.y(t[0].x,t[0].y);for(var o=0;o<t.length;o++){var a={x:e.x(t[o].x,t[o].y),y:e.y(t[o].x,t[o].y)};n.x=a.x<n.x?a.x:n.x,n.y=a.y<n.y?a.y:n.y,n.width=a.x>n.width?a.x:n.width,n.height=a.y>n.height?a.y:n.height}return n.width-=n.x,n.height-=n.y,n},Atalasoft.Utils.__loadDependencies=function(t,e,n){function o(){var t="undefined"!=typeof $.easing,o="undefined"!=typeof $.ui,a=!e||"undefined"!=typeof Raphael;if(t&&o&&a)Atalasoft.Utils._scriptLoader&&Atalasoft.Utils._scriptLoader===l&&(delete Atalasoft.Utils._scriptsLoading,delete Atalasoft.Utils._scriptLoader),s("scriptsloaded");else{if(Atalasoft.Utils._scriptLoader&&Atalasoft.Utils._scriptsLoading)for(var i in Atalasoft.Utils._scriptsLoading)if(Atalasoft.Utils._scriptsLoading.hasOwnProperty(i)){var r=Atalasoft.Utils._scriptsLoading[i];r.indexOf("easing")>=0&&(t=!0),r.indexOf("ui")>=0&&(o=!0),!a&&r.indexOf("raphael")>=0&&(a=!0)}if(!t||!o||!a){var u=t?"":" jQuery.easing";u+=o?"":" jQuery.ui",u+=a?"":" Raphael",n("InitError","Unable to find dependencies:"+u)}}}function a(){0===i.length?o():$.getScript(c+i.shift(),a)}n=n||Atalasoft.Utils.__ef;var i=[],r="1.8.14",l=$({}),s=function(){l.trigger.apply(l,arguments)};if("undefined"==typeof $.easing&&i.push("jquery.easing.1.3.js"),"undefined"==typeof $.ui&&i.push("jquery-ui-"+r+".custom.min.js"),e&&"undefined"==typeof Raphael&&i.push("raphael-min.js"),i.length>0){if(Atalasoft.Utils._scriptsLoading&&Atalasoft.Utils._scriptLoader)for(Atalasoft.Utils._scriptLoader.bind({scriptsloaded:o});i.length>0;){var u=i.shift();-1===$.inArray(u,Atalasoft.Utils._scriptsLoading)&&Atalasoft.Utils._scriptsLoading.push(u)}else{var c=t||Atalasoft.Utils.getJSPath("jquery-"+$().jquery+".min.js");if(""===c)return n("InitError",'Unable to find dependencies, use config option "scripturl" to define root script url.'),void 0;Atalasoft.Utils._scriptsLoading=i.slice(0),Atalasoft.Utils._scriptLoader=l}return a(),Atalasoft.Utils._scriptLoader}return null},/** Browser sniffing enumeration */
Atalasoft.Utils.Browser={Explorer:navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0,Firefox:navigator.userAgent.indexOf("Firefox")>=0||navigator.userAgent.indexOf("Minefield")>=0,Safari:navigator.userAgent.indexOf("Safari")>=0&&navigator.userAgent.indexOf("Chrome")<0,Opera:navigator.userAgent.indexOf("Opera")>=0,Chrome:navigator.userAgent.indexOf("Safari")>=0&&navigator.userAgent.indexOf("Chrome")>=0,Features:{SVG:!(!window.SVGAngle&&!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")),Touch:!!("ontouchstart"in window),VML:Atalasoft.Utils.__supportsVML(),foreignObject:document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Extensibility","1.1"),Compatibility:"undefined"!=typeof document.documentMode&&7===document.documentMode,FlexBox:"flex"in document.documentElement.style||"WebkitFlex"in document.documentElement.style||"msFlex"in document.documentElement.style},Layout:{Gecko:!!navigator.userAgent.match(/(Gecko)/i),Presto:!!navigator.userAgent.match(/(Presto)/i),Trident:!!navigator.userAgent.match(/(Trident)/i),Webkit:!!navigator.userAgent.match(/(WebKit)/i),Version:(Atalasoft.Utils.__blv=navigator.userAgent.match(/(?:Gecko|Presto|Trident|WebKit).[\d\.]*/))?Atalasoft.Utils.__blv[0].replace(/\D*/,""):null},Mobile:{iOS:!!navigator.userAgent.match(/(iPad|iPhone|iPod)/i),Android:!!navigator.userAgent.match(/(Android)/i),IEMobile:!!navigator.userAgent.match(/(IEMobile)/i),Any:function(){return this.iOS||this.Android||this.IEMobile}},Version:(Atalasoft.Utils.__bv=navigator.userAgent.match(/(?:MSIE|Firefox|Chrome|Safari|Opera| rv).[\d\.]*/))?Atalasoft.Utils.__bv[0].replace(/\D*/,""):null},Atalasoft.Utils.Browser.Explorer8=Atalasoft.Utils.Browser.Explorer&&8===parseInt(Atalasoft.Utils.Browser.Version,10),/** Specifies the behavior of the mouse from within the WebDocumentViewer. */
Atalasoft.Utils.MouseToolType={/** Specify no mouse behavior at all. */
None:0,/** Clicking and dragging the mouse will scroll the image. */
Pan:1,/** Clicking will zoom in. */
ZoomIn:2,/** Clicking will zoom out. */
ZoomOut:3,/** Shows a context menu for the clicked object (where applicable). */
ContextMenu:4,/** Allows mouse events to pass through the DOM without any handling. */
PassThrough:5,/** Mouse will be set to crosshairs and can be used to drag and modify a selection rectangle on the image. */
Selection:6,/** Zoom in on a specified area defined by dragging a rectangle onto the image. */
ZoomArea:7},/** Specifies the cursor used with the mouse tool. */
Atalasoft.Utils.MouseToolCursor={/** Automatically determined by the browser. */
Auto:"",/** An arrow pointer. */
Arrow:"default",/** A crosshair usually used in drawing a box. */
Crosshair:"crosshair",/** A grabbing cursor. Usually changes to gabbed while the mouse button is down. */
Grab:Atalasoft.Utils.Browser.Firefox?"-moz-grab":"hand",/** A hand with a finger pointing. Usually what the browser uses for clicking hyperlinks. */
Hand:"pointer",/** A crosshair pointer with arrowheads on the ends indicating movement. */
Move:"move",/** A magnifying glass with a plus sign in it. */
ZoomIn:Atalasoft.Utils.Browser.Firefox?"-moz-zoom-in":'url("%1ZoomIn.cur"pointer), pointer',/** A magnifying glass with a minus sign in it. */
ZoomOut:Atalasoft.Utils.Browser.Firefox?"-moz-zoom-out":'url("%1ZoomOut.cur"), pointer',/** A custom CSS cursor string provided by the user. */
Custom:"%2"},/** Specifies the direction of scrolling */
Atalasoft.Utils.ScrollDirection={/** Scrolls horizontally. */
Horizontal:"horizontal",/** Scrolls vertically. */
Vertical:"vertical"},/** Specifies the fitting options */
Atalasoft.Utils.Fitting={/** No fitting will be applied to the image */
None:0,/** Finds the best option between width or height based fitting. */
Best:1,/** Fits the image to the available width. */
Width:2,/** Fits the image to the available height. */
Height:3},/** Specifies the page selection method */
Atalasoft.Utils.PageSelection={/** Selects the page under the top left corner of the viewer  */
TopLeft:{x:0,y:0},/** Selects the page under the middle left of the viewer  */
MiddleLeft:{x:0,y:.5},/** Selects the page under the bottom left corner of the viewer  */
BottomLeft:{x:0,y:1},/** Selects the page under the center location of viewer  */
Center:{x:.5,y:.5}};var JSON;JSON||(JSON={}),function(){"use strict";function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,o,a,i,r,l=gap,s=e[t];switch(s&&"object"==typeof s&&"function"==typeof s.toJSON&&(s=s.toJSON(t)),"function"==typeof rep&&(s=rep.call(e,t,s)),typeof s){case"string":return quote(s);case"number":return isFinite(s)?String(s):"null";case"boolean":case"null":return String(s);case"object":if(!s)return"null";if(gap+=indent,r=[],"[object Array]"===Object.prototype.toString.apply(s)){for(i=s.length,n=0;i>n;n+=1)r[n]=str(n,s)||"null";return a=0===r.length?"[]":gap?"[\n"+gap+r.join(",\n"+gap)+"\n"+l+"]":"["+r.join(",")+"]",gap=l,a}if(rep&&"object"==typeof rep)for(i=rep.length,n=0;i>n;n+=1)"string"==typeof rep[n]&&(o=rep[n],a=str(o,s),a&&r.push(quote(o)+(gap?": ":":")+a));else for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(a=str(o,s),a&&r.push(quote(o)+(gap?": ":":")+a));return a=0===r.length?"{}":gap?"{\n"+gap+r.join(",\n"+gap)+"\n"+l+"}":"{"+r.join(",")+"}",gap=l,a}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,n){var o;if(gap="",indent="","number"==typeof n)for(o=0;n>o;o+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var n,o,a=t[e];if(a&&"object"==typeof a)for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(o=walk(a,n),void 0!==o?a[n]=o:delete a[n]);return reviver.call(t,e,a)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),Atalasoft.Controls.WebDocumentThumbnailer=function(t){function e(){ge&&(ve=ge.__getViewerLink(pe,ye),ge.bind({beforehandlerrequest:Z,documentloaded:H,scroll:R}),ke.allowannotations&&ge.bind({annotationresized:W,annotationmoved:W,annotationrotated:W,annotationcreated:j,annotationdeleted:q}),ge.bind({pagerotated:N}),pe.bind({statusmessage:se})),pe.bind({annotationsloaded:$,formsloaded:X,contextmenu:J,documentloaded:Y,pageshown:re,pageresize:le,scroll:ie,zoomchanged:ue,zoomstarted:ce,zoomfinished:de}),a(),me={click:te,touchstart:ne,touchmove:oe,touchend:ae,mouseenter:Q,mouseleave:K},n()}function n(){}function o(){r=ye.__createDiv,i=ye.__createDOM}function a(){var t=["annotations","getCurrentPageIndex","getZoom","next","previous","save","showPage"];h=pe.empty,v=pe.openUrl,l=pe.getCurrentPageIndex,s=pe.__getDebugInfo,f=pe.next,d=pe.previous,c=pe.showPage;for(var e=0;e<t.length;e++)ge?pe[t[e]]=ge[t[e]]:delete pe[t[e]];pe.empty=g,pe.openUrl=pe.OpenUrl=m,pe.__getDebugInfo=u,pe.scrollToThumb=c,pe.zoom=function(){},delete pe.fit}function i(){}function r(){}function l(){}function s(){}function u(){if(ke.debug){var t=s();return fe.extend(!0,t,{thumbnailer:{config:ke,index:he,links:{viewer:ve,self:ye},page:be,thumb:Ae,state:we}}),t}return null}/**
	* Scrolls the viewer to the given page number and executes the callback when finished
	* @param i: int, page number (1 based)
	* @param callback: function to execute after this operation is done
	* @returns undefined
	*/
function c(){}function d(){}function f(){}/**
	* Gets the current selected thumbnail index
	* @returns number indicating the zero based page index
	*/
function p(){return he}/**
	* Resets the thumbnailer to its default state
	* @param callback function to execute when the empty process is finished
	*/
function g(t){var e=1,n=function(){e--,0>=e&&"function"==typeof t&&t.call()};ke.documenturl="",ke.annotationsurl="",ge&&(e++,ge.empty(n)),h(n)}function h(){}/**
	* Opens the document at the given urls in all associated controls
	* @param surl string: url of the document file with respect to the config.serverurl
	* @param aurl string: url of the annotation xmp file with respect to the config.serverurl
	* @param furl string: url of the form file with respect to the config.serverurl 
	* @param callback function to execute when the open operation is finished
	* @returns undefined
	*/
function m(t,e,n,o){I(),null==o&&("function"==typeof e?(o=e,e=null):"function"==typeof n&&(o=n,n=null));var a=function(){y(),G(o)};ke.documenturl=t,ke.annotationsurl=e,v(t,e,n,a)}function v(){}function y(){pe.scrollTo(0,0,!1)}/**
	* Highlights the thumbnail at the given index, and scrolls to it in the linked viewer, if possible.
	* @param i number indicating the zero based thumb index
	* @returns undefined
	*/
function _(t){if(!we.scrolling){if(he=t,we.base&&fe.each(we.base.dom.pageDivs,function(e,n){n._index===t?n.addClass(pe.domclasses.atala_active_thumb):n.removeClass(pe.domclasses.atala_active_thumb),A(n)}),ge){var e=ge.getCurrentPageIndex();e>=0&&he!==e&&(we.scrolling=!0,he===e-1?ge.previous(1,L):he===e+1?ge.next(1,L):ge.showPage(he,L))}pe.trigger({type:"thumbselected",index:t})}}function x(){if(we.base&&we.base.dom.pageDivs.length>0&&null!=we.base.dom.pageDivs[0]._img){if(we.initialized&&!we.base.dom.pageDivs[0]._img._size.isEmpty()){var t=we.base.dom.pageDivs[0]._img._size;Ae.scale=t.width>t.height?Ae.size/t.width:Ae.size/t.height}else{var e=we.base.page.size.width/we.base.page.size.height<1,n=Math.ceil(we.base.page.size.height*we.base.config.zoom),o=Math.ceil(we.base.page.size.width*we.base.config.zoom),a=Ae.size;if(ke.direction===xe.Vertical?Ae.divsize=Math.ceil(we.base.page.size.width*we.base.config.zoom):ke.direction===xe.Horizontal&&(Ae.divsize=Math.ceil(we.base.page.size.height*we.base.config.zoom)),ke.tabular&&ke.columns>1&&ke.direction===xe.Vertical)if(ke.thumbsize)U();else{var i=Math.ceil(Ae.divsize/ke.columns);a=i-2*ke.thumbpadding-ke.pagespacing}a=0>=a?Ae.divsize-2*ke.thumbpadding:a,V(a),Ae.scale=we.base.config.zoom*(Ae.size/(e?n:o)),Ae.zoomfull=Ae.scale,ke.minwidth>we.base.page.size.width*Ae.scale&&(ke.minwidth=we.base.page.size.width*Ae.scale),we.initialized=!0}var r=ke.showpageborder?2*ke.pageborderwidth:0;if(pe.trigger({type:"pagedivsresized",height:Ae.size+2*ke.thumbpadding-r,width:Ae.size+2*ke.thumbpadding-r,fullzoom:Ae.zoomfull,minwidth:ke.minwidth}),ke.allowdragdrop){var l=Math.round(Ae.size/2);we.base.dom.content.sortable({containment:"parent",cursorAt:{left:l,top:l},delay:ke.dragdelay,distance:4,helper:"clone",opacity:.65,scroll:!0,scrollSensitivity:l,scrollSpeed:10,start:k,stop:P,tolerance:"pointer",update:D,zIndex:100})}fe.each(we.base.dom.pageDivs,function(t,e){e.thumbInitialized?(e.bind(me),e.width(Ae.size),e.height(Ae.size),w(e._img,e._paper,Ae.scale)):(e.bind(me),e.width(Ae.size),e.height(Ae.size),e.css({padding:ke.thumbpadding,"background-color":ke.backcolor,cursor:"pointer","margin-bottom":ke.pagespacing+"px","text-align":"center",position:"relative"}),ke.tabular?e.css({"margin-right":ke.pagespacing+"px"}):ke.direction===xe.Horizontal&&e.css({"margin-right":ke.pagespacing+"px","margin-bottom":"0px"}),e._paper&&Atalasoft.Utils.Browser.Explorer&&(e._paper.canvas.style.top="",e._paper.canvas.style.width="",e._paper.canvas.style.height=""),e._grips&&(e._grips.push=function(){}),e.thumbInitialized=!0)})}b()}function b(){if(we.base&&we.base.dom.pageDivs.length>0){var t=3e4,e=3e4;if(ke.direction===xe.Vertical){if(we.base.dom.scrollV){we.base.dom.scrollV.pauseEventPropagation();var n=we.base.dom.pageDivs[0].height()+ke.pagespacing+2*ke.thumbpadding,o=n*E()/ye.__getTabularIndexOffset(Ae.scale),a=we.base.dom.scrollV.height()-we.base.dom.scrollH.height()-1,i=0;i=o>t?t:o>a&&o-a>a?o-a:o,we.base.dom.scrollV._tray.height(i),we.base.dom.scrollV._max=Math.max(i-we.base.dom.scrollV[0].clientHeight,0)+1,we.base.dom.scrollV._ratio=(o-a)/we.base.dom.scrollV._max,we.base.dom.scrollV.resumeEventPropagation()}}else if(ke.direction===xe.Horizontal&&we.base.dom.scrollH){we.base.dom.scrollH.pauseEventPropagation();var r=we.base.dom.pageDivs[0].width()+ke.pagespacing+2*ke.thumbpadding,l=r*E()/ye.__getTabularIndexOffset(Ae.scale),s=we.base.dom.scrollH.width()-we.base.dom.scrollV.width()-1,u=0;u=l>e?e:l>s&&l-s>s?l-s:l,we.base.dom.scrollH._tray.width(u),we.base.dom.scrollH._max=Math.max(u-we.base.dom.scrollH[0].clientWidth,0)+1,we.base.dom.scrollH._ratio=(l-s)/we.base.dom.scrollH._max,we.base.dom.scrollH.resumeEventPropagation()}}}function w(t,e,n,o){if(we.base){var a=o||t.getScaledSize(n),i=a.width,r=a.height,l=Ae.size*(we.base.config.zoom/Ae.zoomfull);if(i>l||r>l){var s=1>i/r,u=n*(l/(s?r:i));i=Math.round(t._size.width*u),r=Math.round(t._size.height*u),n=u}var c=t.getDomElement();c[0].style.left="50%",c[0].style.top="50%",c[0].style.position="absolute",c[0].style.marginLeft=-Math.round(i/2)+"px",c[0].style.marginTop=-Math.round(r/2)+"px",e&&(e.canvas.style.left="50%",e.canvas.style.top="50%",e.canvas.style.marginLeft=-Math.round(i/2)+"px",e.canvas.style.marginTop=-Math.round(r/2)+"px",e.canvas.style.zIndex=1),t.trigger({type:"pagezoom",index:t._index,height:Math.round(r),width:Math.round(i),prevzoom:we.base.config.zoom,zoom:n})}}function z(t,e,n){var o=t.data("selected")?e:n;t.css("background-color",o)}function A(t){var e=t._index===he,n=e?ke.selectedcolor:ke.backcolor;t.data("selected",e),t.css("background-color",n)}function k(t,e){we.drag.dragging=!0,we.drag.start=M(e.item),we.drag.end=we.drag.start,we.base.controllers.mouseTool.pauseTool(),pe.trigger({type:"thumbdragstart",dragindex:we.drag.start})}function P(){we.drag.dragging=!1,we.base.controllers.mouseTool.resumeTool(),pe.trigger({type:"thumbdragend",dropindex:we.drag.end}),ve._controllers.document.movePage(we.drag.start,we.drag.end),ve._controllers.annotations&&ve._controllers.annotations.moveLayer(we.drag.start,we.drag.end),ye._controllers.annotations&&ye._controllers.annotations.moveLayer(we.drag.start,we.drag.end),ve._controllers.forms&&ve._controllers.forms.moveForm(we.drag.start,we.drag.end),S(),ve.__redrawVisiblePages(),ye.__redrawVisiblePages(!0),_(we.drag.end)}function D(t,e){we.drag.end=we.base.dom.pageDivs[0]._index+e.item.index(),pe.trigger({type:"thumbsreordered",dragindex:we.drag.start,dropindex:we.drag.end})}function T(t,e){var n=[];for(var o in t)if(t.hasOwnProperty(o)){var a=[],i=e?{}:a;e&&(i[e]=a);for(var r in t[o])t[o].hasOwnProperty(r)&&(a[r]=t[o][r].get(),a[r].multiview=!0);n[o]=i}return n}function M(t){for(var e=0;e<we.base.dom.pageDivs.length;e++)if(we.base.dom.pageDivs[e][0]===t[0])return we.base.dom.pageDivs[e]._index;return-1}function U(){if(ke.tabular){var t;if(ke.columns>1)t=(Ae.size+2*ke.thumbpadding+ke.pagespacing)*ke.columns;else if(ke.rows>1){var e=Math.ceil(E()/ke.rows);t=(Ae.size+2*ke.thumbpadding+ke.pagespacing)*e}t&&we.base.dom.content.width(t)}}function E(){return we.base.controllers.document.getPageCount()}function C(t){for(var e=0;e<we.base.dom.pageDivs.length;e++)if(we.base.dom.pageDivs[e]._index===t)return!0;return!1}function S(){var t=we.base.dom.pageDivs[0]._index;we.base.dom.pageDivs.sort(function(t,e){return t.index()-e.index()});for(var e=0;e<we.base.dom.pageDivs.length;e++){var n=we.base.dom.pageDivs[e];n._index=t+e,null!=n._num&&n._num.text(n._index+1)}}function V(t){Ae.size=t,we.base&&we.base.config.forcepagesize&&(we.base.config.forcepagesize.width=t,we.base.config.forcepagesize.height=t)}function F(){ke.allowdragdrop=ke.allowdragdrop?!0:!1,ke.selectedindex=B(ke.selectedindex)?parseInt(ke.selectedindex,10):0,ke.thumbpadding=B(ke.thumbpadding)?parseInt(ke.thumbpadding,10):8,ke.backcolor=O(ke.backcolor,"#DCDCDC"),ke.hovercolor=O(ke.hovercolor,"#667F9F"),ke.selectedcolor=O(ke.selectedcolor,"#E0872D"),ke.selectedhovercolor=O(ke.selectedhovercolor,"#FFC060")}function O(t,e){var n={hex:"#FFFFFF",hexs:"#FFF",name:"white",rgb:"rgb(255, 255, 255)"},o=r(null,"dummy");return o.css("backgroundColor",n.name),o.css("backgroundColor",t),o.css("backgroundColor")===n.rgb&&(t=t.toLowerCase(),t!==n.name&&t!==n.hex&&t!==n.hexs&&t!==n.rgb&&(t=e)),t}function B(t,e){return e?isFinite(parseFloat(t)):isFinite(parseInt(t,10))}function I(){we.base&&fe.each(we.base.dom.pageDivs,function(t,e){e.unbind(me)})}function H(){}function R(){var t=ge.getCurrentPageIndex();he!==t&&_(t)}function L(){we.scrolling=!1}function j(t){if(we.base){var e=ve._annos[t.page]||null,n=null,o=null;e&&(n=e[e.length-1],o=n.get()),o&&o.type===t.anno.type&&(o.multiview=!0,we.base.controllers.annotations.createAnnotation(o,t.page))}}function q(t){we.base&&we.base.controllers.annotations.deleteAnnoOnPage(t.page,t.index)}function N(t){we.base&&we.base.controllers.document.rotatePage(t.index,t.angle)}function W(t){if(we.base&&C(he))for(var e=we.base.controllers.annotations.getAnnosFromPage(he),n=0;n<e.length;n++)e[n].type===t.anno.type&&e[n].update(!0)}function Z(t){if(("docinfo"===t.request.type||"annodata"===t.request.type||"formdata"===t.request.type)&&we.base){if(t.request.cancel=!0,"docinfo"===t.request.type&&(t.request.info.pagewidth=be.size.width,t.request.info.pageheight=be.size.height,t.request.info.pagecount=be.count,t.request.info.dpi=be.dpi,t.request.info.colordepth=we.base.controllers.memory.getColorDepth(),t.request.info.vector=be.vector),ke.allowannotations&&("annodata"===t.request.type||t.request.data.atala_annurl)){var e=we.base.controllers.annotations.__getDebugInfo().data;t.request.info.offset=0,t.request.info.layers=T(e.annos,"items")}if(ke.allowforms&&("formdata"===t.request.type||t.request.data.atala_formurl)){var n=we.base.controllers.forms.__getDebugInfo().data;t.request.info.forms={fields:T(n.fields)}}ge.trigger({type:"handlerreturned",request:t.request})}}function $(){}function X(){}function J(t,e,n){for(var o in n)n.hasOwnProperty(o)&&delete n[o]}function Y(){we.base={config:ye._config,controllers:ye._controllers,dom:ye._dom,page:ye._page}}function G(t){be.size.width=we.base.page.size.width,be.size.height=we.base.page.size.height,be.count=we.base.page.count,be.dpi=we.base.page.dpi,be.vector=we.base.page.vector,ke.direction===xe.Vertical&&we.base.dom.scrollH?we.base.dom.scrollH._tray.hide():ke.direction===xe.Horizontal&&we.base.dom.scrollV&&we.base.dom.scrollV._tray.hide(),x();var e=function(){_(ke.selectedindex),t&&"function"==typeof t&&t()};ge?ge.openUrl(ke.documenturl,ke.annotationsurl,e):e()}function Q(){z(fe(this),ke.selectedhovercolor,ke.hovercolor)}function K(){z(fe(this),ke.selectedcolor,ke.backcolor)}function te(t){var e=t.currentTarget;fe.each(we.base.dom.pageDivs,function(t,n){n[0]===e&&_(n._index)})}function ee(t,e,n){if(!(t.originalEvent.touches.length>1)){t.preventDefault();var o=t.originalEvent.changedTouches[0],a=document.createEvent("MouseEvents");a.initMouseEvent(e,!0,!0,window,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,n,null),t.target.dispatchEvent(a)}}function ne(t){ze.moves=0,ee(t,"mouseover",0),ee(t,"mousedown",0)}function oe(t){ze.moves++,ee(t,"mousemove",0)}function ae(t){ee(t,"mouseup",0),ze.moves>0?ze.moves=0:ee(t,"click",0),ee(t,"mouseout",0)}function ie(){}function re(t){A(t.page)}function le(t){t.image&&(t.image._loaded?w(t.image,t.page._paper,Ae.scale,{width:t.width,height:t.height}):t.image.css({position:"absolute"}))}function se(t){ve&&ve.__status&&ve.__status(t.message)}function ue(){if(we.base){var t=we.base.page.size.width/we.base.page.size.height<1,e=Math.ceil(we.base.page.size.height*we.base.config.zoom),n=Math.ceil(we.base.page.size.width*we.base.config.zoom),o=Math.max(e,n),a=we.base.config.zoom*(o/(t?e:n));Ae.zoom=we.base.config.zoom/Ae.zoomfull,Ae.scale=a,fe.each(we.base.dom.pageDivs,function(t,e){e.width(o),e.height(o)}),b()}}function ce(){}function de(){}var fe=Atalasoft.$,pe=null,ge=t.viewer||null,he=-1,me=null,ve=null,ye=null,_e=Atalasoft.Utils.Fitting,xe=Atalasoft.Utils.ScrollDirection,be=(Atalasoft.Utils.MouseToolType,{size:{width:0,height:0},sizes:[{width:0,height:0}],count:0,number:-1,dpi:96,vector:!1}),we={base:null,loading:!1,initialized:!1,scrolling:!1,drag:{dragging:!1,start:-1,end:-1}},ze={moves:0},Ae={divsize:-1,scale:1,size:-1,zoom:1,zoomfull:1},ke={direction:xe.Vertical,maxwidth:300,minwidth:80,pageborderwidth:1,pagespacing:2,parent:null,showpagenumber:!1,toolbarparent:null,allowdragdrop:!1,dragdelay:250,selectedindex:0,thumbpadding:8,backcolor:"#DCDCDC",hovercolor:"#667F9F",selectedcolor:"#E0872D",selectedhovercolor:"#FFC060",/** Specifies whether pages should be unified to fit into same size */
unifypages:!0},Pe={type:"Atalasoft.Controls.WebDocumentThumbnailer",debug:!0,showpageborder:!0,forcepagefit:!0,toolbarparent:fe("<div/>")};return t&&("thumbsize"in t&&isFinite(t.thumbsize)&&t.thumbsize>=30&&(V(t.thumbsize),Pe.forcepagesize={width:t.thumbsize,height:t.thumbsize}),fe.extend(ke,t),fe.extend(ke,Pe),"fitting"in t||(ke.fitting=ke.direction===xe.Vertical?_e.Width:_e.Height)),pe=Atalasoft.Controls.WebDocumentViewer.call(this,ke,G),ye=pe.__getViewerLink(pe),o(),F(),pe.getSelectedPageIndex=p,pe.selectThumb=_,e(),pe};